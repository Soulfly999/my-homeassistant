title: Home
views:
  - path: home
    title: Home
    icon: mdi:home
    subview: false
    type: custom:masonry-layout
    layout:
      max_cols: 3
    visible:
      - user: 5fe40a35918f44a282ca86861a1c2595
      - user: 2ff241fefe0d426194a7af4e0eb10813
    badges: []
    cards:
      - type: custom:digital-clock
        date: true
        seconds: true
        hour12: false
        blink_colon: true
      - type: custom:mushroom-chips-card
        chips:
          - type: weather
            entity: weather.lingen
            show_conditions: true
            show_temperature: true
            tap_action:
              action: more-info
          - type: entity
            entity: sensor.netatmo_draussen_temperature
            icon: mdi:thermometer
            icon_color: >-
              {% set temp = states(entity) | float(0) %}   {%- if temp > 35
              -%}red   {%- elif temp > 28 -%}orange   {%- elif temp > 23
              -%}deep-orange   {%- elif temp > 15 -%}green   {%- elif temp > 6
              -%}blue   {%- elif temp > 0 -%}purple   {%- else -%}grey   {%-
              endif %}  
            content: >-
              {{ states(entity) }}{{ state_attr(entity, 'unit_of_measurement')
              or '' }}    
            tap_action:
              action: fire-dom-event
              browser_mod:
                service: browser_mod.popup
                data:
                  title: Sensoren
                  content:
                    type: custom:vertical-stack-in-card
                    title: Außen-Sensor
                    cards:
                      - type: grid
                        square: false
                        columns: 2
                        cards:
                          - type: custom:mushroom-entity-card
                            entity: sensor.netatmo_draussen_temperature
                            primary_info: state
                            secondary_info: name
                            name: Temperatur
                            icon_color: green
                          - type: custom:mushroom-entity-card
                            entity: sensor.netatmo_draussen_humidity
                            primary_info: state
                            secondary_info: name
                            name: Feuchte
                            icon_color: blue
                      - type: custom:mini-graph-card
                        entities:
                          - entity: sensor.netatmo_draussen_temperature
                            name: Temperatur
                            color: var(--green-color)
                          - entity: sensor.netatmo_draussen_humidity
                            name: Feuchte
                            color: var(--blue-color)
                            y_axis: secondary
                        hours_to_show: 24
                        line_width: 3
                        font_size: 50
                        animate: true
                        show:
                          name: false
                          icon: false
                          state: false
                          legend: false
                          fill: fade
                      - type: divider
                      - type: horizontal-stack
                        cards:
                          - type: custom:mushroom-template-card
                            primary: '{{ states(entity) }}%'
                            secondary: Batterie
                            icon: >+
                              {% set battery_level = (states(entity) | int / 10)
                              | round(0) | int * 10 %}

                              {% if battery_level == 100 %}
                                mdi:battery
                              {% elif battery_level > 0 %}
                                mdi:battery-{{ battery_level }}
                              {% else %}
                                mdi:battery-alert-variant-outline
                              {% endif %}

                            icon_color: |-
                              {% set battery_level = states(entity) | int %}
                              {% if battery_level > 90 %} 
                                green
                              {% elif battery_level > 60 %}
                                light-green
                              {% elif battery_level > 50 %}
                                lime
                              {% elif battery_level > 40 %}
                                yellow
                              {% elif battery_level > 30 %}
                                amber
                              {% elif battery_level > 20 %}
                                orange
                              {% elif battery_level > 10 %}
                                deep-orange
                              {% else %}
                                red
                              {% endif %} 
                            layout: horizontal
                            tap_action:
                              action: none
                            entity: sensor.netatmo_draussen_battery_percent
                      - type: custom:vertical-stack-in-card
                        title: Küche
                        cards:
                          - type: grid
                            square: false
                            columns: 2
                            cards:
                              - type: custom:mushroom-entity-card
                                entity: sensor.netatmo_innen_temperature
                                primary_info: state
                                secondary_info: name
                                name: Temperatur
                                icon_color: green
                              - type: custom:mushroom-entity-card
                                entity: sensor.netatmo_innen_humidity
                                primary_info: state
                                secondary_info: name
                                name: Feuchte
                                icon_color: blue
                          - type: custom:mini-graph-card
                            entities:
                              - entity: sensor.netatmo_innen_temperature
                                name: Temperature
                                color: var(--green-color)
                              - entity: sensor.netatmo_innen_humidity
                                name: Feuchte
                                color: var(--blue-color)
                                y_axis: secondary
                            hours_to_show: 24
                            line_width: 3
                            font_size: 50
                            animate: true
                            show:
                              name: false
                              icon: false
                              state: false
                              legend: false
                              fill: fade
                          - type: horizontal-stack
                            cards:
                              - type: custom:mushroom-entity-card
                                entity: sensor.netatmo_innen_pressure
                                name: Luftdruck
                              - type: custom:mushroom-entity-card
                                entity: sensor.netatmo_innen_co2
                                name: CO²
                              - type: custom:mushroom-entity-card
                                entity: sensor.netatmo_innen_noise
                                name: Lautstärke
                      - type: custom:vertical-stack-in-card
                        title: Wohnzimmer
                        cards:
                          - type: grid
                            square: false
                            columns: 2
                            cards:
                              - type: custom:mushroom-entity-card
                                entity: sensor.sensor_wohnzimmer_temperature
                                primary_info: state
                                secondary_info: name
                                name: Temperatur
                                icon_color: green
                              - type: custom:mushroom-entity-card
                                entity: sensor.sensor_wohnzimmer_humidity
                                primary_info: state
                                secondary_info: name
                                name: Feuchte
                                icon_color: blue
                          - type: custom:mini-graph-card
                            entities:
                              - entity: sensor.sensor_wohnzimmer_temperature
                                name: Temperatur
                                color: var(--green-color)
                              - entity: sensor.sensor_wohnzimmer_humidity
                                name: Feuchte
                                color: var(--blue-color)
                                y_axis: secondary
                            hours_to_show: 24
                            line_width: 3
                            font_size: 50
                            animate: true
                            show:
                              name: false
                              icon: false
                              state: false
                              legend: false
                              fill: fade
                          - type: divider
                          - type: horizontal-stack
                            cards:
                              - type: custom:mushroom-template-card
                                primary: '{{ states(entity) }}%'
                                secondary: Batterie
                                icon: >+
                                  {% set battery_level = (states(entity) | int /
                                  10) | round(0) | int * 10 %}

                                  {% if battery_level == 100 %}
                                    mdi:battery
                                  {% elif battery_level > 0 %}
                                    mdi:battery-{{ battery_level }}
                                  {% else %}
                                    mdi:battery-alert-variant-outline
                                  {% endif %}

                                icon_color: |-
                                  {% set battery_level = states(entity) | int %}
                                  {% if battery_level > 90 %} 
                                    green
                                  {% elif battery_level > 60 %}
                                    light-green
                                  {% elif battery_level > 50 %}
                                    lime
                                  {% elif battery_level > 40 %}
                                    yellow
                                  {% elif battery_level > 30 %}
                                    amber
                                  {% elif battery_level > 20 %}
                                    orange
                                  {% elif battery_level > 10 %}
                                    deep-orange
                                  {% else %}
                                    red
                                  {% endif %} 
                                layout: horizontal
                                tap_action:
                                  action: none
                                entity: sensor.sensor_wohnzimmer_battery
                      - type: custom:vertical-stack-in-card
                        title: Badezimmer
                        cards:
                          - type: grid
                            square: false
                            columns: 2
                            cards:
                              - type: custom:mushroom-entity-card
                                entity: sensor.sensor_bad_temperature
                                primary_info: state
                                secondary_info: name
                                name: Temperatur
                                icon_color: green
                              - type: custom:mushroom-entity-card
                                entity: sensor.sensor_bad_humidity
                                primary_info: state
                                secondary_info: name
                                name: Feuchte
                                icon_color: blue
                          - type: custom:mini-graph-card
                            entities:
                              - entity: sensor.sensor_bad_temperature
                                name: Temperatur
                                color: var(--green-color)
                              - entity: sensor.sensor_bad_humidity
                                name: Feuchte
                                color: var(--blue-color)
                                y_axis: secondary
                            hours_to_show: 24
                            line_width: 3
                            font_size: 50
                            animate: true
                            show:
                              name: false
                              icon: false
                              state: false
                              legend: false
                              fill: fade
                          - type: divider
                          - type: horizontal-stack
                            cards:
                              - type: custom:mushroom-template-card
                                primary: '{{ states(entity) }}%'
                                secondary: Batterie
                                icon: >+
                                  {% set battery_level = (states(entity) | int /
                                  10) | round(0) | int * 10 %}

                                  {% if battery_level == 100 %}
                                    mdi:battery
                                  {% elif battery_level > 0 %}
                                    mdi:battery-{{ battery_level }}
                                  {% else %}
                                    mdi:battery-alert-variant-outline
                                  {% endif %}

                                icon_color: |-
                                  {% set battery_level = states(entity) | int %}
                                  {% if battery_level > 90 %} 
                                    green
                                  {% elif battery_level > 60 %}
                                    light-green
                                  {% elif battery_level > 50 %}
                                    lime
                                  {% elif battery_level > 40 %}
                                    yellow
                                  {% elif battery_level > 30 %}
                                    amber
                                  {% elif battery_level > 20 %}
                                    orange
                                  {% elif battery_level > 10 %}
                                    deep-orange
                                  {% else %}
                                    red
                                  {% endif %} 
                                layout: horizontal
                                tap_action:
                                  action: none
                                entity: sensor.sensor_bad_battery
                      - type: custom:vertical-stack-in-card
                        title: Büro
                        cards:
                          - type: grid
                            square: false
                            columns: 2
                            cards:
                              - type: custom:mushroom-entity-card
                                entity: sensor.sensor_buro_temperature
                                primary_info: state
                                secondary_info: name
                                name: Temperatur
                                icon_color: green
                              - type: custom:mushroom-entity-card
                                entity: sensor.sensor_buro_humidity
                                primary_info: state
                                secondary_info: name
                                name: Feuchte
                                icon_color: blue
                          - type: custom:mini-graph-card
                            entities:
                              - entity: sensor.sensor_buro_temperature
                                name: Temperatur
                                color: var(--green-color)
                              - entity: sensor.sensor_buro_humidity
                                name: Feuchte
                                color: var(--blue-color)
                                y_axis: secondary
                            hours_to_show: 24
                            line_width: 3
                            font_size: 50
                            animate: true
                            show:
                              name: false
                              icon: false
                              state: false
                              legend: false
                              fill: fade
                          - type: divider
                          - type: horizontal-stack
                            cards:
                              - type: custom:mushroom-template-card
                                primary: '{{ states(entity) }}%'
                                secondary: Batterie
                                icon: >+
                                  {% set battery_level = (states(entity) | int /
                                  10) | round(0) | int * 10 %}

                                  {% if battery_level == 100 %}
                                    mdi:battery
                                  {% elif battery_level > 0 %}
                                    mdi:battery-{{ battery_level }}
                                  {% else %}
                                    mdi:battery-alert-variant-outline
                                  {% endif %}

                                icon_color: |-
                                  {% set battery_level = states(entity) | int %}
                                  {% if battery_level > 90 %} 
                                    green
                                  {% elif battery_level > 60 %}
                                    light-green
                                  {% elif battery_level > 50 %}
                                    lime
                                  {% elif battery_level > 40 %}
                                    yellow
                                  {% elif battery_level > 30 %}
                                    amber
                                  {% elif battery_level > 20 %}
                                    orange
                                  {% elif battery_level > 10 %}
                                    deep-orange
                                  {% else %}
                                    red
                                  {% endif %} 
                                layout: horizontal
                                tap_action:
                                  action: none
                                entity: sensor.sensor_buro_battery
                      - type: custom:vertical-stack-in-card
                        title: WC Obergeschoss
                        cards:
                          - type: grid
                            square: false
                            columns: 2
                            cards:
                              - type: custom:mushroom-entity-card
                                entity: sensor.wc_og_temperature
                                primary_info: state
                                secondary_info: name
                                name: Temperatur
                                icon_color: green
                              - type: custom:mushroom-entity-card
                                entity: sensor.wc_og_humidity
                                primary_info: state
                                secondary_info: name
                                name: Feuchte
                                icon_color: blue
                          - type: custom:mini-graph-card
                            entities:
                              - entity: sensor.wc_og_temperature
                                name: Temperatur
                                color: var(--green-color)
                              - entity: sensor.wc_og_humidity
                                name: Feuchte
                                color: var(--blue-color)
                                y_axis: secondary
                            hours_to_show: 24
                            line_width: 3
                            font_size: 50
                            animate: true
                            show:
                              name: false
                              icon: false
                              state: false
                              legend: false
                              fill: fade
                          - type: divider
                          - type: horizontal-stack
                            cards:
                              - type: custom:mushroom-template-card
                                primary: '{{ states(entity) }}%'
                                secondary: Batterie
                                icon: >+
                                  {% set battery_level = (states(entity) | int /
                                  10) | round(0) | int * 10 %}

                                  {% if battery_level == 100 %}
                                    mdi:battery
                                  {% elif battery_level > 0 %}
                                    mdi:battery-{{ battery_level }}
                                  {% else %}
                                    mdi:battery-alert-variant-outline
                                  {% endif %}

                                icon_color: |-
                                  {% set battery_level = states(entity) | int %}
                                  {% if battery_level > 90 %} 
                                    green
                                  {% elif battery_level > 60 %}
                                    light-green
                                  {% elif battery_level > 50 %}
                                    lime
                                  {% elif battery_level > 40 %}
                                    yellow
                                  {% elif battery_level > 30 %}
                                    amber
                                  {% elif battery_level > 20 %}
                                    orange
                                  {% elif battery_level > 10 %}
                                    deep-orange
                                  {% else %}
                                    red
                                  {% endif %} 
                                layout: horizontal
                                tap_action:
                                  action: none
                                entity: sensor.wc_og_battery_6
                      - type: custom:vertical-stack-in-card
                        title: WC Erdgeschoss
                        cards:
                          - type: grid
                            square: false
                            columns: 2
                            cards:
                              - type: custom:mushroom-entity-card
                                entity: sensor.wc_eg_temperature
                                primary_info: state
                                secondary_info: name
                                name: Temperatur
                                icon_color: green
                              - type: custom:mushroom-entity-card
                                entity: sensor.wc_eg_humidity
                                primary_info: state
                                secondary_info: name
                                name: Feuchte
                                icon_color: blue
                          - type: custom:mini-graph-card
                            entities:
                              - entity: sensor.wc_eg_temperature
                                name: Temperatur
                                color: var(--green-color)
                              - entity: sensor.wc_eg_humidity
                                name: Feuchte
                                color: var(--blue-color)
                                y_axis: secondary
                            hours_to_show: 24
                            line_width: 3
                            font_size: 50
                            animate: true
                            show:
                              name: false
                              icon: false
                              state: false
                              legend: false
                              fill: fade
                          - type: divider
                          - type: horizontal-stack
                            cards:
                              - type: custom:mushroom-template-card
                                primary: '{{ states(entity) }}%'
                                secondary: Batterie
                                icon: >+
                                  {% set battery_level = (states(entity) | int /
                                  10) | round(0) | int * 10 %}

                                  {% if battery_level == 100 %}
                                    mdi:battery
                                  {% elif battery_level > 0 %}
                                    mdi:battery-{{ battery_level }}
                                  {% else %}
                                    mdi:battery-alert-variant-outline
                                  {% endif %}

                                icon_color: |-
                                  {% set battery_level = states(entity) | int %}
                                  {% if battery_level > 90 %} 
                                    green
                                  {% elif battery_level > 60 %}
                                    light-green
                                  {% elif battery_level > 50 %}
                                    lime
                                  {% elif battery_level > 40 %}
                                    yellow
                                  {% elif battery_level > 30 %}
                                    amber
                                  {% elif battery_level > 20 %}
                                    orange
                                  {% elif battery_level > 10 %}
                                    deep-orange
                                  {% else %}
                                    red
                                  {% endif %} 
                                layout: horizontal
                                tap_action:
                                  action: none
                                entity: sensor.wc_eg_battery
                      - type: custom:vertical-stack-in-card
                        title: Schlafzimmer
                        cards:
                          - type: grid
                            square: false
                            columns: 2
                            cards:
                              - type: custom:mushroom-entity-card
                                entity: sensor.sensor_schlafzimmer_temperature
                                primary_info: state
                                secondary_info: name
                                name: Temperatur
                                icon_color: green
                              - type: custom:mushroom-entity-card
                                entity: sensor.sensor_schlafzimmer_humidity
                                primary_info: state
                                secondary_info: name
                                name: Feuchte
                                icon_color: blue
                          - type: custom:mini-graph-card
                            entities:
                              - entity: sensor.sensor_schlafzimmer_temperature
                                name: Temperatur
                                color: var(--green-color)
                              - entity: sensor.sensor_schlafzimmer_humidity
                                name: Feuchte
                                color: var(--blue-color)
                                y_axis: secondary
                            hours_to_show: 24
                            line_width: 3
                            font_size: 50
                            animate: true
                            show:
                              name: false
                              icon: false
                              state: false
                              legend: false
                              fill: fade
                          - type: divider
                          - type: horizontal-stack
                            cards:
                              - type: custom:mushroom-template-card
                                primary: '{{ states(entity) }}%'
                                secondary: Batterie
                                icon: >+
                                  {% set battery_level = (states(entity) | int /
                                  10) | round(0) | int * 10 %}

                                  {% if battery_level == 100 %}
                                    mdi:battery
                                  {% elif battery_level > 0 %}
                                    mdi:battery-{{ battery_level }}
                                  {% else %}
                                    mdi:battery-alert-variant-outline
                                  {% endif %}

                                icon_color: |-
                                  {% set battery_level = states(entity) | int %}
                                  {% if battery_level > 90 %} 
                                    green
                                  {% elif battery_level > 60 %}
                                    light-green
                                  {% elif battery_level > 50 %}
                                    lime
                                  {% elif battery_level > 40 %}
                                    yellow
                                  {% elif battery_level > 30 %}
                                    amber
                                  {% elif battery_level > 20 %}
                                    orange
                                  {% elif battery_level > 10 %}
                                    deep-orange
                                  {% else %}
                                    red
                                  {% endif %} 
                                layout: horizontal
                                tap_action:
                                  action: none
                                entity: sensor.sensor_schlafzimmer_battery
                      - type: custom:vertical-stack-in-card
                        title: Zimmer Phil
                        cards:
                          - type: grid
                            square: false
                            columns: 2
                            cards:
                              - type: custom:mushroom-entity-card
                                entity: sensor.sensor_phil_temperature
                                primary_info: state
                                secondary_info: name
                                name: Temperatur
                                icon_color: green
                              - type: custom:mushroom-entity-card
                                entity: sensor.sensor_phil_humidity
                                primary_info: state
                                secondary_info: name
                                name: Feuchte
                                icon_color: blue
                          - type: custom:mini-graph-card
                            entities:
                              - entity: sensor.sensor_phil_temperature
                                name: Temperatur
                                color: var(--green-color)
                              - entity: sensor.sensor_phil_humidity
                                name: Feuchte
                                color: var(--blue-color)
                                y_axis: secondary
                            hours_to_show: 24
                            line_width: 3
                            font_size: 50
                            animate: true
                            show:
                              name: false
                              icon: false
                              state: false
                              legend: false
                              fill: fade
                          - type: divider
                          - type: horizontal-stack
                            cards:
                              - type: custom:mushroom-template-card
                                primary: '{{ states(entity) }}%'
                                secondary: Batterie
                                icon: >+
                                  {% set battery_level = (states(entity) | int /
                                  10) | round(0) | int * 10 %}

                                  {% if battery_level == 100 %}
                                    mdi:battery
                                  {% elif battery_level > 0 %}
                                    mdi:battery-{{ battery_level }}
                                  {% else %}
                                    mdi:battery-alert-variant-outline
                                  {% endif %}

                                icon_color: |-
                                  {% set battery_level = states(entity) | int %}
                                  {% if battery_level > 90 %} 
                                    green
                                  {% elif battery_level > 60 %}
                                    light-green
                                  {% elif battery_level > 50 %}
                                    lime
                                  {% elif battery_level > 40 %}
                                    yellow
                                  {% elif battery_level > 30 %}
                                    amber
                                  {% elif battery_level > 20 %}
                                    orange
                                  {% elif battery_level > 10 %}
                                    deep-orange
                                  {% else %}
                                    red
                                  {% endif %} 
                                layout: horizontal
                                tap_action:
                                  action: none
                                entity: sensor.sensor_phil_battery
                      - type: custom:vertical-stack-in-card
                        title: Zimmer Nick
                        cards:
                          - type: grid
                            square: false
                            columns: 2
                            cards:
                              - type: custom:mushroom-entity-card
                                entity: sensor.sensor_nick_temperature
                                primary_info: state
                                secondary_info: name
                                name: Temperatur
                                icon_color: green
                              - type: custom:mushroom-entity-card
                                entity: sensor.sensor_nick_humidity
                                primary_info: state
                                secondary_info: name
                                name: Feuchte
                                icon_color: blue
                          - type: custom:mini-graph-card
                            entities:
                              - entity: sensor.sensor_nick_temperature
                                name: Temperatur
                                color: var(--green-color)
                              - entity: sensor.sensor_nick_humidity
                                name: Feuchte
                                color: var(--blue-color)
                                y_axis: secondary
                            hours_to_show: 24
                            line_width: 3
                            font_size: 50
                            animate: true
                            show:
                              name: false
                              icon: false
                              state: false
                              legend: false
                              fill: fade
                          - type: divider
                          - type: horizontal-stack
                            cards:
                              - type: custom:mushroom-template-card
                                primary: '{{ states(entity) }}%'
                                secondary: Batterie
                                icon: >+
                                  {% set battery_level = (states(entity) | int /
                                  10) | round(0) | int * 10 %}

                                  {% if battery_level == 100 %}
                                    mdi:battery
                                  {% elif battery_level > 0 %}
                                    mdi:battery-{{ battery_level }}
                                  {% else %}
                                    mdi:battery-alert-variant-outline
                                  {% endif %}

                                icon_color: |-
                                  {% set battery_level = states(entity) | int %}
                                  {% if battery_level > 90 %} 
                                    green
                                  {% elif battery_level > 60 %}
                                    light-green
                                  {% elif battery_level > 50 %}
                                    lime
                                  {% elif battery_level > 40 %}
                                    yellow
                                  {% elif battery_level > 30 %}
                                    amber
                                  {% elif battery_level > 20 %}
                                    orange
                                  {% elif battery_level > 10 %}
                                    deep-orange
                                  {% else %}
                                    red
                                  {% endif %} 
                                layout: horizontal
                                tap_action:
                                  action: none
                                entity: sensor.sensor_nick_battery
                      - type: custom:vertical-stack-in-card
                        title: Flur Obergeschoss
                        cards:
                          - type: grid
                            square: false
                            columns: 2
                            cards:
                              - type: custom:mushroom-entity-card
                                entity: sensor.sensor_flur_og_temperature
                                primary_info: state
                                secondary_info: name
                                name: Temperatur
                                icon_color: green
                              - type: custom:mushroom-entity-card
                                entity: sensor.sensor_flur_og_humidity
                                primary_info: state
                                secondary_info: name
                                name: Feuchte
                                icon_color: blue
                          - type: custom:mini-graph-card
                            entities:
                              - entity: sensor.sensor_flur_og_temperature
                                name: Temperatur
                                color: var(--green-color)
                              - entity: sensor.sensor_flur_og_humidity
                                name: Feuchte
                                color: var(--blue-color)
                                y_axis: secondary
                            hours_to_show: 24
                            line_width: 3
                            font_size: 50
                            animate: true
                            show:
                              name: false
                              icon: false
                              state: false
                              legend: false
                              fill: fade
                          - type: divider
                          - type: horizontal-stack
                            cards:
                              - type: custom:mushroom-template-card
                                primary: '{{ states(entity) }}%'
                                secondary: Batterie
                                icon: >+
                                  {% set battery_level = (states(entity) | int /
                                  10) | round(0) | int * 10 %}

                                  {% if battery_level == 100 %}
                                    mdi:battery
                                  {% elif battery_level > 0 %}
                                    mdi:battery-{{ battery_level }}
                                  {% else %}
                                    mdi:battery-alert-variant-outline
                                  {% endif %}

                                icon_color: |-
                                  {% set battery_level = states(entity) | int %}
                                  {% if battery_level > 90 %} 
                                    green
                                  {% elif battery_level > 60 %}
                                    light-green
                                  {% elif battery_level > 50 %}
                                    lime
                                  {% elif battery_level > 40 %}
                                    yellow
                                  {% elif battery_level > 30 %}
                                    amber
                                  {% elif battery_level > 20 %}
                                    orange
                                  {% elif battery_level > 10 %}
                                    deep-orange
                                  {% else %}
                                    red
                                  {% endif %} 
                                layout: horizontal
                                tap_action:
                                  action: none
                                entity: sensor.sensor_flur_og_battery
                      - type: custom:vertical-stack-in-card
                        title: Flur Erdgeschoss
                        cards:
                          - type: grid
                            square: false
                            columns: 2
                            cards:
                              - type: custom:mushroom-entity-card
                                entity: sensor.flureg_temperature
                                primary_info: state
                                secondary_info: name
                                name: Temperatur
                                icon_color: green
                              - type: custom:mushroom-entity-card
                                entity: sensor.flureg_humidity
                                primary_info: state
                                secondary_info: name
                                name: Feuchte
                                icon_color: blue
                          - type: custom:mini-graph-card
                            entities:
                              - entity: sensor.flureg_temperature
                                name: Temperatur
                                color: var(--green-color)
                              - entity: sensor.flureg_humidity
                                name: Feuchte
                                color: var(--blue-color)
                                y_axis: secondary
                            hours_to_show: 24
                            line_width: 3
                            font_size: 50
                            animate: true
                            show:
                              name: false
                              icon: false
                              state: false
                              legend: false
                              fill: fade
                          - type: divider
                          - type: horizontal-stack
                            cards:
                              - type: custom:mushroom-template-card
                                primary: '{{ states(entity) }}%'
                                secondary: Batterie
                                icon: >+
                                  {% set battery_level = (states(entity) | int /
                                  10) | round(0) | int * 10 %}

                                  {% if battery_level == 100 %}
                                    mdi:battery
                                  {% elif battery_level > 0 %}
                                    mdi:battery-{{ battery_level }}
                                  {% else %}
                                    mdi:battery-alert-variant-outline
                                  {% endif %}

                                icon_color: |-
                                  {% set battery_level = states(entity) | int %}
                                  {% if battery_level > 90 %} 
                                    green
                                  {% elif battery_level > 60 %}
                                    light-green
                                  {% elif battery_level > 50 %}
                                    lime
                                  {% elif battery_level > 40 %}
                                    yellow
                                  {% elif battery_level > 30 %}
                                    amber
                                  {% elif battery_level > 20 %}
                                    orange
                                  {% elif battery_level > 10 %}
                                    deep-orange
                                  {% else %}
                                    red
                                  {% endif %} 
                                layout: horizontal
                                tap_action:
                                  action: none
                                entity: sensor.sensor_flureg_battery
            card_mod:
              style: |
                ha-card {
                  {% if ( states('sensor.netatmo_draussen_temperature') | float(0) > 35 ) %}
                    --card-mod-icon-color: #D11208;
                  {% elif ( states('sensor.netatmo_draussen_temperature') | float(0) > 28 ) %}
                    --card-mod-icon-color: #EF6D4D;              
                  {% elif ( states('sensor.netatmo_draussen_temperature') | float(0) > 23 ) %}
                    --card-mod-icon-color: #FBCE17;            
                  {% elif ( states('sensor.netatmo_draussen_temperature') | float(0) > 15 ) %}
                    --card-mod-icon-color: #C9D968;
                  {% elif ( states('sensor.netatmo_draussen_temperature') | float(0) > 6 ) %}
                    --card-mod-icon-color: #4e8d59;            
                  {% elif ( states('sensor.netatmo_draussen_temperature') | float(0) > 0 ) %}
                    --card-mod-icon-color: #672BE1; 
                  {% elif ( states('sensor.netatmo_draussen_temperature') | float(0) < 0 ) %}
                    --card-mod-icon-color: #7D569D;             
                  {% endif %}
                }
          - type: template
            entity: input_boolean.post
            icon_color: |-
              {% if is_state('input_boolean.post', 'on') %}
                accent
              {% else %}
                default
              {% endif %}
            icon: |-
              {% if is_state('input_boolean.post', 'on') %}
                mdi:email-alert
              {% else %}
                mdi:email
              {% endif %}
            tap_action:
              action: call-service
              service: input_boolean.turn_off
              target:
                entity_id: input_boolean.post
              confirmation:
                text: Briefkasten geleert?
          - type: template
            entity: sensor.kreis_emsland_aktuelle_warnstufe
            icon_color: '{{ ''green'' if is_state(entity, ''0'') else ''red'' }}'
            icon: >-
              {{ 'mdi:flash-alert-outline' if is_state(entity, '3') else
              'mdi:cloud-check-outline' }}
            tap_action:
              action: fire-dom-event
              browser_mod:
                service: browser_mod.popup
                data:
                  title: Sensoren
                  content:
                    type: custom:layout-card
                    layout_type: custom:grid-layout
                    layout:
                      margin: 0
                    cards:
                      - type: custom:vertical-stack-in-card
                        cards:
                          - type: entities
                            entities:
                              - type: custom:multiple-entity-row
                                entity: sensor.kreis_emsland_aktuelle_warnstufe
                                name: WARNUNG
                                toggle: false
                                state_color: true
                                show_state: true
                                secondary_info: ''
                                icon: mdi:exclamation-thick
                                entities:
                                  - entity: sensor.kreis_emsland_aktuelle_warnstufe
                                    attribute: warning_1_name
                                    name: Warnung vor
                                  - entity: sensor.kreis_emsland_aktuelle_warnstufe
                                    attribute: warning_1_start
                                    format: time
                                    name: Von
                                  - entity: sensor.kreis_emsland_aktuelle_warnstufe
                                    attribute: warning_1_end
                                    format: time
                                    name: Bis
                                state_header: Anzahl Warnungen
                                column: true
                                card_mod:
                                  style:
                                    .: |
                                      :host {
                                        --paper-item-icon-color: red;
                                        --mdc-icon-size: 40px;
                                      }
                      - type: markdown
                        title: Wetterwarnungen
                        content: >-
                          {% set current_count =
                          state_attr("sensor.kreis_emsland_aktuelle_warnstufe",
                          "warning_count") %}

                          {% set advance_count =
                          state_attr("sensor.kreis_emsland_vorwarnstufe",
                          "warning_count") %}

                          {% if ((current_count == 0 or current_count == None)
                          and (advance_count == 0 or advance_count == None)) %}
                            ### 🟢 Keine aktuellen Warnungen
                          {% else %}
                            {% for i in range(current_count) %}
                              {% set headline = state_attr("sensor.kreis_emsland_aktuelle_warnstufe", "warning_" ~ loop.index ~ "_headline") %}
                              {% set description = state_attr("sensor.kreis_emsland_aktuelle_warnstufe", "warning_" ~ loop.index ~ "_description") %}
                              {% set level = state_attr("sensor.kreis_emsland_aktuelle_warnstufe", "warning_" ~ loop.index ~ "_level") %}
                              {% set time_start = state_attr("sensor.kreis_emsland_aktuelle_warnstufe", "warning_" ~ loop.index ~ "_start") | as_timestamp %}
                              {% set weekday_start = time_start | timestamp_custom("%w", True) | int %}
                              {% set time_end = state_attr("sensor.kreis_emsland_aktuelle_warnstufe", "warning_" ~ loop.index ~ "_end") | as_timestamp %}
                              {% set weekday_end = time_end | timestamp_custom("%w", True) | int %}
                          **<font color=#fdd835>{{ headline }}</font>**     

                          *<font color=gray>{{ time_start |
                          timestamp_custom("%a, %H:%M")
                           ~ " - " ~
                          time_end | timestamp_custom("%a, %H:%M") }}</font>*
                              {{ description|trim }}
                              {% if not loop.last %}
                          ***
                              {% endif %}
                            {% endfor %}
                            {% if ((current_count != 0) and (advance_count != 0)) %}{% endif %}
                            {% for i in range(advance_count) %}
                              {% set headline = state_attr("sensor.kreis_emsland_vorwarnstufe", "warning_" ~ loop.index ~ "_headline") %}
                              {% set description = state_attr("sensor.kreis_emsland_vorwarnstufe", "warning_" ~ loop.index ~ "_description") %}
                              {% set level = state_attr("sensor.kreis_emsland_vorwarnstufe", "warning_" ~ loop.index ~ "_level") %}
                              {% set time_start = state_attr("sensor.kreis_emsland_vorwarnstufe", "warning_" ~ loop.index ~ "_start") | as_timestamp%}
                              {% set weekday_start = time_start | timestamp_custom("%w", True) | int %}
                              {% set time_end = state_attr("sensor.kreis_emsland_vorwarnstufe", "warning_" ~ loop.index ~ "_end") | as_timestamp %}
                              {% set weekday_end = time_end | timestamp_custom("%w", True) | int %}
                          **<font color=#fdd835>{{ headline }}</font>**

                          *<font color=gray>{{ time_start |
                          timestamp_custom("%a, %H:%M") ~ " - " ~ time_end |
                          timestamp_custom("%a, %H:%M") }}</font>*
                              {{ description|trim }}
                              {% if not loop.last %}
                          ***
                              {% endif %}
                            {% endfor %}
                          {% endif %} 
                      - camera_view: auto
                        type: picture-glance
                        entities: []
                        camera_image: camera.warnkarte
        card_mod:
          style:
            mushroom-template-chip:nth-child(3)$: |
              ha-state-icon {
                {{ 'animation: bounce 1s linear infinite;' if is_state('input_boolean.post', 'on') }}
              } 
              @keyframes bounce {
                0%, 10%, 50%, 80%, 100% {transform: translateY(0); }
                40% { transform: translateY(-1.2px) rotate(5deg); }
                60% { transform: translateY(-1.1px) rotate(4deg); }
              }  
            mushroom-template-chip:nth-child(4)$: |
              ha-state-icon {
                {% if states('sensor.kreis_emsland_aktuelle_warnstufe') | int >= 1 %}
                  animation: boing 3s linear infinite;
                  transform-origin: 50% 90%;
                {% endif %}
              } 
              @keyframes boing {
                0% { transform: scale3d(1, 1, 1); }
                7% { transform: scale3d(1.25, 0.75, 1); }
                10% { transform: scale3d(0.75, 1.25, 1); }
                12% { transform: scale3d(1.15, 0.85, 1); }
                16% { transform: scale3d(0.95, 1.05, 1); }
                19% { transform: scale3d(1.05, 0.95, 1); }
                25% { transform: scale3d(1, 1, 1); }
              }
        alignment: center
      - type: custom:mushroom-chips-card
        chips:
          - type: template
            entity: sensor.windsensor_boenstarke
            icon: mdi:windsock
            icon_color: >-
              {{ iif(states(entity) | float > 75, 'red', iif(states(entity) |
              float > 50, 'orange', iif(states(entity) | float > 30,
              'deep-orange', iif(states(entity) | float > 15, 'green',
              iif(states(entity) | float > 0, 'blue', 'grey'))))) }}
            content: >-
              {{ (states(entity) | float(0)) | round(0) }}{{ state_attr(entity,
              'unit_of_measurement') or '' }}
            tap_action:
              action: more-info
          - type: template
            entity: sensor.windstarke
            icon: mdi:weather-windy
            icon_color: >-
              {% set wind = states(entity) | float(0) %}{% if wind >= 112
              %}red{% elif wind >= 103 %}red{% elif wind >= 94 %}red{% elif wind
              >= 84 %}orange{% elif wind >= 75 %}orange{% elif wind >= 66
              %}deep-orange{% elif wind >= 57 %}deep-orange{% elif wind >= 47
              %}green{% elif wind >= 38 %}green{% elif wind >= 29 %}blue{% elif
              wind >= 20 %}blue{% elif wind >= 10 %}cyan{% elif wind >= 2
              %}cyan{% else %}grey{% endif %}
            content: >-
              {% set wind = states(entity) | float(0) %}{% if wind < 2
              %}Windstille{% elif wind >= 2 and wind < 10 %}Leiser Zug{% elif
              wind >= 10 and wind < 20 %}Leichte Brise{% elif wind >= 20 and
              wind < 29 %}Schwache Brise{% elif wind >= 29 and wind < 38
              %}mäßige Brise{% elif wind >= 38 and wind < 47 %}Frische Brise{%
              elif wind >= 47 and wind < 57 %}Starker Wind{% elif wind >= 57 and
              wind < 66 %}Starker bis stürmischer Wind{% elif wind >= 66 and
              wind < 75 %}Stürmischer Wind{% elif wind >= 75 and wind < 84
              %}Sturm{% elif wind >= 84 and wind < 94 %}Sturm bis schwerer
              Sturm{% elif wind >= 94 and wind < 103 %}Schwerer Sturm{% elif
              wind >= 103 and wind < 112 %}Orkanartiger Sturm{% elif wind >= 112
              %}Orkan{% else %}unbekannt{% endif %}
            tap_action:
              action: more-info
          - type: template
            entity: sensor.regensensor_niederschlag_heute
            icon: mdi:weather-rainy
            icon_color: >-
              {{ iif(states(entity) | float > 30, 'blue', iif(states(entity) |
              float > 10, 'cyan', iif(states(entity) | float > 2, 'light-blue',
              iif(states(entity) | float > 0, 'green', 'grey')))) }}
            content: >-
              {{ (states(entity) | float(0)) | round(1) }}{{ state_attr(entity,
              'unit_of_measurement') or '' }}
            tap_action:
              action: more-info
        alignment: center
        card_mod:
          style:
            mushroom-template-chip:nth-child(1)$: |
              ha-state-icon {
                {% set wind = states('sensor.windsensor_boenstarke') | float(0) %}
                {% if wind > 20 %}
                  animation: shake {{ 1.5 - (wind/100) }}s ease-in-out infinite;
                  transform-origin: 50% 0%;
                {% endif %}
              }
              @keyframes shake {
                0%, 100% { transform: rotate(0deg); }
                25% { transform: rotate(-10deg); }
                75% { transform: rotate(10deg); }
              }
            mushroom-template-chip:nth-child(2)$: |
              ha-state-icon {
                {% set wind = states('sensor.windstarke') | float(0) %}
                {% if wind > 3 %}
                  animation: rotate {{ 2 - (wind/100) }}s linear infinite;
                {% endif %}
              }
              @keyframes rotate {
                from { transform: rotate(0deg); }
                to { transform: rotate(360deg); }
              }
            mushroom-template-chip:nth-child(3)$: |
              ha-state-icon {
                {% set rain = states('sensor.regensensor_niederschlag_heute') | float(0) %}
                {% if rain > 0 %}
                  animation: rain 1s ease-in infinite;
                {% endif %}
              }
              @keyframes rain {
                0% { transform: translateY(0); }
                50% { transform: translateY(2px); }
                100% { transform: translateY(0); }
              }
      - type: vertical-stack
        cards:
          - type: custom:mushroom-chips-card
            chips:
              - type: entity
                entity: sensor.balkonkraftwerk_power
                card_mod:
                  style: |
                    ha-card {
                      {% set value = states('sensor.balkonkraftwerk_power') | float %}
                      {% if value > 400 %}
                        --card-mod-icon-color: green;
                      {% elif value > 100 %}
                        --card-mod-icon-color: orange;
                      {% else %}
                        --card-mod-icon-color: red;
                      {% endif %}
                    }
                tap_action:
                  action: fire-dom-event
                  browser_mod:
                    service: browser_mod.popup
                    data:
                      title: Balkonkraftwerk
                      size: normal
                      content:
                        type: custom:layout-card
                        layout_type: custom:grid-layout
                        layout:
                          margin: 0
                        cards:
                          - type: vertical-stack
                            cards:
                              - type: entities
                                entities:
                                  - entity: sensor.balkonkraftwerk_power
                                  - entity: sensor.balkonkraftwerk_tag
                                  - entity: sensor.balkonkraftwerk_monat
                                  - entity: sensor.balkonkraftwerk_jahr
                                  - entity: sensor.balkonsolar_vorteil_monat
                                  - entity: sensor.balkonsolar_vorteil_jahr
              - type: entity
                entity: sensor.gesamtleistung
                tap_action:
                  action: fire-dom-event
                  browser_mod:
                    service: browser_mod.popup
                    data:
                      title: Stromverbraucher
                      size: normal
                      content:
                        type: custom:layout-card
                        layout_type: custom:grid-layout
                        layout:
                          margin: 0
                        cards:
                          - type: custom:auto-entities
                            card:
                              type: entities
                              title: Verbraucher
                              state_color: false
                              show_header_toggle: false
                            entities:
                              - entity: sensor.pc_daniel_power
                                name: PC-Daniel
                              - entity: sensor.pc_nick_power
                                name: PC-Nick
                              - entity: sensor.pc_phil_power
                                name: PC-Phil
                              - entity: sensor.nas_ha_laptop_power
                                name: NAS & HA & Laptop
                              - entity: sensor.spulmaschine_power
                                name: Spülmaschine
                              - entity: sensor.trockner_power
                                name: Trockner
                              - entity: sensor.waschmaschine_power
                              - entity: sensor.backofen_power
                                name: Backofen
                              - entity: sensor.kuhlschrank_power
                                name: Kühlschrank
                              - entity: sensor.kuhlschrank_schuppen_power
                                name: Kühlschrank Schuppen
                              - entity: sensor.tv_schlafzimmer_power
                                name: TV-Schlafzimmer
                              - entity: sensor.router_tv_wohnzimmer_power
                                name: TV-Wohnzimmer
                              - entity: sensor.autoladegerat_leistung
                                name: Autoladegerät
                              - entity: sensor.tv_konsolen_nick_power
                                name: TV & Konsolen Nick
                              - entity: sensor.gefriertruhe_power
                                name: Gefriertruhe
                              - entity: sensor.tv_phil_power
                                name: TV-Phil
                              - entity: sensor.kaffeevollautomat_power
                                name: Kaffeevollautomat
                              - entity: sensor.kuchenmaschine_power
                                name: Küchenmaschine
                              - entity: sensor.salzlampe_power
                                name: WZ-Salzlampe
                              - entity: sensor.gartenbeleuchtung_power
                                name: Gartenbeleuchtung
                            state_color: false
                            sort:
                              method: state
                              reverse: true
                              numeric: true
                            show_empty: true
              - type: entity
                entity: sensor.stromverbrauch_kwh_monatlich
                tap_action:
                  action: fire-dom-event
                  browser_mod:
                    service: browser_mod.popup
                    data:
                      title: Stromverbraucher Monat
                      size: normal
                      content:
                        type: custom:layout-card
                        layout_type: custom:grid-layout
                        layout:
                          margin: 0
                        cards:
                          - type: custom:auto-entities
                            card:
                              type: entities
                              title: Verbraucher
                              state_color: false
                              show_header_toggle: false
                            entities:
                              - entity: sensor.pc_daniel_monatlich
                                name: PC-Daniel
                              - entity: sensor.pc_nick_monatlich
                                icon: mdi:desktop-tower-monitor
                                name: PC-Nick
                              - entity: sensor.pc_phil_monatlich
                                name: PC-Phil
                              - entity: sensor.nas_ha_laptop_monatlich
                                name: NAS & HA & Laptop
                              - entity: sensor.spulmaschine_monatlich
                                name: Spülmaschine
                              - entity: sensor.trockner_monatlich
                                name: Trockner
                              - entity: sensor.waschmaschine_monatlich
                                name: Waschmaschine
                              - entity: sensor.backofen_monatlich
                                name: Backofen
                              - entity: sensor.kuhlschrank_monatlich
                                name: Kühlschrank
                              - entity: sensor.kuhlschrank_schuppen_monatlich
                                name: Kühlschrank Schuppen
                              - entity: sensor.tv_schlafzimmer_monatlich
                                name: TV-Schlafzimmer
                              - entity: sensor.tv_wohnzimmer_router_monatlich
                                name: TV-Wohnzimmer
                              - entity: sensor.kia_ceed_sw_stromverbrauch_monatlich
                                name: Autoladegerät
                              - entity: sensor.tv_konsolen_nick_monatlich
                                name: TV- & Konsolen Nick
                              - entity: sensor.gefriertruhe_monatlich
                                name: Gefriertruhe
                              - entity: sensor.tv_phil_monatlich
                                name: TV-Phil
                              - entity: sensor.kaffeevollautomat_monatlich
                                name: Kaffeevollautomat
                              - entity: sensor.kuchenmaschine_monatlich
                                name: Küchenmaschine
                              - entity: sensor.gartenbeleuchtung_monatlich
                                name: Gartenbeleuchtung
                              - entity: sensor.wohnzimmer_salzlampe_monatlich
                                name: Wohnzimmer-Salzlampe
                            state_color: false
                            sort:
                              method: state
                              reverse: true
                              numeric: true
            alignment: center
      - type: custom:mushroom-chips-card
        alignment: center
        chips:
          - type: template
            entity: input_boolean.waschmaschine_lauft
            icon_color: >-
              {{ 'green' if is_state('input_boolean.waschmaschine_fertig',
              'on')   
                else 'orange' if is_state(entity, 'on')   
                else 'grey' }}
            icon: >-
              {{ 'mdi:washing-machine-alert' if is_state(entity, 'on') else
              'mdi:washing-machine-off' }}
            tap_action:
              action: fire-dom-event
              browser_mod:
                service: browser_mod.popup
                data:
                  title: Waschmaschine
                  size: normal
                  content:
                    type: vertical-stack
                    cards:
                      - type: custom:button-card
                        entity: sensor.waschmaschine_status
                        name: Waschmaschine
                        icon: mdi:washing-machine
                        show_state: false
                        show_label: false
                        layout: vertical
                        custom_fields:
                          status: |
                            [[[
                              const laufend = states['input_boolean.waschmaschine_lauft']?.state === 'on';
                              const fertig = states['input_boolean.waschmaschine_fertig']?.state === 'on';
                              
                              const getDuration = (datetimeEntityId) => {
                                const dateStr = states[datetimeEntityId]?.state;
                                if (!dateStr) return null;
                                const startTime = new Date(dateStr);
                                const now = new Date();
                                const diffMs = now - startTime;
                                const totalMin = Math.floor(diffMs / 60000);
                                const hours = Math.floor(totalMin / 60);
                                const minutes = totalMin % 60;
                                let result = '';
                                if (hours > 0) result += `${hours} Std. `;
                                if (minutes > 0 || hours === 0) result += `${minutes} Min`;
                                return result.trim();
                              };

                              if (laufend) {
                                const seit = getDuration('input_datetime.waschmaschine_startzeit');
                                return seit ? `🌀 Läuft seit ${seit}` : '🌀 Läuft';
                              }

                              if (fertig) {
                                const seit = getDuration('input_datetime.waschmaschine_fertig');
                                return seit ? `✅ Fertig seit ${seit}` : '✅ Fertig';
                              }

                              return '🛑 Aus';
                            ]]]
                          info: |
                            [[[
                              const power = states['sensor.waschmaschine_power']?.state || '0';
                              return `⚡ ${power} W`;
                            ]]]
                          progress: |
                            [[[
                              const laufend = states['input_boolean.waschmaschine_lauft']?.state === 'on';
                              if (!laufend) return '';
                              const fortschritt = states['sensor.waschmaschine_fortschritt']?.state || '0';
                              return `<div style='background: rgba(255,255,255,0.25); height: 8px; border-radius: 4px; overflow: hidden; margin-top: 12px;'><div style='width: ${fortschritt}%; background: #2196f3; height: 100%; transition: width 0.4s ease-in-out;'></div></div>`;
                            ]]]
                          zaehler: |
                            [[[
                              const starts = states['sensor.tageszahler_waschmaschine']?.state || '0';
                              const tag = states['sensor.waschmaschine_taglich']?.state || '–';
                              const monat = states['sensor.waschmaschine_monatlich']?.state || '–';
                              return `🔁 ${starts} · ${tag} kWh · ${monat} kWh`;
                            ]]]
                        styles:
                          card:
                            - height: 270px
                            - border-radius: 18px
                            - padding: 14px
                            - background: |
                                [[[
                                  if (states['input_boolean.waschmaschine_lauft']?.state === 'on')
                                    return "linear-gradient(145deg, #2196f3, #1976d2)";
                                  if (states['input_boolean.waschmaschine_fertig']?.state === 'on')
                                    return "linear-gradient(145deg, #4caf50, #2e7d32)";
                                  return "var(--card-background-color)";
                                ]]]
                            - color: |
                                [[[
                                  if (states['input_boolean.waschmaschine_lauft']?.state === 'on' ||
                                      states['input_boolean.waschmaschine_fertig']?.state === 'on')
                                    return "white";
                                  return "var(--primary-text-color)";
                                ]]]
                            - box-shadow: 0 6px 14px rgba(0, 0, 0, 0.15)
                            - transition: all 0.3s ease
                          grid:
                            - grid-template-areas: |
                                "i"
                                "n"
                                "status"
                                "info"
                                "progress"
                                "zaehler"
                            - grid-template-rows: 1fr auto auto auto auto auto
                            - grid-template-columns: 1fr
                          name:
                            - font-weight: 600
                            - font-size: 1.3em
                            - letter-spacing: 0.3px
                            - justify-self: center
                          icon:
                            - width: 110px
                            - height: 110px
                            - justify-self: center
                            - margin-bottom: 8px
                          custom_fields:
                            status:
                              - text-align: center
                              - font-size: 1.1em
                              - font-weight: 500
                              - opacity: 0.95
                              - padding-top: 4px
                            info:
                              - text-align: center
                              - font-size: 1em
                              - font-weight: 500
                              - opacity: 0.85
                            progress:
                              - width: 100%
                            zaehler:
                              - text-align: center
                              - font-size: 0.95em
                              - padding-top: 12px
                              - opacity: 0.75
                      - type: entities
                        entities:
                          - entity: input_boolean.waschmaschine_lauft
                            name: Status
                            state_color: true
                            type: simple-entity
                          - entity: sensor.waschmaschine_power
                            name: Verbrauch
                          - entity: input_datetime.waschmaschine_startzeit
                            type: simple-entity
                            name: Startzeit
                            format: relative
                            show_age: true
                          - entity: sensor.waschmaschine_laufzeit
                            name: Laufzeit
                            state_color: true
                          - entity: input_datetime.waschmaschine_fertig
                            type: simple-entity
                            name: Endzeit
                            format: relative
                            show_age: true
                          - entity: sensor.waschmaschine_stoppuhr
                            name: Dauer
                            state_color: true
                          - entity: sensor.tageszahler_waschmaschine
                            name: Tageszähler
                          - entity: sensor.monatszahler_waschmaschine
                            name: Monatszähler
                          - entity: sensor.waschmaschine_taglich
                            name: Stromverbrauch Tag
                          - entity: sensor.stromkosten_waschmaschine_tag
                            name: Stromkosten Tag
                          - entity: sensor.waschmaschine_wochentlich
                            name: Stromverbrauch Wöchentlich
                          - entity: sensor.stromkosten_waschmaschine_woche
                            name: Stromkosten Woche
                          - entity: sensor.waschmaschine_monatlich
                            name: Stromverbrauch Monatlich
                          - entity: sensor.stromkosten_waschmaschine_monat
                            name: Stromkosten Monat
                          - entity: sensor.waschmaschine_jahr
                            name: Stromverbrauch Jährlich
                          - entity: sensor.stromkosten_waschmaschine_jahr
                            name: Stromkosten Jahr
          - type: template
            entity: input_boolean.trockner_lauft
            icon_color: |-
              {{ 'green' if is_state('input_boolean.trockner_fertig', 'on')   
                else 'orange' if is_state(entity, 'on')   
                else 'grey' }}
            icon: >-
              {{ 'mdi:tumble-dryer-alert' if is_state(entity, 'on') else
              'mdi:tumble-dryer-off' }}
            tap_action:
              action: fire-dom-event
              browser_mod:
                service: browser_mod.popup
                data:
                  title: Trockner
                  size: normal
                  content:
                    type: vertical-stack
                    cards:
                      - type: custom:button-card
                        entity: sensor.trockner_status
                        name: Trockner
                        icon: mdi:tumble-dryer
                        show_state: false
                        show_label: false
                        layout: vertical
                        custom_fields:
                          status: |
                            [[[
                              const laufend = states['input_boolean.trockner_lauft']?.state === 'on';
                              const fertig = states['input_boolean.trockner_fertig']?.state === 'on';

                              const getDuration = (datetimeEntityId) => {
                                const dateStr = states[datetimeEntityId]?.state;
                                if (!dateStr) return null;
                                const startTime = new Date(dateStr);
                                const now = new Date();
                                const diffMs = now - startTime;
                                const totalMin = Math.floor(diffMs / 60000);
                                const hours = Math.floor(totalMin / 60);
                                const minutes = totalMin % 60;
                                let result = '';
                                if (hours > 0) result += `${hours} Std. `;
                                if (minutes > 0 || hours === 0) result += `${minutes} Min`;
                                return result.trim();
                              };

                              if (laufend) {
                                const seit = getDuration('input_datetime.trockner_startzeit');
                                return seit ? `🌀 Läuft seit ${seit}` : '🌀 Läuft';
                              }

                              if (fertig) {
                                const seit = getDuration('input_datetime.trockner_fertig');
                                return seit ? `✅ Fertig seit ${seit}` : '✅ Fertig';
                              }

                              return '🛑 Aus';
                            ]]]
                          info: |
                            [[[
                              const power = states['sensor.trockner_power']?.state || '0';
                              return `⚡ ${power} W`;
                            ]]]
                          progress: |
                            [[[
                              const laufend = states['input_boolean.trockner_lauft']?.state === 'on';
                              if (!laufend) return '';
                              const fortschritt = states['sensor.trockner_fortschritt']?.state || '0';
                              return `<div style='background: rgba(255,255,255,0.25); height: 8px; border-radius: 4px; overflow: hidden; margin-top: 12px;'><div style='width: ${fortschritt}%; background: #ff9800; height: 100%; transition: width 0.4s ease-in-out;'></div></div>`;
                            ]]]
                          zaehler: |
                            [[[
                              const starts = states['sensor.tageszahler_trockner']?.state || '0';
                              const tag = states['sensor.trockner_taglich']?.state || '–';
                              const monat = states['sensor.trockner_monatlich']?.state || '–';
                              return `🔁 ${starts} · ${tag} kWh · ${monat} kWh`;
                            ]]]
                        styles:
                          card:
                            - height: 270px
                            - border-radius: 18px
                            - padding: 14px
                            - background: |
                                [[[
                                  if (states['input_boolean.trockner_lauft']?.state === 'on')
                                    return "linear-gradient(145deg, #ff9800, #f57c00)";
                                  if (states['input_boolean.trockner_fertig']?.state === 'on')
                                    return "linear-gradient(145deg, #4caf50, #2e7d32)";
                                  return "var(--card-background-color)";
                                ]]]
                            - color: |
                                [[[
                                  if (states['input_boolean.trockner_lauft']?.state === 'on' ||
                                      states['input_boolean.trockner_fertig']?.state === 'on')
                                    return "white";
                                  return "var(--primary-text-color)";
                                ]]]
                            - box-shadow: 0 6px 14px rgba(0, 0, 0, 0.15)
                            - transition: all 0.3s ease
                          grid:
                            - grid-template-areas: |
                                "i"
                                "n"
                                "status"
                                "info"
                                "progress"
                                "zaehler"
                            - grid-template-rows: 1fr auto auto auto auto auto
                            - grid-template-columns: 1fr
                          name:
                            - font-weight: 600
                            - font-size: 1.3em
                            - letter-spacing: 0.3px
                            - justify-self: center
                          icon:
                            - width: 80px
                            - height: 110px
                            - justify-self: center
                            - margin-bottom: 8px
                          custom_fields:
                            status:
                              - text-align: center
                              - font-size: 1.1em
                              - font-weight: 500
                              - opacity: 0.95
                              - padding-top: 4px
                            info:
                              - text-align: center
                              - font-size: 1em
                              - font-weight: 500
                              - opacity: 0.85
                            progress:
                              - width: 100%
                            zaehler:
                              - text-align: center
                              - font-size: 0.95em
                              - padding-top: 12px
                              - opacity: 0.75
                      - type: entities
                        entities:
                          - entity: input_boolean.trockner_lauft
                            name: Status
                            state_color: true
                          - entity: sensor.trockner_power
                            name: Verbrauch
                          - entity: input_datetime.trockner_startzeit
                            name: Startzeit
                            type: simple-entity
                            format: relative
                            show_age: true
                          - entity: sensor.trockner_laufzeit
                            name: Laufzeit
                            state_color: true
                          - entity: input_datetime.trockner_fertig
                            name: Endzeit
                            type: simple-entity
                            format: relative
                            show_age: true
                          - entity: sensor.trockner_stoppuhr
                            name: Dauer
                            state_color: true
                          - entity: sensor.tageszahler_trockner
                            name: Tageszähler
                          - entity: sensor.monatszahler_trockner
                            name: Monatszähler
                          - entity: sensor.trockner_taglich
                            name: Stromverbrauch Tag
                          - entity: sensor.stromkosten_trockner_tag
                            name: Stromkosten Tag
                          - entity: sensor.trockner_wochentlich
                            name: Stromverbrauch Wöchentlich
                          - entity: sensor.stromkosten_trockner_woche
                            name: Stromkosten Woche
                          - entity: sensor.trockner_monatlich
                            name: Stromverbrauch Monatlich
                          - entity: sensor.stromkosten_trockner_monat
                            name: Stromkosten Monat
                          - entity: sensor.trockner_jahrlich
                            name: Stromverbrauch Jährlich
                          - entity: sensor.stromkosten_trockner_jahr
                            name: Stromkosten Jahr
          - type: template
            entity: input_boolean.spulmaschine_lauft
            icon_color: >-
              {{ 'green' if is_state('input_boolean.spulmaschine_fertig',
              'on')   
                else 'orange' if is_state(entity, 'on')   
                else 'grey' }}
            icon: >-
              {{ 'mdi:dishwasher-alert' if is_state(entity, 'on') else
              'mdi:dishwasher-off' }}
            tap_action:
              action: fire-dom-event
              browser_mod:
                service: browser_mod.popup
                data:
                  title: Spülmaschine
                  size: normal
                  content:
                    type: vertical-stack
                    cards:
                      - type: custom:button-card
                        entity: sensor.spulmaschine_status
                        name: Spülmaschine
                        icon: mdi:dishwasher
                        show_state: false
                        show_label: false
                        layout: vertical
                        custom_fields:
                          status: |
                            [[[
                              const laufend = states['input_boolean.spulmaschine_lauft']?.state === 'on';
                              const fertig = states['input_boolean.spulmaschine_fertig']?.state === 'on';

                              const getDuration = (datetimeEntityId) => {
                                const dateStr = states[datetimeEntityId]?.state;
                                if (!dateStr) return null;
                                const startTime = new Date(dateStr);
                                const now = new Date();
                                const diffMs = now - startTime;
                                const totalMin = Math.floor(diffMs / 60000);
                                const hours = Math.floor(totalMin / 60);
                                const minutes = totalMin % 60;
                                let result = '';
                                if (hours > 0) result += `${hours} Std. `;
                                if (minutes > 0 || hours === 0) result += `${minutes} Min`;
                                return result.trim();
                              };

                              if (laufend) {
                                const seit = getDuration('input_datetime.spulmaschine_startzeit');
                                return seit ? `🌀 Läuft seit ${seit}` : '🌀 Läuft';
                              }

                              if (fertig) {
                                const seit = getDuration('input_datetime.spulmaschine_fertig');
                                return seit ? `✅ Fertig seit ${seit}` : '✅ Fertig';
                              }

                              return '🛑 Aus';
                            ]]]
                          info: |
                            [[[
                              const laufend = states['input_boolean.spulmaschine_lauft']?.state === 'on';
                              const fertig = states['input_boolean.spulmaschine_fertig']?.state === 'on';
                              const powerRaw = parseFloat(states['sensor.spulmaschine_power']?.state || '0');
                              const power = powerRaw > 0 ? ` · ⚡ ${powerRaw} W` : '';
                              if (laufend) {
                                const fortschritt = states['sensor.spulmaschine_fortschritt']?.state || '–';
                                const verbleibend = states['sensor.spulmaschine_verbleibend']?.state || '–';
                                return `<div style="margin-top: 10px;">${fortschritt}% · ⏳ ${verbleibend} Min${power}</div>`;
                              }
                              if (fertig) return `<div style="margin-top: 10px;">🍽️ Sauber${power}</div>`;
                              return `<div style="margin-top: 10px;">☑️ Bereit${power}</div>`;
                            ]]]
                          progress: |
                            [[[
                              const laufend = states['input_boolean.spulmaschine_lauft']?.state === 'on';
                              if (!laufend) return '';
                              const fortschritt = parseInt(states['sensor.spulmaschine_fortschritt']?.state || 0);
                              return `<div style="background: rgba(255,255,255,0.25); height: 8px; border-radius: 4px; overflow: hidden; margin-top: 12px;"><div style="width: ${fortschritt}%; background: #00bcd4; height: 100%; transition: width 0.4s ease-in-out;"></div></div>`;
                            ]]]
                          zaehler: |
                            [[[
                              const starts = states['sensor.tageszahler_spulmaschine']?.state || '0';
                              const tag = states['sensor.spulmaschine_taglich']?.state || '–';
                              const monat = states['sensor.spulmaschine_monatlich']?.state || '–';
                              return `🔁 ${starts} · ${tag} kWh · ${monat} kWh`;
                            ]]]
                        styles:
                          card:
                            - height: 300px
                            - border-radius: 18px
                            - padding: 14px
                            - background: |
                                [[[
                                  if (states['input_boolean.spulmaschine_lauft']?.state === 'on')
                                    return "linear-gradient(145deg, #00bcd4, #0097a7)";
                                  if (states['input_boolean.spulmaschine_fertig']?.state === 'on')
                                    return "linear-gradient(145deg, #4caf50, #2e7d32)";
                                  return "var(--card-background-color)";
                                ]]]
                            - color: |
                                [[[
                                  if (
                                    states['input_boolean.spulmaschine_lauft']?.state === 'on' ||
                                    states['input_boolean.spulmaschine_fertig']?.state === 'on'
                                  ) return "white";
                                  return "var(--primary-text-color)";
                                ]]]
                            - box-shadow: 0 6px 14px rgba(0, 0, 0, 0.15)
                            - transition: all 0.3s ease
                          grid:
                            - grid-template-areas: |
                                "i"
                                "n"
                                "status"
                                "info"
                                "progress"
                                "zaehler"
                            - grid-template-rows: 1fr auto auto auto auto auto
                            - grid-template-columns: 1fr
                          name:
                            - font-weight: 600
                            - font-size: 1.3em
                            - letter-spacing: 0.3px
                            - justify-self: center
                          icon:
                            - width: 80px
                            - height: 110px
                            - justify-self: center
                            - margin-bottom: 8px
                          custom_fields:
                            status:
                              - text-align: center
                              - font-size: 1.1em
                              - font-weight: 500
                              - opacity: 0.95
                              - padding-top: 4px
                            info:
                              - text-align: center
                              - font-size: 1em
                              - font-weight: 500
                              - opacity: 0.85
                            progress:
                              - width: 100%
                            zaehler:
                              - text-align: center
                              - font-size: 0.95em
                              - padding-top: 12px
                              - opacity: 0.75
                      - type: entities
                        entities:
                          - entity: input_boolean.spulmaschine_lauft
                            name: Status
                            state_color: true
                            type: simple-entity
                          - entity: sensor.spulmaschine_power
                            name: Verbrauch
                          - entity: input_datetime.spulmaschine_startzeit
                            name: Startzeit
                            type: simple-entity
                            format: relative
                            show_age: true
                          - entity: sensor.spulmaschine_laufzeit
                            name: Laufzeit
                            state_color: true
                          - entity: input_datetime.spulmaschine_fertig
                            name: Endzeit
                            type: simple-entity
                            format: relative
                            show_age: true
                          - entity: sensor.spulmaschine_stoppuhr
                            name: Dauer
                            state_color: true
                          - entity: sensor.tageszahler_spulmaschine
                            name: Tageszähler
                          - entity: sensor.monatszahler_spulmaschine
                            name: Monatszähler
                          - entity: sensor.spulmaschine_taglich
                            name: Stromverbrauch Tag
                          - entity: sensor.stromkosten_spulmaschine_tag
                            name: Stromkosten Tag
                          - entity: sensor.spulmaschine_wochentlich
                            name: Stromverbrauch Wöchentlich
                          - entity: sensor.stromkosten_spulmaschine_woche
                            name: Stromkosten Woche
                          - entity: sensor.spulmaschine_monatlich
                            name: Stromverbrauch Monatlich
                          - entity: sensor.stromkosten_spulmaschine_monat
                            name: Stromkosten Monat
                          - entity: sensor.spulmaschine_jahrlich
                            name: Stromverbrauch Jährlich
                          - entity: sensor.stromkosten_spulmaschine_jahr
                            name: Stromkosten Jahr
                      - type: conditional
                        conditions:
                          - entity: input_boolean.spulmaschine_fertig
                            state: 'on'
                        card:
                          type: horizontal-stack
                          cards:
                            - type: custom:button-card
                              name: ❌ Abbrechen
                              icon: mdi:close
                              tap_action:
                                action: fire-dom-event
                                browser_mod:
                                  service: browser_mod.close_popup
                              styles:
                                card:
                                  - border-radius: 12px
                                  - background: rgba(255, 255, 255, 0.1)
                                  - color: var(--primary-text-color)
                                  - box-shadow: none
                                  - padding: 12px
                                  - height: 50px
                            - type: custom:button-card
                              name: ✅ Zurücksetzen
                              icon: mdi:restart
                              tap_action:
                                action: fire-dom-event
                                browser_mod:
                                  service: browser_mod.sequence
                                  data:
                                    sequence:
                                      - service: input_boolean.turn_off
                                        data:
                                          entity_id: input_boolean.spulmaschine_fertig
                                      - service: browser_mod.close_popup
                              styles:
                                card:
                                  - border-radius: 12px
                                  - background: linear-gradient(145deg,
                                  - color: white
                                  - box-shadow: 0 4px 10px rgba(0,0,0,0.2)
                                  - padding: 12px
                                  - height: 50px
          - type: template
            entity: input_boolean.backofen_lauft
            icon_color: '{{ ''deep-orange'' if is_state(entity, ''on'') else ''grey'' }}'
            icon: '{{ ''mdi:stove'' if is_state(entity, ''on'') else ''mdi:stove'' }}'
            tap_action:
              action: fire-dom-event
              browser_mod:
                service: browser_mod.popup
                data:
                  title: Backofen
                  size: normal
                  content:
                    type: vertical-stack
                    cards:
                      - type: custom:button-card
                        entity: input_boolean.backofen_lauft
                        name: Backofen
                        icon: mdi:stove
                        show_state: false
                        show_label: false
                        layout: vertical
                        custom_fields:
                          status: |
                            [[[
                              const laufend = entity.state === 'on';
                              const stoppuhr = states['sensor.backofen_stoppuhr']?.state || '–';
                              if (laufend && stoppuhr !== '–') return `🔥 Läuft seit ${stoppuhr}`;
                              return '🛑 Aus';
                            ]]]
                          info: |
                            [[[
                              const laufend = entity.state === 'on';
                              const laufzeit = states['sensor.backofen_stoppuhr']?.state || '–';
                              const power = parseFloat(states['sensor.backofen_power']?.state || '0');
                              if (laufend && power > 0) return `<div style="margin-top: 10px;">⏱ ${laufzeit} · ⚡ ${power} W</div>`;
                              if (laufend) return `<div style="margin-top: 10px;">⏱ ${laufzeit}</div>`;
                              if (power > 0) return `<div style="margin-top: 10px;">⚡ ${power} W</div>`;
                              return "";
                            ]]]
                          zaehler: |
                            [[[
                              const starts = states['sensor.tageszahler_backofen']?.state || '0';
                              const tag = states['sensor.backofen_taglich']?.state || '–';
                              const monat = states['sensor.backofen_monatlich']?.state || '–';
                              return `🔁 ${starts} · ${tag} kWh · ${monat} kWh`;
                            ]]]
                        styles:
                          card:
                            - height: 300px
                            - border-radius: 18px
                            - padding: 14px
                            - background: |
                                [[[
                                  if (entity.state === 'on')
                                    return "linear-gradient(145deg, #ff5722, #e64a19)";
                                  return "var(--card-background-color)";
                                ]]]
                            - color: |
                                [[[
                                  if (entity.state === 'on')
                                    return "white";
                                  return "var(--primary-text-color)";
                                ]]]
                            - box-shadow: 0 6px 14px rgba(0, 0, 0, 0.15)
                            - transition: all 0.3s ease
                          grid:
                            - grid-template-areas: |
                                "i"
                                "n"
                                "status"
                                "info"
                                "zaehler"
                            - grid-template-rows: 1fr auto auto auto auto
                            - grid-template-columns: 1fr
                          name:
                            - font-weight: 600
                            - font-size: 1.3em
                            - letter-spacing: 0.3px
                            - justify-self: center
                          icon:
                            - animation: |
                                [[[
                                  return entity.state === 'on' ? "pulse 2s infinite ease-in-out" : "none";
                                ]]]
                            - width: 80px
                            - height: 110px
                            - justify-self: center
                            - margin-bottom: 8px
                          custom_fields:
                            status:
                              - text-align: center
                              - font-size: 1em
                              - font-weight: 500
                              - opacity: 0.9
                              - padding-top: 4px
                            info:
                              - text-align: center
                              - font-size: 1em
                              - font-weight: 500
                              - opacity: 0.85
                            zaehler:
                              - text-align: center
                              - font-size: 0.95em
                              - padding-top: 12px
                              - opacity: 0.75
                        extra_styles: |
                          @keyframes pulse {
                            0% { transform: scale(1); }
                            50% { transform: scale(1.1); }
                            100% { transform: scale(1); }
                          }
                      - type: entities
                        entities:
                          - entity: input_boolean.backofen_lauft
                            name: Status
                            state_color: true
                            type: simple-entity
                          - entity: sensor.backofen_power
                            name: Verbrauch
                          - entity: input_datetime.backofen_startzeit
                            name: Startzeit
                            type: simple-entity
                            format: relative
                            show_age: true
                          - entity: sensor.backofen_laufzeit
                            name: Laufzeit
                            state_color: true
                          - entity: input_datetime.backofen_endzeit
                            name: Endzeit
                            type: simple-entity
                            format: relative
                            show_age: true
                          - entity: sensor.backofen_stoppuhr
                            name: Dauer
                            state_color: true
                          - entity: sensor.tageszahler_backofen
                            name: Tageszähler
                          - entity: sensor.monatszahler_backofen
                            name: Monatszähler
                          - entity: sensor.backofen_taglich
                            name: Stromverbrauch Tag
                          - entity: sensor.stromkosten_backofen_tag
                            name: Stromkosten Tag
                          - entity: sensor.backofen_wochentlich
                            name: Stromverbrauch Wöchentlich
                          - entity: sensor.stromkosten_backofen_woche
                            name: Stromkosten Woche
                          - entity: sensor.backofen_monatlich
                            name: Stromverbrauch Monatlich
                          - entity: sensor.stromkosten_backofen_monat
                            name: Stromkosten Monat
                          - entity: sensor.backofen_jahrlich
                            name: Stromverbrauch Jährlich
                          - entity: sensor.stromkosten_backofen_jahr
                            name: Stromkosten Jahr
          - type: template
            entity: input_boolean.kaffeevollautomat_eingeschaltet
            icon_color: '{{ ''orange'' if is_state(entity, ''on'') else ''grey'' }}'
            icon: >-
              {{ 'mdi:coffee-maker' if is_state(entity, 'on') else
              'mdi:coffee-maker' }}
            tap_action:
              action: fire-dom-event
              browser_mod:
                service: browser_mod.popup
                data:
                  title: Kaffeevollautomat
                  size: normal
                  content:
                    type: vertical-stack
                    cards:
                      - type: custom:button-card
                        entity: input_boolean.kaffeevollautomat_eingeschaltet
                        name: Kaffeevollautomat
                        icon: mdi:coffee-maker-outline
                        show_state: false
                        show_label: false
                        custom_fields:
                          status: |
                            [[[
                              const laufend = entity.state === 'on';
                              const stoppuhr = states['sensor.kaffeevollautomat_stoppuhr']?.state || '–';
                              if (laufend && stoppuhr !== '–') return `☕ Läuft seit ${stoppuhr}`;
                              return '🛑 Aus';
                            ]]]
                          info: |
                            [[[
                              const laufend = entity.state === 'on';
                              const laufzeit = states['sensor.kaffeevollautomat_stoppuhr']?.state || '–';
                              const power = parseFloat(states['sensor.kaffeevollautomat_power']?.state || 0);

                              if (laufend && power > 0) return `<div style="margin-top: 10px;">⏱ ${laufzeit} · ⚡ ${power} W</div>`;
                              if (laufend) return `<div style="margin-top: 10px;">⏱ ${laufzeit}</div>`;
                              if (power > 0) return `<div style="margin-top: 10px;">⚡ ${power} W</div>`;
                              return "";
                            ]]]
                          zaehler: |
                            [[[
                              const starts = states['sensor.tageszahler_kaffeevollautomat']?.state || '0';
                              const tag = parseFloat(states['sensor.kaffeevollautomat_taglich']?.state || 0).toFixed(2);
                              const monat = parseFloat(states['sensor.kaffeevollautomat_monatlich']?.state || 0).toFixed(2);
                              return `🔁 ${starts} · ${tag} kWh · ${monat} kWh`;
                            ]]]
                        styles:
                          card:
                            - height: 300px
                            - border-radius: 18px
                            - padding: 14px
                            - background: |
                                [[[
                                  if (entity.state === 'on')
                                    return "linear-gradient(145deg, #8d6e63, #6d4c41)";
                                  return "var(--card-background-color)";
                                ]]]
                            - color: |
                                [[[
                                  if (entity.state === 'on')
                                    return "white";
                                  return "var(--primary-text-color)";
                                ]]]
                            - box-shadow: 0 6px 14px rgba(0, 0, 0, 0.15)
                            - transition: all 0.3s ease
                          grid:
                            - grid-template-areas: |
                                "i"
                                "n"
                                "status"
                                "info"
                                "zaehler"
                            - grid-template-rows: 1fr auto auto auto auto
                            - grid-template-columns: 1fr
                          name:
                            - font-weight: 600
                            - font-size: 1.3em
                            - letter-spacing: 0.3px
                            - justify-self: center
                          icon:
                            - width: 80px
                            - height: 110px
                            - justify-self: center
                            - margin-bottom: 8px
                            - animation: |
                                [[[
                                  return entity.state === 'on' ? "pulse 2s infinite ease-in-out" : "none";
                                ]]]
                          custom_fields:
                            status:
                              - text-align: center
                              - font-size: 1em
                              - font-weight: 500
                              - opacity: 0.9
                              - padding-top: 4px
                            info:
                              - text-align: center
                              - font-size: 1em
                              - font-weight: 500
                              - opacity: 0.85
                            zaehler:
                              - text-align: center
                              - font-size: 0.95em
                              - padding-top: 12px
                              - opacity: 0.75
                        tap_action:
                          action: more-info
                        extra_styles: |
                          @keyframes pulse {
                            0% { transform: scale(1); }
                            50% { transform: scale(1.1); }
                            100% { transform: scale(1); }
                          }
                      - type: entities
                        entities:
                          - entity: input_boolean.kaffeevollautomat_eingeschaltet
                            name: Status
                            state_color: true
                            type: simple-entity
                          - entity: sensor.kaffeevollautomat_power
                            name: Verbrauch
                          - entity: input_datetime.kaffeevollautomat_startzeit
                            name: Startzeit
                            type: simple-entity
                            format: relative
                            show_age: true
                          - entity: sensor.kaffeevollautomat_stoppuhr
                            name: Laufzeit
                            state_color: true
                          - entity: input_datetime.kaffeevollautomat_endzeit
                            name: Endzeit
                            type: simple-entity
                            format: relative
                            show_age: true
                          - entity: sensor.tageszahler_kaffeevollautomat
                            name: Tageszähler
                          - entity: sensor.monatszahler_kaffeevollautomat
                            name: Monatszähler
                          - entity: sensor.kaffeevollautomat_taglich
                            name: Stromverbrauch Tag
                          - entity: sensor.stromkosten_kaffeevollautomat_tag
                            name: Stromkosten Tag
                          - entity: sensor.kaffeevollautomat_wochentlich
                            name: Stromverbrauch Wöchentlich
                          - entity: sensor.stromkosten_kaffeevollautomat_woche
                            name: Stromkosten Woche
                          - entity: sensor.kaffeevollautomat_monatlich
                            name: Stromverbrauch Monatlich
                          - entity: sensor.stromkosten_kaffeevollautomat_monat
                            name: Stromkosten Monat
                          - entity: sensor.kaffeevollautomat_jahrlich
                            name: Stromverbrauch Jährlich
                          - entity: sensor.stromkosten_kaffeevollautomat_jahr
                            name: Stromkosten Jahr
          - type: template
            entity: input_boolean.airfryer_kuchenmaschine
            icon_color: '{{ ''orange'' if is_state(entity, ''on'') else ''grey'' }}'
            icon: '{{ ''mdi:chef-hat'' if is_state(entity, ''on'') else ''mdi:chef-hat'' }}'
            tap_action:
              action: fire-dom-event
              browser_mod:
                service: browser_mod.popup
                data:
                  title: Airfryer & Küchenmaschine
                  size: normal
                  content:
                    type: vertical-stack
                    cards:
                      - type: custom:button-card
                        entity: input_boolean.airfryer_kuchenmaschine
                        name: Airfryer & Brotbackautomat
                        icon: phu:airfryer
                        show_state: false
                        show_label: false
                        custom_fields:
                          status: |
                            [[[
                              const isOn = states[entity.entity_id].state === 'on';
                              const stoppuhr = states['sensor.airfryer_stoppuhr']?.state || '–';
                              if (isOn) {
                                return stoppuhr !== '–' ? `🔥 Läuft seit ${stoppuhr}` : '🔥 Läuft';
                              }
                              return '🛑 Aus';
                            ]]]
                          info: |
                            [[[
                              const isOn = states[entity.entity_id].state === 'on';
                              const stoppuhr = states['sensor.airfryer_stoppuhr']?.state || '–';
                              const power = parseFloat(states['sensor.kuchenmaschine_power']?.state || '0');

                              if (isOn && power > 0) return `<div style="margin-top: 10px;">⏱ ${stoppuhr} · ⚡ ${power.toFixed(0)} W</div>`;
                              if (isOn) return `<div style="margin-top: 10px;">⏱ ${stoppuhr}</div>`;
                              if (power > 0) return `<div style="margin-top: 10px;">⚡ ${power.toFixed(0)} W</div>`;
                              return "";
                            ]]]
                          zaehler: |
                            [[[
                              const starts = states['sensor.tageszahler_airfryer']?.state || '0';
                              const tag = parseFloat(states['sensor.kuchenmaschine_taglich']?.state || 0).toFixed(2);
                              const monat = parseFloat(states['sensor.kuchenmaschine_monatlich']?.state || 0).toFixed(2);
                              return `🔁 ${starts} · ${tag} kWh · ${monat} kWh`;
                            ]]]
                        styles:
                          card:
                            - height: 300px
                            - border-radius: 18px
                            - padding: 14px
                            - background: |
                                [[[
                                  return states[entity.entity_id].state === 'on' 
                                    ? "linear-gradient(145deg, #ff9800, #fb8c00)"
                                    : "var(--card-background-color)";
                                ]]]
                            - color: |
                                [[[
                                  return states[entity.entity_id].state === 'on'
                                    ? "white"
                                    : "var(--primary-text-color)";
                                ]]]
                            - box-shadow: 0 6px 14px rgba(0, 0, 0, 0.15)
                            - transition: all 0.3s ease
                          grid:
                            - grid-template-areas: |
                                "i"
                                "n"
                                "status"
                                "info"
                                "zaehler"
                            - grid-template-rows: 1fr auto auto auto auto
                            - grid-template-columns: 1fr
                          name:
                            - font-weight: 600
                            - font-size: 1.3em
                            - letter-spacing: 0.3px
                            - justify-self: center
                          icon:
                            - width: 80px
                            - height: 110px
                            - justify-self: center
                            - margin-bottom: 8px
                            - animation: |
                                [[[
                                  return states[entity.entity_id].state === 'on' 
                                    ? "pulse 2s infinite ease-in-out" 
                                    : "none";
                                ]]]
                          custom_fields:
                            status:
                              - text-align: center
                              - font-size: 1em
                              - font-weight: 500
                              - opacity: 0.9
                              - padding-top: 4px
                            info:
                              - text-align: center
                              - font-size: 1em
                              - font-weight: 500
                              - opacity: 0.85
                            zaehler:
                              - text-align: center
                              - font-size: 0.95em
                              - padding-top: 12px
                              - opacity: 0.75
                        tap_action:
                          action: more-info
                        extra_styles: |
                          @keyframes pulse {
                            0% { transform: scale(1); }
                            50% { transform: scale(1.1); }
                            100% { transform: scale(1); }
                          }           
                      - type: entities
                        entities:
                          - entity: input_boolean.airfryer_kuchenmaschine
                            name: Status
                            state_color: true
                            type: simple-entity
                          - entity: sensor.kuchenmaschine_power
                            name: Verbrauch
                          - entity: input_datetime.airfryer_startzeit
                            name: Startzeit
                            type: simple-entity
                            format: relative
                            show_age: true
                          - entity: sensor.airfryer_stoppuhr
                            name: Laufzeit
                            state_color: true
                          - entity: input_datetime.airfryer_endzeit
                            name: Endzeit
                            type: simple-entity
                            format: relative
                            show_age: true
                          - entity: sensor.tageszahler_airfryer
                            name: Tageszähler
                          - entity: sensor.monatszahler_airfryer
                            name: Monatszähler
                          - entity: sensor.kuchenmaschine_taglich
                            name: Stromverbrauch Tag
                          - entity: sensor.stromkosten_airfryer_tag
                            name: Stromkosten Tag
                          - entity: sensor.kuchenmaschine_wochentlich
                            name: Stromverbrauch Wöchentlich
                          - entity: sensor.stromkosten_airfryer_woche
                            name: Stromkosten Woche
                          - entity: sensor.kuchenmaschine_monatlich
                            name: Stromverbrauch Monatlich
                          - entity: sensor.stromkosten_airfryer_monat
                            name: Stromkosten Monat
                          - entity: sensor.kuchenmaschine_jahrlich
                            name: Stromverbrauch Jährlich
                          - entity: sensor.stromkosten_airfryer_jahr
                            name: Stromkosten Jahr
          - type: template
            entity: input_boolean.autoladegerat_an
            icon_color: >-
              {{ 'green' if is_state('input_boolean.auto_ladegerat_fertig',
              'on')  
                else 'orange' if is_state(entity, 'on')  
                else 'grey' }}
            icon: >-
              {{ 'mdi:car-electric' if
              is_state('input_boolean.auto_ladegerat_fertig', 'on')
                else 'mdi:car-electric' if is_state(entity, 'on')
                else 'mdi:car-off' }}
            tap_action:
              action: fire-dom-event
              browser_mod:
                service: browser_mod.popup
                data:
                  title: Autoladegerät
                  size: normal
                  content:
                    type: vertical-stack
                    cards:
                      - type: custom:button-card
                        entity: input_boolean.autoladegerat_an
                        name: Autoladegerät
                        icon: mdi:ev-station
                        show_state: false
                        show_label: false
                        custom_fields:
                          status: |
                            [[[
                              const laufend = entity.state === 'on';
                              const fertig = states['input_boolean.auto_ladegerat_fertig']?.state === 'on';
                              const dauer = states['sensor.autoladegerat_stoppuhr']?.state || '–';
                              if (laufend && dauer !== '–') return `🔌 Lädt seit ${dauer}`;
                              if (fertig) return '✅ Fertig geladen';
                              return '🛑 Aus';
                            ]]]
                          info: |
                            [[[
                              const power = parseFloat(states['sensor.autoladegerat_leistung']?.state || '0');
                              if (power > 5) return `<div style="margin-top: 10px;">⚡ ${power} W</div>`;
                              return "";
                            ]]]
                          zaehler: |
                            [[[
                              const tagRaw = states['sensor.kia_ceed_sw_stromverbrauch_taglich']?.state || '0';
                              const monatRaw = states['sensor.kia_ceed_sw_stromverbrauch_monatlich']?.state || '0';
                              const tag = isNaN(parseFloat(tagRaw)) ? '–' : parseFloat(tagRaw).toFixed(2);
                              const monat = isNaN(parseFloat(monatRaw)) ? '–' : parseFloat(monatRaw).toFixed(2);
                              return `📊 ${tag} kWh · ${monat} kWh`;
                            ]]]
                        styles:
                          card:
                            - height: 300px
                            - border-radius: 18px
                            - padding: 14px
                            - background: |
                                [[[
                                  if (entity.state === 'on')
                                    return "linear-gradient(145deg, #ffa726, #fb8c00)";
                                  return "var(--card-background-color)";
                                ]]]
                            - color: |
                                [[[
                                  if (entity.state === 'on')
                                    return "white";
                                  return "var(--primary-text-color)";
                                ]]]
                            - box-shadow: 0 6px 14px rgba(0, 0, 0, 0.15)
                            - transition: all 0.3s ease
                          grid:
                            - grid-template-areas: |
                                "i"
                                "n"
                                "status"
                                "info"
                                "zaehler"
                            - grid-template-rows: 1fr auto auto auto auto
                            - grid-template-columns: 1fr
                          name:
                            - font-weight: 600
                            - font-size: 1.3em
                            - letter-spacing: 0.3px
                            - justify-self: center
                          icon:
                            - width: 80px
                            - height: 110px
                            - justify-self: center
                            - margin-bottom: 8px
                            - animation: |
                                [[[
                                  return entity.state === 'on' ? "pulse 2s infinite ease-in-out" : "none";
                                ]]]
                          custom_fields:
                            status:
                              - text-align: center
                              - font-size: 1em
                              - font-weight: 500
                              - opacity: 0.9
                              - padding-top: 4px
                            info:
                              - text-align: center
                              - font-size: 1em
                              - font-weight: 500
                              - opacity: 0.85
                            zaehler:
                              - text-align: center
                              - font-size: 0.95em
                              - padding-top: 12px
                              - opacity: 0.75
                        tap_action:
                          action: more-info
                        extra_styles: |
                          @keyframes pulse {
                            0% { transform: scale(1); }
                            50% { transform: scale(1.1); }
                            100% { transform: scale(1); }
                          }
                                                  
                      - type: entities
                        entities:
                          - entity: input_boolean.autoladegerat_an
                            name: Status
                            state_color: true
                            type: simple-entity
                          - entity: sensor.ceed_ev_battery_level
                            name: Akkustand
                            type: simple-entity
                          - entity: binary_sensor.ceed_ev_battery_plug
                            name: Stecker
                            state_color: true
                          - entity: sensor.autoladegerat_leistung
                            name: Verbrauch
                          - entity: sensor.monatszahler_autoladegerat
                            name: Monatszähler
                          - entity: input_datetime.autoladegerat_startzeit
                            name: Startzeit
                            type: simple-entity
                            format: relative
                            show_age: true
                          - entity: sensor.autoladegerat_laufzeit
                            name: Laufzeit
                            state_color: true
                          - entity: input_datetime.autoladegerat_endzeit
                            name: Endzeit
                            type: simple-entity
                            format: relative
                            show_age: true
                          - entity: sensor.autoladegerat_stoppuhr
                            name: Dauer
                            state_color: true
                          - entity: sensor.kia_ceed_sw_stromverbrauch_taglich
                            name: Stromverbrauch Tag
                          - entity: sensor.stromkosten_autoladegerat_tag
                            name: Stromkosten Tag
                          - entity: sensor.kia_ceed_sw_stromverbrauch_wochentlich
                            name: Stromverbrauch Wöchentlich
                          - entity: sensor.stromkosten_autoladegerat_woche
                            name: Stromkosten Woche
                          - entity: sensor.kia_ceed_sw_stromverbrauch_monatlich
                            name: Stromverbrauch Monatlich
                          - entity: sensor.stromkosten_autoladegerat_monat
                            name: Stromkosten Monat
                          - entity: sensor.kia_ceed_sw_stromverbrauch_jahrlich
                            name: Stromverbrauch Jährlich
                          - entity: sensor.stromkosten_autoladegerat_jahr
                            name: Stromkosten Jahr
        card_mod:
          style:
            mushroom-template-chip:nth-child(1)$: |
              ha-state-icon {
                {{ 'animation: bounce 1s linear infinite;' if is_state('input_boolean.waschmaschine_lauft', 'on') }}
                {{ 'animation: pulse-green 2s infinite; color: #4CAF50;' if is_state('input_boolean.waschmaschine_fertig', 'on') }}
              } 
              @keyframes bounce {
                0%, 10%, 50%, 80%, 100% {transform: translateY(0); }
                40% { transform: translateY(-1.2px) rotate(5deg); }
                60% { transform: translateY(-1.1px) rotate(4deg); }
              }  
              @keyframes pulse-green {
                0% { opacity: 1; }
                50% { opacity: 0.6; }
                100% { opacity: 1; }
              }
            mushroom-template-chip:nth-child(2)$: |
              ha-state-icon {
                {{ 'animation: bounce 1s linear infinite;' if is_state('input_boolean.trockner_lauft', 'on') }}
                {{ 'animation: pulse-green 2s infinite; color: #4CAF50;' if is_state('input_boolean.trockner_fertig', 'on') }}
              } 
              @keyframes bounce {
                0%, 10%, 50%, 80%, 100% {transform: translateY(0); }
                40% { transform: translateY(-1.2px) rotate(5deg); }
                60% { transform: translateY(-1.1px) rotate(4deg); }
              } 
              @keyframes pulse-green {
                0% { opacity: 1; }
                50% { opacity: 0.6; }
                100% { opacity: 1; }
              }
            mushroom-template-chip:nth-child(3)$: |
              ha-state-icon {
                {{ 'animation: bounce 1s linear infinite;' if is_state('input_boolean.spulmaschine_lauft', 'on') }}
                {{ 'animation: pulse-green 2s infinite; color: #4CAF50;' if is_state('input_boolean.spulmaschine_fertig', 'on') }}
              } 
              @keyframes bounce {
                0%, 10%, 50%, 80%, 100% {transform: translateY(0); }
                40% { transform: translateY(-1.2px) rotate(5deg); }
                60% { transform: translateY(-1.1px) rotate(4deg); }
              }
              @keyframes pulse-green {
                0% { opacity: 1; }
                50% { opacity: 0.6; }
                100% { opacity: 1; }
              }
            mushroom-template-chip:nth-child(4)$: |
              ha-state-icon {
                {{ 'animation: bounce 1s linear infinite;' if is_state('input_boolean.backofen_lauft', 'on') }}
              } 
              @keyframes bounce {
                0%, 10%, 50%, 80%, 100% {transform: translateY(0); }
                40% { transform: translateY(-1.2px) rotate(5deg); }
                60% { transform: translateY(-1.1px) rotate(4deg); }
              }
            mushroom-template-chip:nth-child(5)$: |
              ha-state-icon {
                {{ 'animation: boing 3s linear infinite; transform-origin: 50% 90%;' if is_state('input_boolean.kaffeevollautomat_eingeschaltet', 'on') }}
              } 
              @keyframes boing {
                0% { transform: scale3d(1, 1, 1); }
                7% { transform: scale3d(1.25, 0.75, 1); }
                10% { transform: scale3d(0.75, 1.25, 1); }
                12% { transform: scale3d(1.15, 0.85, 1); }
                16% { transform: scale3d(0.95, 1.05, 1); }
                19% { transform: scale3d(1.05, 0.95, 1); }
                25% { transform: scale3d(1, 1, 1); }
              } 
            mushroom-template-chip:nth-child(6)$: |
              ha-state-icon {
                {{ 'animation: boing 3s linear infinite; transform-origin: 50% 90%;' if is_state('input_boolean.airfryer_kuchenmaschine', 'on') }}
              } 
              @keyframes boing {
                0% { transform: scale3d(1, 1, 1); }
                7% { transform: scale3d(1.25, 0.75, 1); }
                10% { transform: scale3d(0.75, 1.25, 1); }
                12% { transform: scale3d(1.15, 0.85, 1); }
                16% { transform: scale3d(0.95, 1.05, 1); }
                19% { transform: scale3d(1.05, 0.95, 1); }
                25% { transform: scale3d(1, 1, 1); }
              }
            mushroom-template-chip:nth-child(7)$: |
              ha-state-icon {
                {{ 'animation: boing 3s linear infinite; transform-origin: 50% 90%;' if is_state('input_boolean.autoladegerat_an', 'on') }}
                {{ 'animation: pulse-green 2s infinite; color: #4CAF50;' if is_state('input_boolean.auto_ladegerat_fertig', 'on') }}
              }
              @keyframes boing {
                0% { transform: scale3d(1, 1, 1); }
                7% { transform: scale3d(1.25, 0.75, 1); }
                10% { transform: scale3d(0.75, 1.25, 1); }
                12% { transform: scale3d(1.15, 0.85, 1); }
                16% { transform: scale3d(0.95, 1.05, 1); }
                19% { transform: scale3d(1.05, 0.95, 1); }
                25% { transform: scale3d(1, 1, 1); }
              }
              @keyframes pulse-green {
                0% { opacity: 1; }
                50% { opacity: 0.6; }
                100% { opacity: 1; }
              }
      - type: custom:mushroom-chips-card
        chips:
          - type: template
            entity: cover.terasse
            content: Terr
            icon: >-
              {{ 'mdi:window-shutter-open' if is_state(entity, 'open') else
              'mdi:window-shutter' }}
            icon_color: >-
              {% if is_state(entity, 'open') %}green {% elif is_state(entity,
              'closed') %}red {% elif is_state(entity, 'closing') %}orange {%
              elif is_state(entity, 'opening') %}light-green {% else %}grey {%
              endif %}
            tap_action:
              action: more-info
          - type: template
            entity: cover.wohnzimmer
            content: Wohnz
            icon: >-
              {{ 'mdi:window-shutter-open' if is_state(entity, 'open') else
              'mdi:window-shutter' }}
            icon_color: >-
              {% if is_state(entity, 'open') %}green {% elif is_state(entity,
              'closed') %}red {% elif is_state(entity, 'closing') %}orange {%
              elif is_state(entity, 'opening') %}light-green {% else %}grey {%
              endif %}
            tap_action:
              action: more-info
          - type: template
            entity: cover.kuche
            content: Küche
            icon: >-
              {{ 'mdi:window-shutter-open' if is_state(entity, 'open') else
              'mdi:window-shutter' }}
            icon_color: >-
              {% if is_state(entity, 'open') %}green {% elif is_state(entity,
              'closed') %}red {% elif is_state(entity, 'closing') %}orange {%
              elif is_state(entity, 'opening') %}light-green {% else %}grey {%
              endif %}
            tap_action:
              action: more-info
          - type: template
            entity: cover.esszimmer
            content: Ess
            icon: >-
              {{ 'mdi:window-shutter-open' if is_state(entity, 'open') else
              'mdi:window-shutter' }}
            icon_color: >-
              {% if is_state(entity, 'open') %}green {% elif is_state(entity,
              'closed') %}red {% elif is_state(entity, 'closing') %}orange {%
              elif is_state(entity, 'opening') %}light-green {% else %}grey {%
              endif %}
            tap_action:
              action: more-info
        alignment: center
        card_mod:
          style:
            mushroom-template-chip:nth-child(1)$: |
              ha-state-icon {
                {% if is_state('cover.terasse', 'opening') or is_state('cover.terasse', 'closing') %}
                  animation: move 2s linear infinite;
                {% endif %}
              }
            mushroom-template-chip:nth-child(2)$: |
              ha-state-icon {
                {% if is_state('cover.wohnzimmer', 'opening') or is_state('cover.wohnzimmer', 'closing') %}
                  animation: move 2s linear infinite;
                {% endif %}
              }
            mushroom-template-chip:nth-child(3)$: |
              ha-state-icon {
                {% if is_state('cover.kuche', 'opening') or is_state('cover.kuche', 'closing') %}
                  animation: move 2s linear infinite;
                {% endif %}
              }
            mushroom-template-chip:nth-child(4)$: |
              ha-state-icon {
                {% if is_state('cover.esszimmer', 'opening') or is_state('cover.esszimmer', 'closing') %}
                  animation: move 2s linear infinite;
                {% endif %}
              }
            .: |
              @keyframes move {
                0% { transform: translateY(0); }
                50% { transform: translateY(3px); }
                100% { transform: translateY(0); }
              }
      - type: custom:layout-card
        layout_type: custom:grid-layout
        cards:
          - type: custom:layout-card
            layout_type: custom:grid-layout
            layout:
              margin: 0
            cards:
              - square: false
                type: grid
                columns: 2
                cards:
                  - type: custom:mushroom-template-card
                    primary: Fenster
                    secondary: >-
                      {% set group = expand('binary_sensor.alle_fenster') %} {%
                      set count = group | selectattr('state', 'eq', 'on') | list
                      | count if group is not none else 0 %} {% if count > 0 %}
                        🪟 {{ count }} Geöffnet
                      {% else %}
                        ✅ Alle zu
                      {% endif %}
                    icon: |-
                      {% if is_state('binary_sensor.alle_fenster', 'on') %}  
                        mdi:window-open-variant  
                      {% else %}  
                        mdi:window-closed-variant  
                      {% endif %}  
                    icon_color: |-
                      {% if is_state('binary_sensor.alle_fenster', 'on') %}  
                        red  
                      {% else %}  
                        green  
                      {% endif %}  
                    badge_icon: ''
                    entity: binary_sensor.alle_fenster
                    tap_action:
                      action: fire-dom-event
                      browser_mod:
                        service: browser_mod.popup
                        data:
                          title: Alle Fenster
                          size: normal
                          content:
                            type: custom:layout-card
                            layout_type: custom:grid-layout
                            layout:
                              margin: 0
                            cards:
                              - type: custom:vertical-stack-in-card
                                cards:
                                  - type: entities
                                    entities:
                                      - entity: binary_sensor.fenster_bad_contact
                                        name: Bad
                                        state_color: true
                                      - entity: sensor.fenster_bad_geschlossen
                                        name: Geschlossen
                                      - entity: sensor.fenster_bad_battery
                                        name: Batterie
                                      - type: divider
                                      - entity: binary_sensor.fenster_buro_contact
                                        name: Büro
                                        state_color: true
                                      - entity: sensor.fenster_buro_geschlossen
                                        name: Geschlossen
                                      - entity: sensor.fenster_buro_battery
                                        name: Batterie
                                      - type: divider
                                      - entity: binary_sensor.fenster_wc_og_contact
                                        name: WC-OG
                                        state_color: true
                                      - entity: sensor.fenster_wc_og_geschlossen
                                        name: Geschlossen
                                      - entity: sensor.fenster_wc_og_battery
                                        name: Batterie
                                      - type: divider
                                      - entity: binary_sensor.fenster_wc_eg_contact
                                        name: WC-EG
                                        state_color: true
                                      - entity: sensor.fenster_wc_eg_geschlossen
                                        name: Geschlossen
                                      - entity: sensor.fenster_wc_eg_battery
                                        name: Batterie
                                      - type: divider
                                      - entity: binary_sensor.fenster_kuche_contact
                                        name: Küche
                                        state_color: true
                                      - entity: sensor.fenster_kuche_geschlossen
                                        name: Geschlossen
                                      - entity: sensor.fenster_kuche_battery
                                        name: Batterie
                                  - type: history-graph
                                    entities:
                                      - entity: binary_sensor.fenster_bad_contact
                                        name: Bad
                                      - entity: binary_sensor.fenster_buro_contact
                                        name: Büro
                                      - entity: binary_sensor.fenster_wc_og_contact
                                        name: WC-OG
                                      - entity: binary_sensor.fenster_wc_eg_contact
                                        name: WC-EG
                                      - entity: binary_sensor.fenster_kuche_contact
                                        name: Küche
                                    title: Verlauf
                                    hours_to_show: 24
                                  - type: logbook
                                    entities:
                                      - entity: binary_sensor.fenster_bad_contact
                                        name: Bad
                                      - entity: binary_sensor.fenster_buro_contact
                                        name: Büro
                                      - entity: binary_sensor.fenster_wc_og_contact
                                        name: WC-OG
                                      - entity: binary_sensor.fenster_wc_eg_contact
                                        name: WC-EG
                                      - entity: binary_sensor.fenster_kuche_contact
                                        name: Büche
                                    hours_to_show: 24
                                    title: Logbuch
                                columns: 1
                  - type: custom:mushroom-template-card
                    primary: Türen
                    secondary: >-
                      {% set group = expand('binary_sensor.alle_turen') %}   {%
                      set count = group | selectattr('state', 'eq', 'on') | list
                      | count if group is not none else 0 %}   {% if count > 0
                      %}  
                        🚪 {{ count }} Geöffnet  
                      {% else %}  
                        ✅ Alle zu 
                      {% endif %}  
                    icon: |-
                      {% if is_state('binary_sensor.alle_turen', 'on') %}  
                        mdi:door-open  
                      {% else %}  
                        mdi:door-closed  
                      {% endif %}  
                    icon_color: |-
                      {% if is_state('binary_sensor.alle_turen', 'on') %}  
                        red  
                      {% else %}  
                        green  
                      {% endif %}  
                    badge_icon: ''
                    entity: binary_sensor.alle_turen
                    tap_action:
                      action: fire-dom-event
                      browser_mod:
                        service: browser_mod.popup
                        data:
                          title: Alle Türen
                          size: normal
                          content:
                            type: custom:layout-card
                            layout_type: custom:grid-layout
                            layout:
                              margin: 0
                            cards:
                              - type: custom:vertical-stack-in-card
                                cards:
                                  - type: entities
                                    entities:
                                      - entity: >-
                                          binary_sensor.sensor_haustur_window_and_door_sensor_5
                                        name: Haustür
                                        state_color: true
                                      - entity: sensor.haustur_geschlossen
                                        name: Geschlossen
                                      - type: divider
                                      - entity: >-
                                          binary_sensor.terrassentur_window_and_door_sensor_5
                                        name: Terrasse
                                        state_color: true
                                      - entity: sensor.terrassentur_geschlossen
                                        name: Geschlossen
                                  - type: history-graph
                                    entities:
                                      - entity: >-
                                          binary_sensor.sensor_haustur_window_and_door_sensor_5
                                        name: Haustür
                                      - entity: >-
                                          binary_sensor.terrassentur_window_and_door_sensor_5
                                        name: Terrasse
                                    title: Verlauf
                                    hours_to_show: 24
                                  - type: logbook
                                    entities:
                                      - entity: >-
                                          binary_sensor.sensor_haustur_window_and_door_sensor_5
                                        name: Haustür
                                      - entity: >-
                                          binary_sensor.terrassentur_window_and_door_sensor_5
                                        name: Terrasse
                                    hours_to_show: 24
                                    title: Logbuch
                                columns: 1
                  - type: custom:mushroom-template-card
                    primary: Heizung
                    secondary: >-
                      {% set group = expand('group.all_trv') %}   {% set count =
                      group | selectattr('state', 'eq', 'on') | list | count if
                      group is not none else 0 %}   {% if count > 0 %}  
                        🔥 {{ count }} aktiv  
                      {% else %}  
                        ❄️ inaktiv  
                      {% endif %}  
                    icon: |-
                      {% if is_state('group.all_trv', 'on') %}  
                        mdi:radiator  
                      {% else %}  
                        mdi:radiator-off  
                      {% endif %}  
                    icon_color: |-
                      {% if is_state('group.all_trv', 'on') %}  
                        orange  
                      {% else %}  
                        blue  
                      {% endif %}  
                    badge_icon: ''
                    entity: group.all_trv
                    tap_action:
                      action: fire-dom-event
                      browser_mod:
                        service: browser_mod.popup
                        data:
                          title: Alle Heizkörper
                          size: normal
                          content:
                            type: custom:layout-card
                            layout_type: custom:grid-layout
                            layout:
                              margin: 0
                            cards:
                              - type: custom:vertical-stack-in-card
                                cards:
                                  - type: entities
                                    entities:
                                      - entity: climate.heizung_bad
                                        name: Bad
                                        state_color: true
                                      - entity: climate.heizung_buro
                                        name: Büro
                                        state_color: true
                                      - entity: climate.heizung_wc_og
                                        name: WC OG
                                        state_color: true
                                      - entity: climate.heizung_wc_eg
                                        name: WC EG
                                        state_color: true
                                      - entity: climate.heizung_kuche
                                        name: Küche
                                        state_color: true
                                      - entity: climate.heizung_esszimmer
                                        name: Esszimer
                                        state_color: true
                                      - entity: climate.heizung_wohnzimmer
                                        name: Wohnzimmer
                                        state_color: true
                                      - type: custom:text-divider-row
                                        text: Outdoor-Sensoren
                                      - entity: sensor.netatmo_draussen_temperature
                                        name: Temperatur Draußen
                                      - entity: sensor.netatmo_draussen_humidity
                                        name: Feuchte Draußen
                                      - type: custom:text-divider-row
                                        text: Badezimmer
                                      - entity: binary_sensor.fenster_bad_contact
                                        name: Fenster
                                        state_color: true
                                      - entity: automation.advancedheating_v5_bad
                                        name: Automation
                                        state_color: true
                                      - entity: sensor.sensor_bad_temperature
                                        name: Temperatur
                                      - entity: sensor.sensor_bad_humidity
                                        name: Feuchte
                                      - entity: climate.heizung_bad
                                        name: Bad
                                        state_color: true
                                      - entity: sensor.heizung_bad_ausgeschaltet
                                        name: Ausgeschaltet
                                      - entity: input_boolean.heizung_bad_eingeschaltet
                                        type: simple-entity
                                      - type: custom:text-divider-row
                                        text: WC OG
                                      - entity: binary_sensor.fenster_wc_og_contact
                                        name: Fenster
                                        state_color: true
                                      - entity: automation.advancedheating_v5_wc_og
                                        name: Automation
                                        state_color: true
                                      - entity: sensor.wc_og_temperature
                                        name: Temperatur
                                      - entity: sensor.wc_og_humidity
                                        name: Feuchte
                                      - entity: climate.heizung_wc_og
                                        name: WC OG
                                        state_color: true
                                      - entity: sensor.heizung_wc_og_ausgeschaltet
                                        name: Ausgeschaltet
                                      - entity: >-
                                          input_boolean.heizung_wc_og_eingeschaltet
                                        type: simple-entity
                                      - type: custom:text-divider-row
                                        text: Büro
                                      - entity: binary_sensor.fenster_buro_contact
                                        name: Fenster
                                        state_color: true
                                      - entity: automation.advanced_heating_buro_urlaub
                                        name: Urlaubsmodus
                                        state_color: true
                                      - entity: automation.advancedheating_v5_buro
                                        name: Automation
                                        state_color: true
                                      - entity: sensor.sensor_buro_temperature
                                        name: Temperatur
                                      - entity: sensor.sensor_buro_humidity
                                        name: Feuchte
                                      - entity: climate.heizung_buro
                                        name: Büro
                                        state_color: true
                                      - entity: sensor.heizung_buro_ausgeschaltet
                                        name: Ausgeschaltet
                                      - entity: input_boolean.heizung_buro_eingeschaltet
                                        type: simple-entity
                                      - type: custom:text-divider-row
                                        text: Küche
                                      - entity: binary_sensor.fenster_kuche_contact
                                        name: Fenster
                                        state_color: true
                                      - entity: automation.advancedheating_v5_kuche
                                        name: Automation
                                        state_color: true
                                      - entity: sensor.netatmo_innen_temperature
                                        name: Temperatur
                                      - entity: sensor.netatmo_innen_humidity
                                        name: Feuchte
                                      - entity: climate.heizung_kuche
                                        name: Küche
                                        state_color: true
                                      - entity: sensor.heizung_kuche_ausgeschaltet
                                        name: Ausgeschaltet
                                      - entity: >-
                                          input_boolean.heizung_kuche_eingeschaltet
                                        type: simple-entity
                                      - type: custom:text-divider-row
                                        text: WC EG
                                      - entity: binary_sensor.fenster_wc_eg_contact
                                        name: Fenster
                                        state_color: true
                                      - entity: >-
                                          automation.advanced_heating_control_v5_wc_eg
                                        name: Automation
                                        state_color: true
                                      - entity: sensor.wc_eg_temperature
                                        name: Temperatur
                                      - entity: sensor.wc_eg_humidity
                                        name: Feuchte
                                      - entity: climate.heizung_wc_eg
                                        name: WC EG
                                        state_color: true
                                      - entity: sensor.heizung_wc_eg_ausgeschaltet
                                        name: Ausgeschaltet
                                      - entity: >-
                                          input_boolean.heizung_wc_eg_eingeschaltet
                                        type: simple-entity
                                      - type: custom:text-divider-row
                                        text: Wohn- & Esszimmer
                                      - entity: >-
                                          binary_sensor.terrassentur_window_and_door_sensor_5
                                        name: Tür
                                        state_color: true
                                      - entity: automation.advancedheating_v5_wohnzimmer
                                        name: Automation
                                        state_color: true
                                      - entity: sensor.sensor_wohnzimmer_temperature
                                        name: Temperatur
                                      - entity: sensor.sensor_wohnzimmer_humidity
                                        name: Feuchte
                                      - entity: climate.heizung_esszimmer
                                        name: Esszimmer
                                        state_color: true
                                      - entity: sensor.heizung_esszimmer_ausgeschaltet
                                        name: Esszimmer ausgeschaltet
                                      - entity: >-
                                          input_boolean.heizung_esszimmer_eingeschaltet
                                        type: simple-entity
                                      - entity: climate.heizung_wohnzimmer
                                        name: Wohnzimmer
                                        state_color: true
                                      - entity: sensor.heizung_wohnzimmer_ausgeschaltet
                                        name: Wohnzimmer ausgeschaltet
                                      - entity: >-
                                          input_boolean.heizung_wohnzimmer_eingeschaltet
                                        type: simple-entity
                                  - type: history-graph
                                    entities:
                                      - entity: input_boolean.heizung_bad_eingeschaltet
                                        name: Bad
                                      - entity: input_boolean.heizung_buro_eingeschaltet
                                        name: Büro
                                      - entity: >-
                                          input_boolean.heizung_kuche_eingeschaltet
                                        name: Küche
                                      - entity: >-
                                          input_boolean.heizung_esszimmer_eingeschaltet
                                        name: Esszimmer
                                      - entity: >-
                                          input_boolean.heizung_wohnzimmer_eingeschaltet
                                        name: Wohnzimmer
                                    title: Verlauf
                                    hours_to_show: 24
                                  - type: logbook
                                    entities:
                                      - entity: input_boolean.heizung_bad_eingeschaltet
                                        name: Bad
                                      - entity: input_boolean.heizung_buro_eingeschaltet
                                        name: Büro
                                      - entity: >-
                                          input_boolean.heizung_kuche_eingeschaltet
                                        name: Küche
                                      - entity: >-
                                          input_boolean.heizung_esszimmer_eingeschaltet
                                        name: Esszimmer
                                      - entity: >-
                                          input_boolean.heizung_wohnzimmer_eingeschaltet
                                        name: Wohnzimmer
                                    hours_to_show: 24
                                    title: Logbuch
                                columns: 1
                  - type: custom:mushroom-template-card
                    primary: Feuchte
                    entity: sensor.netatmo_innen_humidity
                    secondary: >-
                      {% set humidity = states(entity) | float(0) %}   {% if
                      humidity > 65 %}  
                        💧 Kritisch: {{ humidity }}%  
                      {% elif humidity > 60 %}  
                        💧 Hoch: {{ humidity }}%  
                      {% else %}  
                        ✅ {{ humidity }}%  
                      {% endif %} 
                    icon: >-
                      {% set humidity = states(entity) | float(0) %}   {% if
                      humidity > 65 %}  
                        mdi:water-percent-alert  
                      {% else %}  
                        mdi:water-percent  
                      {% endif %}  
                    icon_color: >-
                      {% set humidity = states(entity) | float(0) %}   {% if
                      humidity > 65 %}  
                        red  
                      {% elif humidity > 60 %}  
                        orange  
                      {% else %}  
                        green  
                      {% endif %}  
                    tap_action:
                      action: fire-dom-event
                      browser_mod:
                        service: browser_mod.popup
                        data:
                          title: Alle Sensoren
                          size: normal
                          content:
                            type: custom:layout-card
                            layout_type: custom:grid-layout
                            layout:
                              margin: 0
                            cards:
                              - type: custom:vertical-stack-in-card
                                title: Draußen
                                cards:
                                  - type: grid
                                    square: false
                                    columns: 2
                                    cards:
                                      - type: custom:mushroom-entity-card
                                        entity: sensor.netatmo_draussen_temperature
                                        primary_info: state
                                        secondary_info: name
                                        name: Temperature
                                        icon_color: green
                                      - type: custom:mushroom-entity-card
                                        entity: sensor.netatmo_draussen_humidity
                                        primary_info: state
                                        secondary_info: name
                                        name: Humidity
                                        icon_color: blue
                                  - type: custom:mini-graph-card
                                    entities:
                                      - entity: sensor.netatmo_draussen_temperature
                                        name: Temperature
                                        color: var(--green-color)
                                      - entity: sensor.netatmo_draussen_humidity
                                        name: Humidity
                                        color: var(--blue-color)
                                        y_axis: secondary
                                    hours_to_show: 24
                                    line_width: 3
                                    font_size: 50
                                    animate: true
                                    show:
                                      name: false
                                      icon: false
                                      state: false
                                      legend: false
                                      fill: fade
                              - type: custom:vertical-stack-in-card
                                title: Küche
                                cards:
                                  - type: grid
                                    square: false
                                    columns: 2
                                    cards:
                                      - type: custom:mushroom-entity-card
                                        entity: sensor.netatmo_innen_temperature
                                        primary_info: state
                                        secondary_info: name
                                        name: Temperature
                                        icon_color: green
                                      - type: custom:mushroom-entity-card
                                        entity: sensor.netatmo_innen_humidity
                                        primary_info: state
                                        secondary_info: name
                                        name: Humidity
                                        icon_color: blue
                                  - type: custom:mini-graph-card
                                    entities:
                                      - entity: sensor.netatmo_innen_temperature
                                        name: Temperature
                                        color: var(--green-color)
                                      - entity: sensor.netatmo_innen_humidity
                                        name: Humidity
                                        color: var(--blue-color)
                                        y_axis: secondary
                                    hours_to_show: 24
                                    line_width: 3
                                    font_size: 50
                                    animate: true
                                    show:
                                      name: false
                                      icon: false
                                      state: false
                                      legend: false
                                      fill: fade
                                columns: 1
                              - type: custom:vertical-stack-in-card
                                title: Badezimmer
                                cards:
                                  - type: grid
                                    square: false
                                    columns: 2
                                    cards:
                                      - type: custom:mushroom-entity-card
                                        entity: sensor.sensor_bad_temperature
                                        primary_info: state
                                        secondary_info: name
                                        name: Temperature
                                        icon_color: green
                                      - type: custom:mushroom-entity-card
                                        entity: sensor.sensor_bad_humidity
                                        primary_info: state
                                        secondary_info: name
                                        name: Humidity
                                        icon_color: blue
                                  - type: custom:mini-graph-card
                                    entities:
                                      - entity: sensor.sensor_bad_temperature
                                        name: Temperature
                                        color: var(--green-color)
                                      - entity: sensor.sensor_bad_humidity
                                        name: Humidity
                                        color: var(--blue-color)
                                        y_axis: secondary
                                    hours_to_show: 24
                                    line_width: 3
                                    font_size: 50
                                    animate: true
                                    show:
                                      name: false
                                      icon: false
                                      state: false
                                      legend: false
                                      fill: fade
                                columns: 1
                              - type: custom:vertical-stack-in-card
                                title: Wohnzimmer
                                cards:
                                  - type: grid
                                    square: false
                                    columns: 2
                                    cards:
                                      - type: custom:mushroom-entity-card
                                        entity: sensor.sensor_wohnzimmer_temperature
                                        primary_info: state
                                        secondary_info: name
                                        name: Temperature
                                        icon_color: green
                                      - type: custom:mushroom-entity-card
                                        entity: sensor.sensor_wohnzimmer_humidity
                                        primary_info: state
                                        secondary_info: name
                                        name: Humidity
                                        icon_color: blue
                                  - type: custom:mini-graph-card
                                    entities:
                                      - entity: sensor.sensor_wohnzimmer_temperature
                                        name: Temperature
                                        color: var(--green-color)
                                      - entity: sensor.sensor_wohnzimmer_humidity
                                        name: Humidity
                                        color: var(--blue-color)
                                        y_axis: secondary
                                    hours_to_show: 24
                                    line_width: 3
                                    font_size: 50
                                    animate: true
                                    show:
                                      name: false
                                      icon: false
                                      state: false
                                      legend: false
                                      fill: fade
                                columns: 1
        layout: {}
        view_layout:
          grid-area: row2
      - type: custom:button-card
        entity: sensor.tonnenbutton_2
        icon: |
          [[[  
            const type = entity.state.split("|")[0].toLowerCase();  
            if (type === "restmüll") return "mdi:delete";  
            if (type === "papiermüll") return "mdi:recycle";  
            if (type === "wertstoffmüll") return "mdi:recycle-variant";  
            if (type === "biomüll") return "mdi:leaf";  
            // Fallback  
            return "mdi:trash-can";  
          ]]]
        layout: icon_name_state2nd
        show_label: true
        show_name: true
        name: |
          [[[
            return entity.state.split("|")[0];
          ]]]
        label: |
          [[[
            const days_to = parseInt(entity.state.split("|")[1]);
            switch(days_to) {
              case 0:
                return "🚛 An der Straße?!";
              case 1:
                return "⚠️ Heute Abend raus";
              case 2:
                return "📅 Morgen";
              default:
                return "⏳ In " + days_to + " Tagen";
            }
          ]]]
        state:
          - operator: template
            value: '[[[ return entity.state.split(''|'')[1] == 0 ]]]'
            color: red
            styles:
              card:
                - background: rgba(255, 0, 0, 0.1)
              icon:
                - animation: blink 1s linear infinite
                - width: 70px
                - height: 70px
              label:
                - font-weight: bold
              name:
                - font-weight: bold
          - operator: template
            value: '[[[ return entity.state.split(''|'')[1] == 1 ]]]'
            color: orange
            styles:
              card:
                - background: rgba(255, 165, 0, 0.1)
              icon:
                - animation: blink 1.5s linear infinite
                - width: 70px
                - height: 70px
              label:
                - font-weight: bold
              name:
                - font-weight: bold
          - value: default
            color: var(--primary-text-color)
            styles:
              card:
                - background: var(--card-background-color)
              icon:
                - width: 70px
                - height: 70px
        styles:
          card:
            - border-radius: var(--border-radius)
            - padding: 12px
          name:
            - font-size: 1.2em
            - padding-bottom: 4px
          label:
            - font-size: 1em
            - opacity: 0.9
          icon:
            - width: 70px
            - height: 70px
        custom_fields: {}
        animations:
          blink:
            - keyframes:
                - 0%:
                    opacity: 1
                - 50%:
                    opacity: 0.2
                - 100%:
                    opacity: 1
        tap_action:
          action: more-info
        hold_action:
          action: none
      - type: custom:layout-card
        layout_type: custom:grid-layout
        cards:
          - type: custom:layout-card
            layout_type: custom:grid-layout
            layout:
              margin: 0
            cards:
              - square: false
                type: grid
                columns: 2
                cards:
                  - type: custom:mushroom-template-card
                    primary: Server & Hubs
                    secondary: >-
                      {% set group = expand('binary_sensor.server_hubs') %} {%
                      set count = group | selectattr('state', 'eq', 'on') | list
                      | count if group is not none else 0 %} {% if count > 0 %}
                        🖥️ {{ count }} Online
                      {% else %}
                        📴 Offline
                      {% endif %}
                    icon: |-
                      {% if is_state('binary_sensor.server_hubs', 'on') %}
                        mdi:server
                      {% else %}
                        mdi:server-off
                      {% endif %}
                    icon_color: >-
                      {{ 'green' if is_state('binary_sensor.server_hubs', 'on')
                      else 'grey' }}
                    badge_icon: ''
                    entity: binary_sensor.server_hubs
                    tap_action:
                      action: fire-dom-event
                      browser_mod:
                        service: browser_mod.popup
                        data:
                          title: Alle Server & Hubs
                          size: normal
                          content:
                            type: custom:layout-card
                            layout_type: custom:grid-layout
                            layout:
                              margin: 0
                            cards:
                              - type: custom:vertical-stack-in-card
                                cards:
                                  - type: entities
                                    entities:
                                      - entity: binary_sensor.router
                                        name: FritzBox Router
                                        state_color: true
                                      - type: divider
                                      - entity: binary_sensor.adguard
                                        name: AdGuard Home
                                        state_color: true
                                      - entity: sensor.adguard_runtergefahren
                                        name: Runtergefahren
                                      - type: divider
                                      - entity: binary_sensor.diskstation_1515
                                        name: Diskstation 1515+
                                        state_color: true
                                      - entity: sensor.diskstation_runtergefahren
                                        name: Runtergefahren
                                      - type: divider
                                      - entity: binary_sensor.diskstation_120j
                                        name: Diskstation 120J
                                        state_color: true
                                      - entity: sensor.ds120j_runtergefahren
                                        name: Runtergefahren
                                      - type: divider
                                      - entity: binary_sensor.rademacher_hub
                                        name: Rademacher Rolladen Hub
                                        state_color: true
                                      - type: divider
                                      - entity: binary_sensor.xiaomi_gateway
                                        name: Xiaomi Gateway
                                        state_color: true
                                      - type: divider
                                      - entity: binary_sensor.epson_drucker
                                        name: EPSON Drucker
                                        state_color: true
                                      - type: divider
                                      - entity: binary_sensor.m5stack_bt_proxy
                                        name: M5 Bluetooth Proxy
                                        state_color: true
                                  - type: history-graph
                                    entities:
                                      - entity: binary_sensor.router
                                        name: FritzBox
                                      - entity: binary_sensor.adguard
                                        name: AdGuard Home
                                      - entity: binary_sensor.diskstation_1515
                                        name: DS 1515+
                                      - entity: binary_sensor.diskstation_120j
                                        name: DS 120J
                                      - entity: binary_sensor.rademacher_hub
                                        name: Rademacher Hub
                                      - entity: binary_sensor.xiaomi_gateway
                                        name: Xiaomi GW
                                      - entity: binary_sensor.epson_drucker
                                        name: Drucker
                                      - entity: binary_sensor.m5stack_bt_proxy
                                        name: M5 BT Proxy
                                    title: Verlauf
                                    hours_to_show: 24
                                  - type: logbook
                                    entities:
                                      - entity: binary_sensor.router
                                        name: Fritz Box Router
                                      - entity: binary_sensor.adguard
                                        name: AdGuard Home
                                      - entity: binary_sensor.diskstation_1515
                                        name: Diskstation 1515
                                      - entity: binary_sensor.diskstation_120j
                                        name: Diskstation 120J
                                      - entity: binary_sensor.rademacher_hub
                                        name: Rademacher Rolladen Hub
                                      - entity: binary_sensor.xiaomi_gateway
                                        name: Xiaomi Gateway
                                      - entity: binary_sensor.epson_drucker
                                        name: EPSON Drucker
                                      - entity: binary_sensor.m5stack_bt_proxy
                                        name: M5 Bluetooth Proxy
                                    hours_to_show: 24
                                    title: Logbuch
                                columns: 1
                  - type: custom:mushroom-template-card
                    primary: PCs
                    secondary: >-
                      {% set group = expand('group.all_computer') %} {% set
                      count = group | selectattr('state', 'eq', 'on') | list |
                      count if group is not none else 0 %} {% if count > 0 %}
                        💻 {{ count }} An
                      {% else %}
                        📴 Aus
                      {% endif %}
                    icon: |-
                      {% if is_state('group.all_computer', 'on') %}
                        mdi:television
                      {% else %}
                        mdi:television-off
                      {% endif %}
                    icon_color: >-
                      {{ 'green' if is_state('group.all_computer', 'on') else
                      'grey' }}
                    badge_icon: ''
                    entity: group.all_computer
                    tap_action:
                      action: fire-dom-event
                      browser_mod:
                        service: browser_mod.popup
                        data:
                          title: Alle PCs
                          size: normal
                          content:
                            type: custom:layout-card
                            layout_type: custom:grid-layout
                            layout:
                              margin: 0
                            cards:
                              - type: custom:vertical-stack-in-card
                                cards:
                                  - type: entities
                                    entities:
                                      - entity: sensor.stromverbrauch_aktuell_alle_pcs
                                        name: Stromverbrauch alle PCs
                                      - entity: sensor.stromverbrauch_tag_alle_pcs
                                        name: Stromverbrauch Tag alle PCs
                                        card_mod:
                                          style:
                                            hui-generic-entity-row: |
                                              .text-content::after {
                                                 content: "kWh";
                                               }
                                      - entity: sensor.stromverbrauch_monat_alle_pcs
                                        name: Stromverbrauch Monat alle PCs
                                        card_mod:
                                          style:
                                            hui-generic-entity-row: |
                                              .text-content::after {
                                                 content: "kWh";
                                               }
                                      - type: divider
                                      - entity: input_boolean.pc_nick_an
                                        name: PC-Nick
                                        type: simple-entity
                                        state_color: true
                                      - entity: sensor.nutzungszeit_pc_nick
                                        card_mod:
                                          style:
                                            hui-generic-entity-row: |
                                              .text-content::after {
                                                 content: " Std.";
                                               }
                                        name: Nutzungszeit
                                      - entity: sensor.pc_nick_taglich
                                        name: Tagesverbrauch
                                      - entity: sensor.pc_nick_power
                                        name: Leistung
                                      - entity: sensor.pc_nick_runtergefahren
                                        name: Runtergefahren
                                      - type: divider
                                      - entity: input_boolean.pc_phil_an
                                        name: PC-Phil
                                        type: simple-entity
                                        state_color: true
                                      - entity: sensor.nutzungszeit_pc_phil
                                        card_mod:
                                          style:
                                            hui-generic-entity-row: |
                                              .text-content::after {
                                                 content: " Std.";
                                               }
                                        name: Nutzungszeit
                                      - entity: sensor.pc_phil_taglich
                                        name: Tagesverbrauch
                                      - entity: sensor.pc_phil_power
                                        name: Leistung
                                      - entity: sensor.pc_phil_runtergefahren
                                        name: Runtergefahren
                                      - type: divider
                                      - entity: input_boolean.pc_daniel_an
                                        name: PC-Daniel
                                        type: simple-entity
                                        state_color: true
                                      - entity: sensor.nutzungszeit_pc_daniel
                                        card_mod:
                                          style:
                                            hui-generic-entity-row: |
                                              .text-content::after {
                                                 content: " Std.";
                                               }
                                        name: Nutzungszeit
                                      - entity: sensor.pc_daniel_taglich
                                        name: Tagesverbrauch
                                      - entity: sensor.pc_daniel_power
                                        name: Leistung
                                      - entity: sensor.pc_daniel_runtergefahren
                                        name: Runtergefahren
                                  - type: history-graph
                                    entities:
                                      - entity: input_boolean.pc_nick_an
                                        name: Nick
                                      - entity: input_boolean.pc_phil_an
                                        name: Phil
                                      - entity: input_boolean.pc_daniel_an
                                        name: Daniel
                                    title: Verlauf
                                    hours_to_show: 24
                                  - type: logbook
                                    entities:
                                      - entity: input_boolean.pc_nick_an
                                        name: PC-Nick
                                      - entity: input_boolean.pc_phil_an
                                        name: PC-Phil
                                      - entity: input_boolean.pc_daniel_an
                                        name: PC-Daniel
                                    hours_to_show: 24
                                    title: Logbuch
                                columns: 1
                  - type: custom:mushroom-template-card
                    primary: TV-Geräte
                    secondary: >-
                      {% set group = expand('group.all_tv') %} {% set count =
                      group | selectattr('state', 'eq', 'on') | list | count if
                      group is not none else 0 %} {% if count > 0 %}
                        📺 {{ count }} An
                      {% else %}
                        📴 Aus
                      {% endif %}
                    icon: |-
                      {% if is_state('group.all_tv', 'on') %}
                        mdi:television
                      {% else %}
                        mdi:television-off
                      {% endif %}
                    icon_color: >-
                      {{ 'green' if is_state('group.all_tv', 'on') else 'grey'
                      }}
                    badge_icon: ''
                    entity: group.all_tv
                    tap_action:
                      action: fire-dom-event
                      browser_mod:
                        service: browser_mod.popup
                        data:
                          title: Alle TV-Geräte
                          size: normal
                          content:
                            type: custom:layout-card
                            layout_type: custom:grid-layout
                            layout:
                              margin: 0
                            cards:
                              - type: custom:vertical-stack-in-card
                                cards:
                                  - type: entities
                                    entities:
                                      - entity: sensor.stromverbrauch_aktuell_alle_tvs
                                        name: Stromverbrauch alle TV
                                      - entity: sensor.stromverbrauch_tag_alle_tvs
                                        name: Stromverbrauch Tag alle TV
                                      - entity: sensor.stromverbrauch_monat_alle_tvs
                                        name: Stromverbrauch Monat alle TV
                                      - type: divider
                                      - entity: input_boolean.tv_nick_an
                                        name: TV-Nick
                                        type: simple-entity
                                        state_color: true
                                      - entity: sensor.tv_nick_ausgeschaltet
                                        name: Ausgeschaltet
                                      - entity: sensor.nutzungszeit_tv_nick
                                        card_mod:
                                          style:
                                            hui-generic-entity-row: |
                                              .text-content::after {
                                                 content: " Std.";
                                               }
                                        name: Nutzungszeit
                                      - entity: sensor.tv_konsolen_nick_power
                                        name: Strom
                                      - type: divider
                                      - entity: input_boolean.tv_phil_an
                                        name: TV-Phil
                                        type: simple-entity
                                        state_color: true
                                      - entity: sensor.tv_phil_ausgeschaltet
                                        name: Ausgeschaltet
                                      - entity: sensor.nutzungszeit_tv_phil
                                        card_mod:
                                          style:
                                            hui-generic-entity-row: |
                                              .text-content::after {
                                                 content: " Std.";
                                               }
                                      - entity: sensor.tv_phil_power
                                        name: Strom
                                      - type: divider
                                      - entity: input_boolean.tv_wohnzimmer_an
                                        name: TV-Wohnzimmer
                                        type: simple-entity
                                        state_color: true
                                      - entity: sensor.tv_wohnzimmer_ausgeschaltet
                                        name: Ausgeschaltet
                                      - entity: sensor.nutzungszeit_tv_wohnzimmer
                                        card_mod:
                                          style:
                                            hui-generic-entity-row: |
                                              .text-content::after {
                                                 content: " Std.";
                                               }
                                      - entity: sensor.router_tv_wohnzimmer_power
                                        name: Strom
                                      - type: divider
                                      - entity: input_boolean.tv_schlafzimmer_an
                                        name: TV-Schlafzimmer
                                        type: simple-entity
                                        state_color: true
                                      - entity: sensor.tv_schlafzimmer_ausgeschaltet
                                        name: Ausgeschaltet
                                      - entity: sensor.nutzungszeit_tv_schlafzimmer
                                        card_mod:
                                          style:
                                            hui-generic-entity-row: |
                                              .text-content::after {
                                                 content: " Std.";
                                               }
                                      - entity: sensor.tv_schlafzimmer_power
                                        name: Strom
                                  - type: history-graph
                                    entities:
                                      - entity: input_boolean.tv_nick_an
                                        name: Nick
                                      - entity: input_boolean.tv_phil_an
                                        name: Phil
                                      - entity: input_boolean.tv_wohnzimmer_an
                                        name: Wohnzimmer
                                      - entity: input_boolean.tv_schlafzimmer_an
                                        name: Schlafzimmer
                                    title: Verlauf
                                    hours_to_show: 24
                                  - type: logbook
                                    entities:
                                      - entity: input_boolean.tv_nick_an
                                        name: TV-Nick
                                      - entity: input_boolean.tv_phil_an
                                        name: TV-Phil
                                      - entity: input_boolean.tv_wohnzimmer_an
                                        name: TV-Wohnzimmer
                                      - entity: input_boolean.tv_schlafzimmer_an
                                        name: TV-Schlafzimmer
                                    hours_to_show: 24
                                    title: Logbuch
                                columns: 1
                  - type: custom:mushroom-template-card
                    primary: Nick's Geräte
                    secondary: >-
                      {% set group = expand('group.all_devices_nick') %} {% set
                      count = group | selectattr('state', 'eq', 'on') | list |
                      count if group is not none else 0 %} {% if count > 0 %}
                        🕹️ {{ count }} An
                      {% else %}
                        📴 Aus
                      {% endif %}
                    icon: |-
                      {% if is_state('group.all_devices_nick', 'on') %}
                        mdi:cellphone-link
                      {% else %}
                        mdi:cellphone-link-off
                      {% endif %}
                    icon_color: >-
                      {{ 'green' if is_state('group.all_devices_nick', 'on')
                      else 'grey' }}
                    badge_icon: ''
                    entity: group.all_devices_nick
                    tap_action:
                      action: fire-dom-event
                      browser_mod:
                        service: browser_mod.popup
                        data:
                          title: Nicks Geräte
                          size: normal
                          content:
                            type: custom:layout-card
                            layout_type: custom:grid-layout
                            layout:
                              margin: 0
                            cards:
                              - type: custom:vertical-stack-in-card
                                cards:
                                  - type: entities
                                    entities:
                                      - entity: input_boolean.nintendo_switch_an
                                        name: Nintendo Switch
                                        type: simple-entity
                                        state_color: true
                                      - entity: sensor.nutzungszeit_nintendo_switch
                                        card_mod:
                                          style:
                                            hui-generic-entity-row: |
                                              .text-content::after {
                                                 content: " Std.";
                                               }
                                        name: Nutzungszeit
                                      - entity: sensor.nintendo_switch_ausgeschaltet
                                        name: Switch ausgeschaltet
                                      - entity: input_boolean.pc_nick_an
                                        name: PC-Nick
                                        type: simple-entity
                                        state_color: true
                                      - entity: sensor.nutzungszeit_pc_nick
                                        card_mod:
                                          style:
                                            hui-generic-entity-row: |
                                              .text-content::after {
                                                 content: " Std.";
                                               }
                                        name: Nutzungszeit
                                      - entity: sensor.pc_nick_runtergefahren
                                        name: PC runtergefahren
                                      - entity: input_boolean.tv_nick_an
                                        name: TV-Nick
                                        type: simple-entity
                                        state_color: true
                                      - entity: sensor.nutzungszeit_tv_nick
                                        card_mod:
                                          style:
                                            hui-generic-entity-row: |
                                              .text-content::after {
                                                 content: " Std.";
                                               }
                                        name: Nutzungszeit
                                      - entity: sensor.tv_nick_ausgeschaltet
                                        name: TV ausgeschaltet
                                  - type: history-graph
                                    entities:
                                      - entity: input_boolean.nintendo_switch_an
                                        name: Switch
                                      - entity: input_boolean.pc_nick_an
                                        name: PC-Nick
                                      - entity: input_boolean.tv_nick_an
                                        name: TV-Nick
                                    title: Verlauf
                                    hours_to_show: 24
                                  - type: logbook
                                    entities:
                                      - entity: input_boolean.nintendo_switch_an
                                        name: Nintendo Switch
                                      - entity: input_boolean.pc_nick_an
                                        name: PC-Nick
                                      - entity: input_boolean.tv_nick_an
                                        name: TV-Nick
                                    hours_to_show: 24
                                    title: Logbuch
                                columns: 1
        layout: {}
        view_layout:
          grid-area: row2
      - type: custom:layout-card
        layout_type: custom:grid-layout
        cards:
          - type: custom:layout-card
            layout_type: custom:grid-layout
            layout:
              margin: 0
            cards:
              - square: false
                type: grid
                columns: 2
                cards:
                  - type: custom:mushroom-template-card
                    primary: Wohnzimmer
                    secondary: >-
                      {% set group = expand('light.wohnzimmer_beleuchtung') %}  
                      {% set count = group | selectattr('state', 'eq', 'on') |
                      list | count if group is not none else 0 %}   {% if count
                      > 0 %}  
                        💡 {{ count }} Licht{% if count > 1 %}er{% endif %} an  
                      {% else %}  
                        🌑 Alle aus  
                      {% endif %}  
                    icon: |-
                      {% if is_state('light.wohnzimmer_beleuchtung', 'on') %}  
                        mdi:lamps  
                      {% else %}  
                        mdi:lamps  
                      {% endif %}  
                    icon_color: |-
                      {% if is_state('light.wohnzimmer_beleuchtung', 'on') %}  
                        amber  
                      {% else %}  
                        grey  
                      {% endif %}  
                    badge_icon: ''
                    entity: light.wohnzimmer_beleuchtung
                    tap_action:
                      action: fire-dom-event
                      browser_mod:
                        service: browser_mod.popup
                        data:
                          title: Wohnzimmer
                          size: normal
                          content:
                            type: custom:layout-card
                            layout_type: custom:grid-layout
                            layout:
                              margin: 0
                            cards:
                              - type: custom:vertical-stack-in-card
                                cards:
                                  - type: entities
                                    entities:
                                      - entity: light.wohnzimmer_alle
                                        name: Alle Lichter
                                      - entity: light.wohnzimmer_kommode
                                        name: Kommode
                                        secondary_info: last-changed
                                        state_color: true
                                      - entity: light.wohnzimmer_beleuchtung_tv_outlet
                                        name: Vitrine TV
                                        secondary_info: last-changed
                                        state_color: true
                                      - entity: light.wohnzimmer_lampe_links_outlet
                                        name: Stehlampe links
                                        secondary_info: last-changed
                                        state_color: true
                                      - entity: light.wohnzimmer_lampe_rechts_outlet
                                        name: Stehlampe rechts
                                        secondary_info: last-changed
                                        state_color: true
                                      - entity: light.yl_wohnzimmer
                                        name: Yeelight Board links
                                        secondary_info: last-changed
                                        state_color: true
                                      - entity: light.salzlampe
                                        name: Salzlamp
                                        secondary_info: last-changed
                                        state_color: true
                                      - entity: light.wohnzimmer_led_stripe
                                        name: LED-Stripe TV
                                        secondary_info: last-changed
                                        state_color: true
                                  - type: history-graph
                                    entities:
                                      - entity: light.wohnzimmer_kommode
                                        name: Kommode
                                      - entity: light.wohnzimmer_beleuchtung_tv_outlet
                                        name: VitrineTV
                                      - entity: light.wohnzimmer_lampe_links_outlet
                                        name: Lampe links
                                      - entity: light.wohnzimmer_lampe_rechts_outlet
                                        name: Lampe rechts
                                      - entity: light.yl_wohnzimmer
                                        name: YL Board
                                      - entity: light.salzlampe
                                        name: Salzlampe
                                      - entity: light.wohnzimmer_led_stripe
                                        name: Stripe TV
                                    title: Verlauf
                                    hours_to_show: 24
                                columns: 1
                  - type: custom:mushroom-template-card
                    primary: Flur
                    secondary: >-
                      {% set group = expand('light.flurbeleuchtung') %}   {% set
                      count = group | selectattr('state', 'eq', 'on') | list |
                      count if group is not none else 0 %}   {% if count > 0
                      %}  
                        💡 {{ count }} Licht{% if count > 1 %}er{% endif %} an  
                      {% else %}  
                        🌑 Alle aus  
                      {% endif %}  
                    icon: |-
                      {% if is_state('light.flurbeleuchtung', 'on') %}  
                        mdi:floor-lamp  
                      {% else %}  
                        mdi:floor-lamp 
                      {% endif %}  
                    icon_color: |-
                      {% if is_state('light.flurbeleuchtung', 'on') %}  
                        amber  
                      {% else %}  
                        grey  
                      {% endif %}  
                    badge_icon: ''
                    entity: light.flurbeleuchtung
                    tap_action:
                      action: fire-dom-event
                      browser_mod:
                        service: browser_mod.popup
                        data:
                          title: Flur
                          size: normal
                          content:
                            type: custom:layout-card
                            layout_type: custom:grid-layout
                            layout:
                              margin: 0
                            cards:
                              - type: custom:vertical-stack-in-card
                                cards:
                                  - type: entities
                                    entities:
                                      - entity: light.flur_eg
                                        name: Flur EG
                                        secondary_info: last-changed
                                        state_color: true
                                      - entity: binary_sensor.flureg_occupancy
                                        name: Flur EG - Motion
                                        secondary_info: last-changed
                                        state_color: true
                                      - entity: sensor.flureg_illuminance
                                        name: Flur EG - Lux
                                        secondary_info: last-changed
                                      - entity: light.flur_og
                                        name: Flur OG
                                        secondary_info: last-changed
                                        state_color: true
                                      - entity: binary_sensor.motion_flurog_occupancy
                                        name: Flur OG - Motion
                                        secondary_info: last-changed
                                        state_color: true
                                      - entity: sensor.motion_flurog_illuminance
                                        name: Flur OG - Lux
                                        secondary_info: last-changed
                                  - type: history-graph
                                    entities:
                                      - entity: light.flur_eg
                                        name: Flur EG
                                      - entity: light.flur_og
                                        name: Flur OG
                                    title: Verlauf
                                    hours_to_show: 24
                                columns: 1
                  - type: custom:mushroom-template-card
                    primary: Schlafzimmer
                    secondary: >-
                      {% set group = expand('light.nachtlicht_schlafzimmer')
                      %}   {% set count = group | selectattr('state', 'eq',
                      'on') | list | count if group is not none else 0 %}   {%
                      if count > 0 %}  
                        💡 {{ count }} Licht{% if count > 1 %}er{% endif %} an  
                      {% else %}  
                        🌑 Alle aus  
                      {% endif %}  
                    icon: |-
                      {% if is_state('light.nachtlicht_schlafzimmer', 'on') %}  
                        mdi:lamp  
                      {% else %}  
                        mdi:lamp 
                      {% endif %}  
                    icon_color: |-
                      {% if is_state('light.nachtlicht_schlafzimmer', 'on') %}  
                        amber  
                      {% else %}  
                        grey  
                      {% endif %}  
                    badge_icon: ''
                    entity: light.nachtlicht_schlafzimmer
                    tap_action:
                      action: fire-dom-event
                      browser_mod:
                        service: browser_mod.popup
                        data:
                          title: Schlafzimmer
                          size: normal
                          content:
                            type: custom:layout-card
                            layout_type: custom:grid-layout
                            layout:
                              margin: 0
                            cards:
                              - type: custom:vertical-stack-in-card
                                cards:
                                  - type: entities
                                    entities:
                                      - entity: light.nachtlicht_eltern
                                        name: Licht Eltern
                                      - entity: light.nachtlicht_schlafzimmer
                                        name: Alle
                                      - type: divider
                                      - entity: light.andrea_nachttisch
                                        name: Andrea
                                        secondary_info: last-changed
                                        state_color: true
                                      - entity: light.daniel_nachttisch_light
                                        name: Daniel
                                        secondary_info: last-changed
                                        state_color: true
                                      - entity: light.yl_phil
                                        name: Phil
                                        secondary_info: last-changed
                                        state_color: true
                                  - type: history-graph
                                    entities:
                                      - entity: light.andrea_nachttisch
                                        name: Andrea
                                      - entity: light.daniel_nachttisch_light
                                        name: Daniel
                                      - entity: light.yl_phil
                                        name: Phil
                                    title: Verlauf
                                    hours_to_show: 24
                                columns: 1
                  - type: custom:mushroom-template-card
                    primary: Gartenlicht
                    secondary: >-
                      {% set group = expand('light.gartenbeleuchtung') %}   {%
                      set count = group | selectattr('state', 'eq', 'on') | list
                      | count if group is not none else 0 %}   {% if count > 0
                      %}  
                        🌟 {{ count }} Licht{% if count > 1 %}er{% endif %} an  
                      {% else %}  
                        🌑 Aus  
                      {% endif %}  
                    icon: |-
                      {% if is_state('light.gartenbeleuchtung', 'on') %}  
                        mdi:string-lights  
                      {% else %}  
                        mdi:string-lights-off  
                      {% endif %}  
                    icon_color: |-
                      {% if is_state('light.gartenbeleuchtung', 'on') %}  
                        amber  
                      {% else %}  
                        grey  
                      {% endif %}  
                    badge_icon: ''
                    entity: light.gartenbeleuchtung
                    tap_action:
                      confirmation:
                        text: Licht umschalten?
                      action: toggle
                  - type: custom:mushroom-template-card
                    primary: X-mas
                    secondary: >-
                      {% set group = expand('light.xmas_licht') %}   {% set
                      count = group | selectattr('state', 'eq', 'on') | list |
                      count if group is not none else 0 %}   {% if count > 0
                      %}  
                        🎄 {{ count }} Licht{% if count > 1 %}er{% endif %} an  
                      {% else %}  
                        🌑 Alle aus  
                      {% endif %}  
                    icon: |-
                      {% if is_state('light.xmas_licht', 'on') %}  
                        mdi:pine-tree  
                      {% else %}  
                        mdi:pine-tree  
                      {% endif %}  
                    icon_color: |-
                      {% if is_state('light.xmas_licht', 'on') %}  
                        green  
                      {% else %}  
                        grey  
                      {% endif %}  
                    badge_icon: ''
                    entity: light.xmas_licht
                    tap_action:
                      action: fire-dom-event
                      browser_mod:
                        service: browser_mod.popup
                        data:
                          title: X-mas
                          size: normal
                          content:
                            type: custom:layout-card
                            layout_type: custom:grid-layout
                            layout:
                              margin: 0
                            cards:
                              - type: custom:vertical-stack-in-card
                                cards:
                                  - type: entities
                                    entities:
                                      - entity: light.xmas_licht
                                        name: X-mas Alle
                                      - entity: light.xmas_garten
                                        name: X-mas Garten
                                        secondary_info: last-changed
                                        state_color: true
                                      - entity: light.xmas_baum_vorn
                                        name: X-mas Haustür
                                        secondary_info: last-changed
                                        state_color: true
                                      - type: divider
                                      - entity: light.xmas_baum
                                        name: X-mas Baum
                                        secondary_info: last-changed
                                        state_color: true
                                      - type: custom:text-divider-row
                                        text: Automatisierungen
                                      - entity: automation.xmas_baum_automatisierung
                                        name: X-mas Baum
                                      - entity: automation.xmas_outdoor_licht_morgens
                                        name: X-mas Auto (Morgens)
                                      - entity: automation.x_mas_outdoor_licht
                                        name: X-mas Auto (Abends)
                                      - type: divider
                                  - type: history-graph
                                    entities:
                                      - entity: light.xmas_garten
                                        name: X-mas Garten
                                      - entity: light.xmasbaumvorn
                                        name: X-mas Vorne
                                      - entity: light.xmas_baum
                                        name: X-mas Baum
                                    title: Verlauf
                                    hours_to_show: 24
                                columns: 1
        layout: {}
        view_layout:
          grid-area: row2
      - type: horizontal-stack
        cards:
          - type: custom:mushroom-light-card
            entity: light.buro_screenbar_main
            name: Büro Hauptlicht
            icon: mdi:desk-lamp
            use_light_color: true
            show_brightness_control: true
            show_color_temp_control: true
            show_color_control: false
            collapsible_controls: true
            double_tap_action:
              action: none
            tap_action:
              action: toggle
            hold_action:
              action: more-info
            layout: vertical
            fill_container: true
            primary_info: name
            secondary_info: state
          - type: custom:mushroom-light-card
            entity: light.buro_screenbar_ambilight
            name: Büro Ambilight
            icon: mdi:monitor-shimmer
            use_light_color: true
            show_brightness_control: true
            show_color_temp_control: true
            show_color_control: false
            collapsible_controls: true
            double_tap_action:
              action: none
            tap_action:
              action: toggle
            hold_action:
              action: more-info
            layout: vertical
            fill_container: true
            primary_info: name
            secondary_info: state
      - square: false
        type: grid
        columns: 2
        cards:
          - type: custom:vertical-stack-in-card
            cards:
              - type: custom:mushroom-person-card
                entity: person.homeassistant_eikelmann
                icon_type: entity-picture
                primary_info: name
                secondary_info: state
                name: Daniel
                icon: mdi:face-man
          - type: custom:vertical-stack-in-card
            cards:
              - type: custom:mushroom-person-card
                entity: person.andrea_eikelmann
                icon_type: entity-picture
                primary_info: name
                secondary_info: state
                name: Andrea
                icon: mdi:face-woman
          - type: custom:vertical-stack-in-card
            cards:
              - type: custom:mushroom-person-card
                entity: person.phil
                icon_type: entity-picture
                primary_info: name
                secondary_info: state
                name: Phil
                icon: mdi:face-man
          - type: custom:vertical-stack-in-card
            cards:
              - type: custom:mushroom-person-card
                entity: person.nick
                icon_type: entity-picture
                primary_info: name
                secondary_info: state
                name: Nick
                icon: mdi:face-man
          - type: custom:vertical-stack-in-card
            cards:
              - type: custom:mushroom-template-card
                entity: input_boolean.post
                primary: Post
                secondary: |
                  {% if is_state('input_boolean.post', 'on') %}
                    📬 ist da!
                  {% else %}
                    📭 keine!
                  {% endif %}
                icon: mdi:email
                icon_color: |
                  {% if is_state('input_boolean.post', 'on') %}
                    green
                  {% else %}
                    grey
                  {% endif %}
                tap_action:
                  action: call-service
                  service: input_boolean.turn_off
                  target:
                    entity_id: input_boolean.post
                  confirmation:
                    text: Briefkasten geleert?
          - type: custom:vertical-stack-in-card
            cards:
              - type: custom:mushroom-entity-card
                entity: sensor.letzte_post_kurz
      - declutter_templates:
          temp_color: |
            {% set s=states(entity)|float(0) %}
            {% if not is_number(s) %}
              gray
            {% elif s < 0 %}
              indigo
            {% elif s < 15 %}
              light-blue
            {% elif s < 20 %}
              green
            {% elif s < 22 %}
              light-green
            {% elif s < 25 %}
              lime
            {% elif s < 28 %}
              yellow
            {% elif s < 31 %}
              amber
            {% elif s < 34 %}
              orange
            {% elif s < 37 %}
              deep-orange
            {% else %}
              red
            {% endif %}
          humid_color: |
            {% set s=states(entity)|float(0) %}
            {% if not is_number(s) %}
              gray
            {% elif s <= 60 %}
              green
            {% elif s <= 65 %}
              deep-orange
            {% else %}
              red
            {% endif %}
          humid_icon: |
            {% set s=states(entity)|float(0) %}
            {% if not is_number(s) %}
              gray
            {% elif s <= 65 %}
              mdi:water-percent
            {% else %}
              mdi:water-percent-alert
            {% endif %}
        type: grid
        square: false
        columns: 2
        cards:
          - type: custom:vertical-stack-in-card
            cards:
              - type: custom:text-divider-row
                text: Temperatur
          - type: custom:vertical-stack-in-card
            cards:
              - type: custom:text-divider-row
                text: Feuchtigkeit
          - type: custom:vertical-stack-in-card
            cards:
              - type: custom:mushroom-template-card
                primary: Garten
                entity: sensor.netatmo_draussen_temperature
                secondary: '{{ states(entity) }} °C'
                icon: mdi:thermometer
                icon_color: |
                  {% set s=states(entity)|float(0) %}
                  {% if not is_number(s) %}
                    gray
                  {% elif s < 0 %}
                    indigo
                  {% elif s < 15 %}
                    light-blue
                  {% elif s < 20 %}
                    green
                  {% elif s < 22 %}
                    light-green
                  {% elif s < 25 %}
                    lime
                  {% elif s < 28 %}
                    yellow
                  {% elif s < 31 %}
                    amber
                  {% elif s < 34 %}
                    orange
                  {% elif s < 37 %}
                    deep-orange
                  {% else %}
                    red
                  {% endif %}
                vertical: true
                tap_action:
                  action: more-info
          - type: custom:vertical-stack-in-card
            cards:
              - type: custom:mushroom-template-card
                primary: Garten
                entity: sensor.netatmo_draussen_humidity
                secondary: '{{ states(entity) }} %'
                icon: |
                  {% set s=states(entity)|float(0) %}
                  {% if not is_number(s) %}
                    gray
                  {% elif s <= 65 %}
                    mdi:water-percent
                  {% else %}
                    mdi:water-percent-alert
                  {% endif %}
                icon_color: |
                  {% set s=states(entity)|float(0) %}
                  {% if not is_number(s) %}
                    gray
                  {% elif s <= 60 %}
                    green
                  {% elif s <= 65 %}
                    deep-orange
                  {% else %}
                    red
                  {% endif %}
                vertical: true
                tap_action:
                  action: more-info
          - type: custom:vertical-stack-in-card
            cards:
              - type: custom:mushroom-template-card
                primary: Badezimmer
                entity: sensor.sensor_bad_temperature
                secondary: '{{ states(entity) }} °C'
                icon: mdi:thermometer
                icon_color: |
                  {% set s=states(entity)|float(0) %}
                  {% if not is_number(s) %}
                    gray
                  {% elif s < 0 %}
                    indigo
                  {% elif s < 15 %}
                    light-blue
                  {% elif s < 20 %}
                    green
                  {% elif s < 22 %}
                    light-green
                  {% elif s < 25 %}
                    lime
                  {% elif s < 28 %}
                    yellow
                  {% elif s < 31 %}
                    amber
                  {% elif s < 34 %}
                    orange
                  {% elif s < 37 %}
                    deep-orange
                  {% else %}
                    red
                  {% endif %}
                vertical: true
                tap_action:
                  action: more-info
          - type: custom:vertical-stack-in-card
            cards:
              - type: custom:mushroom-template-card
                primary: Badezimmer
                entity: sensor.sensor_bad_humidity
                secondary: '{{ states(entity) }} %'
                icon: |
                  {% set s=states(entity)|float(0) %}
                  {% if not is_number(s) %}
                    gray
                  {% elif s <= 65 %}
                    mdi:water-percent
                  {% else %}
                    mdi:water-percent-alert
                  {% endif %}
                icon_color: |
                  {% set s=states(entity)|float(0) %}
                  {% if not is_number(s) %}
                    gray
                  {% elif s <= 60 %}
                    green
                  {% elif s <= 65 %}
                    deep-orange
                  {% else %}
                    red
                  {% endif %}
                vertical: true
                tap_action:
                  action: more-info
          - type: custom:vertical-stack-in-card
            cards:
              - type: custom:mushroom-template-card
                primary: Büro
                entity: sensor.sensor_buro_temperature
                secondary: '{{ states(entity) }} °C'
                icon: mdi:thermometer
                icon_color: |
                  {% set s=states(entity)|float(0) %}
                  {% if not is_number(s) %}
                    gray
                  {% elif s < 0 %}
                    indigo
                  {% elif s < 15 %}
                    light-blue
                  {% elif s < 20 %}
                    green
                  {% elif s < 22 %}
                    light-green
                  {% elif s < 25 %}
                    lime
                  {% elif s < 28 %}
                    yellow
                  {% elif s < 31 %}
                    amber
                  {% elif s < 34 %}
                    orange
                  {% elif s < 37 %}
                    deep-orange
                  {% else %}
                    red
                  {% endif %}
                vertical: true
                tap_action:
                  action: more-info
          - type: custom:vertical-stack-in-card
            cards:
              - type: custom:mushroom-template-card
                primary: Büro
                entity: sensor.sensor_buro_humidity
                secondary: '{{ states(entity) }} %'
                icon: |
                  {% set s=states(entity)|float(0) %}
                  {% if not is_number(s) %}
                    gray
                  {% elif s <= 65 %}
                    mdi:water-percent
                  {% else %}
                    mdi:water-percent-alert
                  {% endif %}
                icon_color: |
                  {% set s=states(entity)|float(0) %}
                  {% if not is_number(s) %}
                    gray
                  {% elif s <= 60 %}
                    green
                  {% elif s <= 65 %}
                    deep-orange
                  {% else %}
                    red
                  {% endif %}
                vertical: true
                tap_action:
                  action: more-info
          - type: custom:vertical-stack-in-card
            cards:
              - type: custom:mushroom-template-card
                primary: Schlafzimmer
                entity: sensor.sensor_schlafzimmer_temperature
                secondary: '{{ states(entity) }} °C'
                icon: mdi:thermometer
                icon_color: |
                  {% set s=states(entity)|float(0) %}
                  {% if not is_number(s) %}
                    gray
                  {% elif s < 0 %}
                    indigo
                  {% elif s < 15 %}
                    light-blue
                  {% elif s < 20 %}
                    green
                  {% elif s < 22 %}
                    light-green
                  {% elif s < 25 %}
                    lime
                  {% elif s < 28 %}
                    yellow
                  {% elif s < 31 %}
                    amber
                  {% elif s < 34 %}
                    orange
                  {% elif s < 37 %}
                    deep-orange
                  {% else %}
                    red
                  {% endif %}
                vertical: true
                tap_action:
                  action: more-info
          - type: custom:vertical-stack-in-card
            cards:
              - type: custom:mushroom-template-card
                primary: Schlafzimmer
                entity: sensor.sensor_schlafzimmer_humidity
                secondary: '{{ states(entity) }} %'
                icon: |
                  {% set s=states(entity)|float(0) %}
                  {% if not is_number(s) %}
                    gray
                  {% elif s <= 65 %}
                    mdi:water-percent
                  {% else %}
                    mdi:water-percent-alert
                  {% endif %}
                icon_color: |
                  {% set s=states(entity)|float(0) %}
                  {% if not is_number(s) %}
                    gray
                  {% elif s <= 60 %}
                    green
                  {% elif s <= 65 %}
                    deep-orange
                  {% else %}
                    red
                  {% endif %}
                vertical: true
                tap_action:
                  action: more-info
          - type: custom:vertical-stack-in-card
            cards:
              - type: custom:mushroom-template-card
                primary: Phil
                entity: sensor.sensor_phil_temperature
                secondary: '{{ states(entity) }} °C'
                icon: mdi:thermometer
                icon_color: |
                  {% set s=states(entity)|float(0) %}
                  {% if not is_number(s) %}
                    gray
                  {% elif s < 0 %}
                    indigo
                  {% elif s < 15 %}
                    light-blue
                  {% elif s < 20 %}
                    green
                  {% elif s < 22 %}
                    light-green
                  {% elif s < 25 %}
                    lime
                  {% elif s < 28 %}
                    yellow
                  {% elif s < 31 %}
                    amber
                  {% elif s < 34 %}
                    orange
                  {% elif s < 37 %}
                    deep-orange
                  {% else %}
                    red
                  {% endif %}
                vertical: true
                tap_action:
                  action: more-info
          - type: custom:vertical-stack-in-card
            cards:
              - type: custom:mushroom-template-card
                primary: Phil
                entity: sensor.sensor_phil_humidity
                secondary: '{{ states(entity) }} %'
                icon: |
                  {% set s=states(entity)|float(0) %}
                  {% if not is_number(s) %}
                    gray
                  {% elif s <= 65 %}
                    mdi:water-percent
                  {% else %}
                    mdi:water-percent-alert
                  {% endif %}
                icon_color: |
                  {% set s=states(entity)|float(0) %}
                  {% if not is_number(s) %}
                    gray
                  {% elif s <= 60 %}
                    green
                  {% elif s <= 65 %}
                    deep-orange
                  {% else %}
                    red
                  {% endif %}
                vertical: true
                tap_action:
                  action: more-info
          - type: custom:vertical-stack-in-card
            cards:
              - type: custom:mushroom-template-card
                primary: Nick
                entity: sensor.sensor_nick_temperature
                secondary: '{{ states(entity) }} °C'
                icon: mdi:thermometer
                icon_color: |
                  {% set s=states(entity)|float(0) %}
                  {% if not is_number(s) %}
                    gray
                  {% elif s < 0 %}
                    indigo
                  {% elif s < 15 %}
                    light-blue
                  {% elif s < 20 %}
                    green
                  {% elif s < 22 %}
                    light-green
                  {% elif s < 25 %}
                    lime
                  {% elif s < 28 %}
                    yellow
                  {% elif s < 31 %}
                    amber
                  {% elif s < 34 %}
                    orange
                  {% elif s < 37 %}
                    deep-orange
                  {% else %}
                    red
                  {% endif %}
                vertical: true
                tap_action:
                  action: more-info
          - type: custom:vertical-stack-in-card
            cards:
              - type: custom:mushroom-template-card
                primary: Nick
                entity: sensor.sensor_nick_humidity
                secondary: '{{ states(entity) }} %'
                icon: |
                  {% set s=states(entity)|float(0) %}
                  {% if not is_number(s) %}
                    gray
                  {% elif s <= 65 %}
                    mdi:water-percent
                  {% else %}
                    mdi:water-percent-alert
                  {% endif %}
                icon_color: |
                  {% set s=states(entity)|float(0) %}
                  {% if not is_number(s) %}
                    gray
                  {% elif s <= 60 %}
                    green
                  {% elif s <= 65 %}
                    deep-orange
                  {% else %}
                    red
                  {% endif %}
                vertical: true
                tap_action:
                  action: more-info
          - type: custom:vertical-stack-in-card
            cards:
              - type: custom:mushroom-template-card
                primary: WC OG
                entity: sensor.wc_og_temperature
                secondary: '{{ states(entity) }} °C'
                icon: mdi:thermometer
                icon_color: |
                  {% set s=states(entity)|float(0) %}
                  {% if not is_number(s) %}
                    gray
                  {% elif s < 0 %}
                    indigo
                  {% elif s < 15 %}
                    light-blue
                  {% elif s < 20 %}
                    green
                  {% elif s < 22 %}
                    light-green
                  {% elif s < 25 %}
                    lime
                  {% elif s < 28 %}
                    yellow
                  {% elif s < 31 %}
                    amber
                  {% elif s < 34 %}
                    orange
                  {% elif s < 37 %}
                    deep-orange
                  {% else %}
                    red
                  {% endif %}
                vertical: true
                tap_action:
                  action: more-info
          - type: custom:vertical-stack-in-card
            cards:
              - type: custom:mushroom-template-card
                primary: WC OG
                entity: sensor.wc_og_humidity
                secondary: '{{ states(entity) }} %'
                icon: |
                  {% set s=states(entity)|float(0) %}
                  {% if not is_number(s) %}
                    gray
                  {% elif s <= 65 %}
                    mdi:water-percent
                  {% else %}
                    mdi:water-percent-alert
                  {% endif %}
                icon_color: |
                  {% set s=states(entity)|float(0) %}
                  {% if not is_number(s) %}
                    gray
                  {% elif s <= 60 %}
                    green
                  {% elif s <= 65 %}
                    deep-orange
                  {% else %}
                    red
                  {% endif %}
                vertical: true
                tap_action:
                  action: more-info
          - type: custom:vertical-stack-in-card
            cards:
              - type: custom:mushroom-template-card
                primary: Flur OG
                entity: sensor.sensor_flur_og_temperature
                secondary: '{{ states(entity) }} °C'
                icon: mdi:thermometer
                icon_color: |
                  {% set s=states(entity)|float(0) %}
                  {% if not is_number(s) %}
                    gray
                  {% elif s < 0 %}
                    indigo
                  {% elif s < 15 %}
                    light-blue
                  {% elif s < 20 %}
                    green
                  {% elif s < 22 %}
                    light-green
                  {% elif s < 25 %}
                    lime
                  {% elif s < 28 %}
                    yellow
                  {% elif s < 31 %}
                    amber
                  {% elif s < 34 %}
                    orange
                  {% elif s < 37 %}
                    deep-orange
                  {% else %}
                    red
                  {% endif %}
                vertical: true
                tap_action:
                  action: more-info
          - type: custom:vertical-stack-in-card
            cards:
              - type: custom:mushroom-template-card
                primary: Flur OG
                entity: sensor.sensor_flur_og_humidity
                secondary: '{{ states(entity) }} %'
                icon: |
                  {% set s=states(entity)|float(0) %}
                  {% if not is_number(s) %}
                    gray
                  {% elif s <= 65 %}
                    mdi:water-percent
                  {% else %}
                    mdi:water-percent-alert
                  {% endif %}
                icon_color: |
                  {% set s=states(entity)|float(0) %}
                  {% if not is_number(s) %}
                    gray
                  {% elif s <= 60 %}
                    green
                  {% elif s <= 65 %}
                    deep-orange
                  {% else %}
                    red
                  {% endif %}
                vertical: true
                tap_action:
                  action: more-info
          - type: custom:vertical-stack-in-card
            cards:
              - type: custom:mushroom-template-card
                primary: WC EG
                entity: sensor.wc_eg_temperature
                secondary: '{{ states(entity) }} °C'
                icon: mdi:thermometer
                icon_color: |
                  {% set s=states(entity)|float(0) %}
                  {% if not is_number(s) %}
                    gray
                  {% elif s < 0 %}
                    indigo
                  {% elif s < 15 %}
                    light-blue
                  {% elif s < 20 %}
                    green
                  {% elif s < 22 %}
                    light-green
                  {% elif s < 25 %}
                    lime
                  {% elif s < 28 %}
                    yellow
                  {% elif s < 31 %}
                    amber
                  {% elif s < 34 %}
                    orange
                  {% elif s < 37 %}
                    deep-orange
                  {% else %}
                    red
                  {% endif %}
                vertical: true
                tap_action:
                  action: more-info
          - type: custom:vertical-stack-in-card
            cards:
              - type: custom:mushroom-template-card
                primary: WC EG
                entity: sensor.wc_eg_humidity
                secondary: '{{ states(entity) }} %'
                icon: |
                  {% set s=states(entity)|float(0) %}
                  {% if not is_number(s) %}
                    gray
                  {% elif s <= 65 %}
                    mdi:water-percent
                  {% else %}
                    mdi:water-percent-alert
                  {% endif %}
                icon_color: |
                  {% set s=states(entity)|float(0) %}
                  {% if not is_number(s) %}
                    gray
                  {% elif s <= 60 %}
                    green
                  {% elif s <= 65 %}
                    deep-orange
                  {% else %}
                    red
                  {% endif %}
                vertical: true
                tap_action:
                  action: more-info
          - type: custom:vertical-stack-in-card
            cards:
              - type: custom:mushroom-template-card
                primary: Flur EG
                entity: sensor.flureg_temperature
                secondary: '{{ states(entity) }} °C'
                icon: mdi:thermometer
                icon_color: |
                  {% set s=states(entity)|float(0) %}
                  {% if not is_number(s) %}
                    gray
                  {% elif s < 0 %}
                    indigo
                  {% elif s < 15 %}
                    light-blue
                  {% elif s < 20 %}
                    green
                  {% elif s < 22 %}
                    light-green
                  {% elif s < 25 %}
                    lime
                  {% elif s < 28 %}
                    yellow
                  {% elif s < 31 %}
                    amber
                  {% elif s < 34 %}
                    orange
                  {% elif s < 37 %}
                    deep-orange
                  {% else %}
                    red
                  {% endif %}
                vertical: true
                tap_action:
                  action: more-info
          - type: custom:vertical-stack-in-card
            cards:
              - type: custom:mushroom-template-card
                primary: Flur EG
                entity: sensor.flureg_humidity
                secondary: '{{ states(entity) }} %'
                icon: |
                  {% set s=states(entity)|float(0) %}
                  {% if not is_number(s) %}
                    gray
                  {% elif s <= 65 %}
                    mdi:water-percent
                  {% else %}
                    mdi:water-percent-alert
                  {% endif %}
                icon_color: |
                  {% set s=states(entity)|float(0) %}
                  {% if not is_number(s) %}
                    gray
                  {% elif s <= 60 %}
                    green
                  {% elif s <= 65 %}
                    deep-orange
                  {% else %}
                    red
                  {% endif %}
                vertical: true
                tap_action:
                  action: more-info
          - type: custom:vertical-stack-in-card
            cards:
              - type: custom:mushroom-template-card
                primary: Küche
                entity: sensor.netatmo_innen_temperature
                secondary: '{{ states(entity) }} °C'
                icon: mdi:thermometer
                icon_color: |
                  {% set s=states(entity)|float(0) %}
                  {% if not is_number(s) %}
                    gray
                  {% elif s < 0 %}
                    indigo
                  {% elif s < 15 %}
                    light-blue
                  {% elif s < 20 %}
                    green
                  {% elif s < 22 %}
                    light-green
                  {% elif s < 25 %}
                    lime
                  {% elif s < 28 %}
                    yellow
                  {% elif s < 31 %}
                    amber
                  {% elif s < 34 %}
                    orange
                  {% elif s < 37 %}
                    deep-orange
                  {% else %}
                    red
                  {% endif %}
                vertical: true
                tap_action:
                  action: more-info
          - type: custom:vertical-stack-in-card
            cards:
              - type: custom:mushroom-template-card
                primary: Küche
                entity: sensor.netatmo_innen_humidity
                secondary: '{{ states(entity) }} %'
                icon: |
                  {% set s=states(entity)|float(0) %}
                  {% if not is_number(s) %}
                    gray
                  {% elif s <= 65 %}
                    mdi:water-percent
                  {% else %}
                    mdi:water-percent-alert
                  {% endif %}
                icon_color: |
                  {% set s=states(entity)|float(0) %}
                  {% if not is_number(s) %}
                    gray
                  {% elif s <= 60 %}
                    green
                  {% elif s <= 65 %}
                    deep-orange
                  {% else %}
                    red
                  {% endif %}
                vertical: true
                tap_action:
                  action: more-info
          - type: custom:vertical-stack-in-card
            cards:
              - type: custom:mushroom-template-card
                primary: Wohnzimmer
                entity: sensor.sensor_wohnzimmer_temperature
                secondary: '{{ states(entity) }} °C'
                icon: mdi:thermometer
                icon_color: |
                  {% set s=states(entity)|float(0) %}
                  {% if not is_number(s) %}
                    gray
                  {% elif s < 0 %}
                    indigo
                  {% elif s < 15 %}
                    light-blue
                  {% elif s < 20 %}
                    green
                  {% elif s < 22 %}
                    light-green
                  {% elif s < 25 %}
                    lime
                  {% elif s < 28 %}
                    yellow
                  {% elif s < 31 %}
                    amber
                  {% elif s < 34 %}
                    orange
                  {% elif s < 37 %}
                    deep-orange
                  {% else %}
                    red
                  {% endif %}
                vertical: true
                tap_action:
                  action: more-info
          - type: custom:vertical-stack-in-card
            cards:
              - type: custom:mushroom-template-card
                primary: Wohnzimmer
                entity: sensor.sensor_wohnzimmer_humidity
                secondary: '{{ states(entity) }} %'
                icon: |
                  {% set s=states(entity)|float(0) %}
                  {% if not is_number(s) %}
                    gray
                  {% elif s <= 65 %}
                    mdi:water-percent
                  {% else %}
                    mdi:water-percent-alert
                  {% endif %}
                icon_color: |
                  {% set s=states(entity)|float(0) %}
                  {% if not is_number(s) %}
                    gray
                  {% elif s <= 60 %}
                    green
                  {% elif s <= 65 %}
                    deep-orange
                  {% else %}
                    red
                  {% endif %}
                vertical: true
                tap_action:
                  action: more-info
      - type: custom:power-flow-card-plus
        entities:
          battery:
            entity: ''
            state_of_charge: sensor.mi_pad_5_battery_level
          grid:
            entity:
              consumption: sensor.stromverbrauch_differenz
              production: sensor.einspeisung
            color_value: false
            secondary_info:
              entity: sensor.einspeisung_kwh_tag
              unit_of_measurement: kWh
              unit_white_space: true
          secondary_info:
            entity: sensor.einspeisung_kwh_tag
            unit_of_measurement: kWh
            unit_white_space: true
          home:
            secondary_info:
              unit_of_measurement: kWh
              entity: sensor.stromverbrauch_kwh_monatlich
              unit_white_space: true
            subtract_individual: false
            override_state: false
          individual:
            - entity: sensor.autoladegerat_leistung
              name: Auto
              icon: mdi:car-electric
              display_zero: true
              display_zero_state: false
              secondary_info:
                entity: sensor.kia_ceed_sw_stromverbrauch_monatlich
                unit_of_measurement: kWh
                unit_white_space: true
              display_zero_tolerance: 4
            - entity: sensor.nas_ha_laptop_power
              name: Server
              icon: mdi:server
              color_value: false
              color_icon: true
              show_direction: false
              inverted_animation: false
              use_metadata: false
              secondary_info:
                entity: sensor.nas_ha_laptop_monatlich
                unit_of_measurement: kWh
                unit_white_space: true
              display_zero: false
            - entity: sensor.stromverbrauch_aktuell_alle_pcs
              secondary_info:
                unit_of_measurement: kWh
                unit_white_space: true
                entity: sensor.stromverbrauch_monat_alle_pcs
              name: Computer
              color_icon: true
              icon: mdi:desktop-tower-monitor
              color:
                - 0
                - 128
                - 64
              display_zero: true
              display_zero_state: false
              display_zero_tolerance: 5
            - entity: sensor.stromverbrauch_aktuell_alle_grossgerate
              name: Großgeräte
              icon: mdi:washing-machine
              display_zero_tolerance: 1
              display_zero: false
              display_zero_state: false
              secondary_info:
                entity: sensor.stromverbrauch_monat_alle_grossgerate
                unit_of_measurement: kWh
            - entity: sensor.stromverbrauch_aktuell_alle_tvs
              secondary_info:
                entity: sensor.stromverbrauch_monat_alle_tvs
                unit_of_measurement: kWh
              name: TV-Geräte
              color_icon: true
              display_zero_state: false
          solar:
            entity: sensor.solar_gesamtleistung
            color_value: true
            color_icon: true
            secondary_info:
              entity: sensor.solar_produktion_von_heute
              unit_of_measurement: kWh
              decimals: 2
            invert_state: false
            display_zero_state: true
            use_metadata: false
          fossil_fuel_percentage:
            secondary_info: {}
        clickable_entities: true
        display_zero_lines:
          mode: show
          transparency: 50
          grey_color:
            - 189
            - 189
            - 189
        use_new_flow_rate_model: true
        w_decimals: 0
        kw_decimals: 1
        min_flow_rate: 0.75
        max_flow_rate: 6
        max_expected_power: 2000
        watt_threshold: 1000
        transparency_zero_lines: 0
        disable_dots: false
        min_expected_power: 0.01
        title: Stromverbrauch
      - type: horizontal-stack
        cards:
          - type: custom:button-card
            entity: input_boolean.heizungsmodus
            layout: name_state
            name: Heizungsmodus
            show_state: false
            show_label: true
            label: |
              [[[
                if (entity.state === 'on') {
                  return '🔥 Aktiv';
                } else {
                  return '❄️ Inaktiv';
                }
              ]]]
            styles:
              card:
                - border-radius: var(--border-radius)
                - padding: 12px
              label:
                - font-weight: 500
                - font-size: 0.9em
              name:
                - font-size: 1.1em
                - font-weight: 500
            state:
              - value: 'off'
                color: var(--disabled-text-color)
                icon: mdi:radiator-off
                styles:
                  card:
                    - background: rgba(var(--rgb-disabled), 0.1)
              - value: 'on'
                color: orange
                icon: mdi:radiator
                styles:
                  card:
                    - background: rgba(255, 165, 0, 0.1)
                    - animation: pulse 2s infinite ease-in-out
            tap_action:
              action: toggle
              confirmation:
                text: Heizungsmodus umschalten?
                exemptions: []
          - type: custom:button-card
            entity: input_boolean.urlaubsmodus
            layout: name_state
            name: Urlaubsmodus
            show_state: false
            show_label: true
            label: |
              [[[
                if (entity.state === 'on') {
                  return '✈️ Aktiv';
                } else {
                  return '🏠 Inaktiv';
                }
              ]]]
            styles:
              card:
                - border-radius: var(--border-radius)
                - padding: 12px
              label:
                - font-weight: 500
                - font-size: 0.9em
              name:
                - font-size: 1.1em
                - font-weight: 500
            state:
              - value: 'off'
                color: var(--disabled-text-color)
                icon: mdi:home
                styles:
                  card:
                    - background: rgba(var(--rgb-disabled), 0.1)
              - value: 'on'
                color: purple
                icon: mdi:airplane
                styles:
                  card:
                    - background: rgba(128, 0, 128, 0.1)
                    - animation: pulse 2s infinite ease-in-out
            tap_action:
              action: toggle
              confirmation:
                text: Urlaubsmodus umschalten?
                exemptions: []
        animations:
          pulse:
            - keyframes:
                - 0%:
                    opacity: 1
                    transform: scale(1)
                - 50%:
                    opacity: 0.8
                    transform: scale(1.05)
                - 100%:
                    opacity: 1
                    transform: scale(1)
      - type: custom:text-divider-row
        text: Anderes
      - type: horizontal-stack
        cards:
          - type: custom:mushroom-entity-card
            entity: sensor.restmull
            name: Rest
            icon: mdi:delete
            icon_color: red
            layout: vertical
            primary_info: name
          - type: custom:mushroom-entity-card
            entity: sensor.biomull
            name: Bio
            icon: mdi:leaf
            icon_color: green
            layout: vertical
            primary_info: name
          - type: custom:mushroom-entity-card
            entity: sensor.papiermull
            name: Papier
            icon: mdi:newspaper-variant
            icon_color: blue
            layout: vertical
            primary_info: name
          - type: custom:mushroom-entity-card
            entity: sensor.werstoffmull
            name: Gelb
            icon: mdi:recycle
            icon_color: amber
            layout: vertical
            primary_info: name
      - type: custom:layout-card
        layout_type: custom:grid-layout
        layout:
          margin: -1
        view_layout:
          grid-area: row1
        cards:
          - type: custom:layout-card
            layout_type: custom:grid-layout
            layout:
              margin: 0
            cards:
              - type: custom:vertical-stack-in-card
                cards:
                  - type: grid
                    square: false
                    columns: 1
                    cards:
                      - type: weather-forecast
                        entity: weather.lingen
                        name: Lingen
                        show_current: true
                        show_forecast: false
                        secondary_info_attribute: wind_speed
                        forecast_type: legacy
                      - type: custom:weather-chart-card
                        entity: weather.lingen
                        title: ''
                        animated_icons: true
                        icon_style: style1
                        icons: ''
                        show_main: false
                        show_current_condition: true
                        current_temp_size: '28'
                        show_time: false
                        show_day: false
                        show_date: false
                        show_attributes: false
                        show_humidity: true
                        show_pressure: true
                        show_wind_direction: true
                        show_wind_speed: true
                        show_sun: true
                        units:
                          pressure: ''
                          speed: ''
                        temp: ''
                        press: ''
                        humid: ''
                        uv: ''
                        winddir: ''
                        windspeed: ''
                        forecast:
                          labels_font_size: '11'
                          show_wind_forecast: true
                          condition_icons: true
                          round_temp: false
                          style: style2
      - type: custom:neerslag-card
        entity: sensor.neerslag_buienalarm_regen_data
        title: Niederschlag
        autozoom: true
        show_chart: true
        show_table: false
        hours_to_show: 2
        language: de
        icon: mdi:weather-rainy
      - type: custom:hourly-weather
        entity: weather.lingen
        name: Wetter Lingen
        num_segments: 12
        show_wind: speed
        icons: true
        show_precipitation: true
        show_temperature: true
        show_humidity: true
        show_wind_direction: true
      - type: horizontal-stack
        cards:
          - type: entities
            state_color: false
            show_header_toggle: true
            entities:
              - entity: person.homeassistant_eikelmann
                name: Daniel
              - entity: sensor.pixel_6_pro_battery_level
                name: Pixel Akku
                icon: mdi:cellphone
              - entity: sensor.mi_pad_5_battery_level
                name: Mi Pad 5 Akku
                icon: mdi:tablet
      - type: calendar
        title: Familienkalender
        theme: Mushroom
        initial_view: dayGridDay
        entities:
          - calendar.famillienkalender
          - calendar.deutschland_ni
          - calendar.borussia_dortmund
          - calendar.feiertage_in_deutschland
          - calendar.ferien_niedersachsen
          - calendar.daniel_s_kalender
  - title: Energie
    path: energie
    icon: mdi:transmission-tower
    type: sections
    max_columns: 4
    sections:
      - type: grid
        cards:
          - type: heading
            heading: Stromverbrauch
          - type: custom:stack-in-card
            title: null
            mode: vertical
            cards:
              - type: vertical-stack
                cards:
                  - type: horizontal-stack
                    cards:
                      - type: custom:mushroom-template-card
                        icon: mdi:lightning-bolt-circle
                        icon_color: green
                        entity: sensor.gesamtleistung
                        primary: Strom
                        secondary: >-
                          {{ states('sensor.gesamtleistung') | round(0) }} W 

                          {{ states('sensor.stromverbrauch_kwh_taglich') |
                          round(2) }} kWh
                        tap_action:
                          action: more-info
                        multiline_secondary: true
                        card_mod:
                          style: |
                            ha-card {
                            border: none;
                            width: 125%;
                            z-index: 2;
                            }
                            :host {
                              --mush-icon-size: 160px;
                              height: 66px;
                              margin-left: -75px !important;
                              margin-top: -30px !important;
                            }
                      - type: vertical-stack
                        cards:
                          - type: custom:mushroom-chips-card
                            chips:
                              - type: entity
                                entity: input_text.zahler_strom_nummer
                                icon: mdi:information
                                card_mod:
                                  style: |
                                    ha-card {
                                    border: none !important;
                                    }
                            alignment: end
                          - type: custom:mushroom-chips-card
                            chips:
                              - type: entity
                                entity: sensor.monthly_cost_immenhook_15
                                icon: mdi:currency-eur
                                tap-action:
                                  action: none
                                card_mod:
                                  style: |
                                    ha-card {
                                    margin-top: 0px;
                                    border: none !important;
                                    }
                              - type: entity
                                entity: sensor.monthly_net_consumption_immenhook_15
                                icon: mdi:transmission-tower-export
                                tap-action:
                                  action: more-info
                                card_mod:
                                  style: |
                                    ha-card {
                                    background: none !important;
                                    border: none !important;
                                    margin-top: 0px;
                                    z-index: 1;
                                    }
                            alignment: end
                          - type: custom:mushroom-chips-card
                            chips:
                              - type: entity
                                entity: sensor.electricity_price_immenhook_15
                                icon_color: red
                                card_mod:
                                  style: |
                                    ha-card {
                                    background: none !important;
                                    border: none !important;
                                    z-index: 1;
                                    }
                            alignment: end
                  - type: horizontal-stack
                    cards:
                      - type: custom:mini-graph-card
                        entities:
                          - entity: sensor.gesamtleistung
                            color: green
                            show_fill: true
                            show_points: false
                            show_legend: false
                        hours_to_show: 12
                        animate: false
                        line_width: 1
                        hour24: true
                        lower_bound: 0
                        points_per_hour: 5
                        tap_action: none
                        show:
                          labels: false
                          icon: false
                          name: false
                          state: false
                          graph: line
                          extrema: false
                          icon_adaptive_color: false
                        align_icon: left
                        card_mod:
                          style: |
                            ha-card {
                            border: none;
                            margin-top: -125px;
                            max-height: 100px !important;
                            opacity: .2;
                            }
            card_mod:
              style: |
                ha-card {
                overflow: hidden !important;
                max-height: 115px !important;
                }
          - type: horizontal-stack
            cards:
              - type: gauge
                entity: sensor.gesamtleistung
                name: Aktueller Stromverbrauch
                max: 5000
                needle: true
                severity:
                  green: 0
                  yellow: 2000
                  red: 4000
                unit: W
                card_mod:
                  style: |
                    ha-card {
                      border-radius: var(--border-radius, 12px);
                      background: var(--card-background-color, var(--primary-background-color));
                      color: #fff;
                    }
                    .gauge-value, .gauge-title {
                      color: #fff !important;
                    }
              - type: gauge
                entity: sensor.stromverbrauch_differenz
                name: Netzbezug
                needle: false
                unit: W
                card_mod:
                  style: |
                    ha-card {
                      border-radius: var(--border-radius, 12px);
                      background: var(--card-background-color, var(--primary-background-color));
                      color: #fff;
                    }
                    .gauge-value, .gauge-title {
                      color: #fff !important;
                    }
          - type: horizontal-stack
            cards:
              - type: gauge
                entity: sensor.stromverbrauch_kwh_taglich
                name: Stromverbrauch heute
                max: 25
                needle: true
                severity:
                  green: 0
                  yellow: 8
                  red: 15
                unit: kWh
                card_mod:
                  style: |
                    ha-card {
                      border-radius: var(--border-radius, 12px);
                      background: var(--card-background-color, var(--primary-background-color));
                      color: #fff;
                    }
                    .gauge-value, .gauge-title {
                      color: #fff !important;
                    }
              - type: gauge
                entity: sensor.stromverbrauch_solarproduktion_diff_kwh
                name: Strombezug heute
                max: 25
                needle: false
                unit: kWh
                card_mod:
                  style: |
                    ha-card {
                      border-radius: var(--border-radius, 12px);
                      background: var(--card-background-color, var(--primary-background-color));
                      color: #fff;
                    }
                    .gauge-value, .gauge-title {
                      color: #fff !important;
                    }
          - type: custom:power-flow-card-plus
            clickable_entities: true
            use_new_flow_rate_model: true
            disable_dots: false
            w_decimals: 0
            kw_decimals: 1
            min_flow_rate: 0.75
            max_flow_rate: 6
            max_expected_power: 2000
            min_expected_power: 0.01
            watt_threshold: 1000
            display_zero_lines:
              mode: show
              transparency: 50
              grey_color:
                - 189
                - 189
                - 189
            transparency_zero_lines: 0
            entities:
              battery:
                entity: ''
                state_of_charge: sensor.mi_pad_5_battery_level
              grid:
                entity:
                  consumption: sensor.stromverbrauch_differenz
                  production: sensor.einspeisung
                color_value: false
                secondary_info:
                  entity: sensor.einspeisung_kwh_tag
                  unit_of_measurement: kWh
                  unit_white_space: true
              home:
                entity: sensor.gesamtleistung
                override_state: false
                secondary_info:
                  entity: sensor.stromverbrauch_kwh_monatlich
                  unit_of_measurement: kWh
                  unit_white_space: true
              solar:
                entity: sensor.solar_gesamtleistung
                color_value: false
                color_icon: true
                display_zero_state: false
                use_metadata: false
                invert_state: false
                secondary_info:
                  entity: sensor.solar_produktion_von_heute
                  unit_of_measurement: kWh
                  decimals: 2
              individual:
                - entity: sensor.autoladegerat_leistung
                  name: Auto
                  icon: mdi:car-electric
                  display_zero: true
                  display_zero_state: false
                  display_zero_tolerance: 4
                  secondary_info:
                    entity: sensor.kia_ceed_sw_stromverbrauch_monatlich
                    unit_of_measurement: kWh
                    unit_white_space: true
                - entity: sensor.nas_ha_laptop_power
                  name: Server
                  icon: mdi:server
                  color_value: false
                  color_icon: true
                  show_direction: false
                  inverted_animation: false
                  use_metadata: false
                  display_zero: false
                  secondary_info:
                    entity: sensor.nas_ha_laptop_monatlich
                    unit_of_measurement: kWh
                    unit_white_space: true
                - entity: sensor.stromverbrauch_aktuell_alle_pcs
                  name: Computer
                  icon: mdi:desktop-tower-monitor
                  color_icon: true
                  color:
                    - 0
                    - 128
                    - 64
                  display_zero: true
                  display_zero_state: false
                  display_zero_tolerance: 5
                  secondary_info:
                    entity: sensor.stromverbrauch_monat_alle_pcs
                    unit_of_measurement: kWh
                    unit_white_space: true
                - entity: sensor.stromverbrauch_aktuell_alle_grossgerate
                  name: Großgeräte
                  icon: mdi:washing-machine
                  display_zero: false
                  display_zero_state: false
                  display_zero_tolerance: 1
                  secondary_info:
                    entity: sensor.stromverbrauch_monat_alle_grossgerate
                    unit_of_measurement: kWh
            card_mod:
              style: |
                ha-card {
                  border-radius: var(--border-radius, 12px);
                  background: var(--card-background-color, var(--primary-background-color));
                  color: #fff !important;
                }
                .power-flow-card-plus {
                  color: #fff !important;
                }
                .power-flow-card-plus__value,
                .power-flow-card-plus__label,
                .power-flow-card-plus__secondary {
                  color: #fff !important;
                }
          - type: horizontal-stack
            cards:
              - type: custom:mini-graph-card
                name: Tag
                entities:
                  - sensor.stromverbrauch_kwh_taglich
              - type: custom:mini-graph-card
                name: Woche
                entities:
                  - sensor.stromverbrauch_kwh_wochentlich
          - type: horizontal-stack
            cards:
              - type: custom:mini-graph-card
                name: Monat
                entities:
                  - sensor.stromverbrauch_kwh_monatlich
              - type: custom:mini-graph-card
                name: Jahr
                entities:
                  - sensor.stromverbrauch_kwh_jahrlich
          - type: horizontal-stack
            title: null
            cards:
              - type: custom:vertical-stack-in-card
                cards:
                  - type: custom:mushroom-template-card
                    entity: sensor.monthly_net_consumption_immenhook_15
                    primary: Verbrauch Monat
                    secondary: >
                      {{ states('sensor.monthly_net_consumption_immenhook_15') |
                      round(1, "half", 0) | replace(".0", "") }} kWh
                    icon: mdi:power-plug
                    icon_color: '#B694E7'
                    tap_action:
                      action: more-info
                    card_mod:
                      style: |
                        ha-card {
                          margin-bottom: -10px;
                        }
                  - type: custom:layout-card
                    cards:
                      - type: custom:mini-graph-card
                        entities:
                          - entity: sensor.monthly_net_consumption_immenhook_15
                            color: '#B694E7'
                        hours_to_show: 24
                        line_width: 4
                        animate: true
                        show:
                          name: false
                          icon: false
                          state: false
                          legend: false
                        card_mod:
                          style: |
                            ha-card {
                              border-radius: 12px;
                              box-shadow: none;
                            }
              - type: custom:vertical-stack-in-card
                cards:
                  - type: custom:mushroom-template-card
                    entity: sensor.monthly_cost_immenhook_15
                    primary: Kosten Monat
                    secondary: >
                      {{ states('sensor.monthly_cost_immenhook_15') | round(1,
                      "half", 0) | replace(".0", "") }} €
                    icon: mdi:currency-eur
                    icon_color: '#03A9F4'
                    tap_action:
                      action: more-info
                    card_mod:
                      style: |
                        ha-card {
                          margin-bottom: -15px;
                        }
                  - type: custom:layout-card
                    cards:
                      - type: custom:mini-graph-card
                        entities:
                          - entity: sensor.monthly_cost_immenhook_15
                            color: '#03A9F4'
                        hours_to_show: 24
                        line_width: 4
                        animate: true
                        show:
                          name: false
                          icon: false
                          state: false
                          legend: false
                        card_mod:
                          style: |
                            ha-card {
                              border-radius: 12px;
                              box-shadow: none;
                            }
          - type: horizontal-stack
            cards:
              - type: entities
                entities:
                  - entity: sensor.stromverbrauch_kwh_taglich
                    secondary_info: last-updated
                    icon: mdi:transmission-tower-export
                    name: Tag
                  - entity: sensor.stromverbrauch_kwh_wochentlich
                    name: Woche
                    secondary_info: last-updated
                    icon: mdi:transmission-tower-export
                  - entity: sensor.stromverbrauch_kwh_monatlich
                    name: Monat
                    icon: mdi:transmission-tower-export
                    secondary_info: last-updated
                  - entity: sensor.stromverbrauch_kwh_jahrlich
                    name: Jahr
                    icon: mdi:transmission-tower-export
                    secondary_info: last-updated
                title: Stromverbauch
          - type: energy-usage-graph
            title: Energieverbauch
          - type: custom:apexcharts-card
            experimental:
              color_threshold: true
            graph_span: 7d
            span:
              end: day
            show:
              last_updated: true
            header:
              show: true
              title: Stromverbrauch 7 Tage
              show_states: true
              colorize_states: true
            yaxis:
              - min: 0
                max: ~9
                decimals: 0
                apex_config:
                  tickAmount: 5
            series:
              - entity: sensor.stromverbrauch_kwh_taglich
                type: column
                name: Dauer
                group_by:
                  func: last
                  duration: 1d
                color_threshold:
                  - value: 0
                    color: dodgerblue
                  - value: 1000
                    color: darkcyan
                  - value: 5000
                    color: orange
                  - value: 7000
                    color: orangered
                  - value: 10000
                    color: darkred
          - type: custom:battery-state-card
            secondary_info: '{last_changed}'
            filter:
              include:
                - name: attributes.device_class
                  value: battery
              exclude:
                - name: entity_id
                  value: binary_sensor.*
            sort:
              by: state
            collapse: 10
            bulk_rename:
              - from: ' Battery'
              - from: ' level'
            colors:
              steps:
                - '#ff0000'
                - '#ffff00'
                - '#00ff00'
              gradient: true
          - chart_type: line
            period: month
            type: statistics-graph
            entities:
              - sensor.electricity_price_immenhook_15
            stat_types:
              - mean
            days_to_show: 365
            logarithmic_scale: false
          - chart_type: bar
            period: month
            type: statistics-graph
            entities:
              - sensor.tibber_summe_jahr
            stat_types:
              - sum
            days_to_show: 365
            logarithmic_scale: false
      - type: grid
        cards:
          - type: heading
            heading: Solarproduktion
          - type: horizontal-stack
            cards:
              - type: gauge
                entity: sensor.solar_gesamtleistung_0
                max: 880
                name: Solarproduktion
                needle: true
                severity:
                  green: 400
                  yellow: 100
                  red: 0
              - type: gauge
                entity: sensor.balkonkraftwerk_tag
                needle: true
                max: 5
                severity:
                  green: 3
                  yellow: 1
                  red: 0
                name: Produktion heute
          - type: horizontal-stack
            cards:
              - type: gauge
                entity: sensor.solarleistung_modul_1_0
                needle: false
                max: 440
                name: Solarmodul 1
              - type: gauge
                entity: sensor.solarleistung_modul_2_0
                needle: false
                max: 440
                name: Solarmodul 2
          - type: horizontal-stack
            cards:
              - type: gauge
                entity: sensor.solarproduktion_modul_1_tag
                needle: true
                name: Solarmodul 1
                severity:
                  green: 2
                  yellow: 1
                  red: 0
                max: 3
              - type: gauge
                entity: sensor.solarproduktion_modul_2_tag
                needle: true
                name: Solarmodul 2
                severity:
                  green: 2
                  yellow: 1
                  red: 0
                max: 3
          - type: custom:power-flow-card-plus
            title: Energiefluss
            clickable_entities: true
            use_new_flow_rate_model: true
            w_decimals: 0
            kw_decimals: 1
            watt_threshold: 1000
            min_flow_rate: 0.75
            max_flow_rate: 6
            min_expected_power: 0.01
            max_expected_power: 2000
            display_zero_lines:
              mode: show
              transparency: 50
              grey_color:
                - 189
                - 189
                - 189
            transparency_zero_lines: 0
            entities:
              battery:
                entity: ''
                state_of_charge: sensor.mi_pad_5_battery_level
              solar:
                entity: sensor.solar_gesamtleistung
                display_zero_state: true
                color_value: true
                color_icon: true
                secondary_info:
                  entity: sensor.solar_produktion_von_heute
                  unit_of_measurement: kWh
                  unit_white_space: true
              grid:
                entity:
                  consumption: sensor.stromverbrauch_differenz
                  production: sensor.einspeisung
                color_value: false
                secondary_info:
                  entity: sensor.einspeisung_kwh_tag
                  unit_of_measurement: kWh
                  unit_white_space: true
              home:
                subtract_individual: false
                secondary_info:
                  entity: sensor.stromverbrauch_kwh_monatlich
                  unit_of_measurement: kWh
                  unit_white_space: true
            card_mod:
              style: |
                ha-card {
                  border-radius: var(--border-radius, 12px);
                  background: var(--card-background-color, var(--primary-background-color));
                  padding: 16px;
                }

                /* Weiße Schrift für alle Textelemente */
                .power-flow-card-plus {
                  color: #fff !important;
                }
                .power-flow-card-plus__title,
                .power-flow-card-plus__value,
                .power-flow-card-plus__label,
                .power-flow-card-plus__secondary {
                  color: #fff !important;
                }

                /* Bessere Lesbarkeit der Flusslinien */
                .power-flow-card-plus__flow-line {
                  filter: drop-shadow(0 0 2px rgba(255,255,255,0.1));
                }

                /* Hover-Effekte für klickbare Elemente */
                .power-flow-card-plus__entity {
                  transition: transform 0.2s ease-in-out;
                }
                .power-flow-card-plus__entity:hover {
                  transform: scale(1.02);
                }
          - type: entity
            entity: sensor.solar_gesamterzeugung_uber_lebensdauer
            name: Gesamtproduktion
            icon: mdi:solar-panel
            state_color: false
            layout_options:
              grid_columns: 4
              grid_rows: 2
          - type: custom:auto-entities
            card:
              type: entities
              title: Statistik
            filter:
              include:
                - name: Solarproduktion*
              exclude: []
            sort:
              method: domain
              numeric: false
              ignore_case: false
          - type: custom:auto-entities
            card:
              type: entities
            filter:
              include:
                - name: Verbrauch - Produktion *
              exclude: []
            sort:
              method: state
              numeric: true
      - type: grid
        cards:
          - type: heading
            heading: Verbaucherdetails
          - type: custom:auto-entities
            card:
              type: entities
              title: Aktuell
              state_color: false
              show_header_toggle: false
            entities:
              - entity: sensor.pc_daniel_power
                name: PC-Daniel
              - entity: sensor.pc_nick_power
                name: PC-Nick
              - entity: sensor.pc_phil_power
                name: PC-Phil
              - entity: sensor.nas_ha_laptop_power
                name: NAS & HA & Laptop
              - entity: sensor.spulmaschine_power
                name: Spülmaschine
              - entity: sensor.trockner_power
                name: Trockner
              - entity: sensor.waschmaschine_power
              - entity: sensor.backofen_power
                name: Backofen
              - entity: sensor.kuhlschrank_power
                name: Kühlschrank
              - entity: sensor.kuhlschrank_schuppen_power
                name: Kühlschrank Schuppen
              - entity: sensor.tv_schlafzimmer_power
                name: TV-Schlafzimmer
              - entity: sensor.router_tv_wohnzimmer_power
                name: TV-Wohnzimmer
              - entity: sensor.autoladegerat_leistung
                name: Autoladegerät
              - entity: sensor.tv_konsolen_nick_power
                name: TV & Konsolen Nick
              - entity: sensor.gefriertruhe_power
                name: Gefriertruhe
              - entity: sensor.tv_phil_power
                name: TV-Phil
              - entity: sensor.kaffeevollautomat_power
                name: Kaffeevollautomat
              - entity: sensor.kuchenmaschine_power
                name: Küchenmaschine
              - entity: sensor.salzlampe_power
                name: WZ-Salzlampe
              - entity: sensor.gartenbeleuchtung_power
                name: Gartenbeleuchtung
            title: Stromnutzung
            state_color: false
            sort:
              method: state
              reverse: true
              numeric: true
            show_empty: true
          - type: custom:auto-entities
            card:
              type: entities
              title: Tag
            entities:
              - entity: sensor.pc_daniel_taglich
                name: PC-Daniel
              - entity: sensor.pc_nick_taglich
                name: PC-Nick
              - entity: sensor.pc_phil_taglich
                name: PC-Phil
              - entity: sensor.nas_ha_laptop_taglich
                name: NAS & HA & Laptop
              - entity: sensor.spulmaschine_taglich
                name: Spülmaschine
              - entity: sensor.trockner_taglich
                name: Trockner
              - entity: sensor.waschmaschine_taglich
                name: Waschmaschine
              - entity: sensor.backofen_taglich
                name: Backofen
              - entity: sensor.kuhlschrank_taglich
                name: Kühlschrank
              - entity: sensor.kuhlschrank_schuppen_taglich
                name: Schuppen
              - entity: sensor.tv_schlafzimmer_taglich
                name: TV-Schlafzimmer
              - entity: sensor.tv_wohnzimmer_router_taglich
                name: TV-Wohnzimmer
              - entity: sensor.kia_ceed_sw_stromverbrauch_taglich
                name: Autoladegerät
              - entity: sensor.tv_konsolen_nick_taglich
                name: TV- & Konsolen Nick
              - entity: sensor.gefriertruhe_taglich
                name: Gefriertruhe
              - entity: sensor.tv_phil_taglich
                name: TV-Phil
              - entity: sensor.kaffeevollautomat_taglich
                name: Kaffeevollautomat
            title: Stromnutzung
            state_color: false
            sort:
              method: state
              reverse: true
              numeric: true
          - type: custom:auto-entities
            card:
              type: entities
              title: Woche
            entities:
              - entity: sensor.pc_daniel_wochentlich
                name: PC-Daniel
              - entity: sensor.pc_nick_wochentlich
                name: PC-Nick
              - entity: sensor.pc_phil_wochentlich
                name: PC-Phil
              - entity: sensor.nas_ha_laptop_wochentlich
                name: NAS & HA & Laptop
              - entity: sensor.spulmaschine_wochentlich
                name: Spülmaschine
              - entity: sensor.trockner_wochentlich
                name: Trockner
              - entity: sensor.waschmaschine_wochentlich
                name: Waschmaschine
              - entity: sensor.backofen_wochentlich
                name: Backofen
              - entity: sensor.kuhlschrank_wochentlich
                name: Kühlschrank
              - entity: sensor.kuhlschrank_schuppen_wochentlich
                name: Schuppen
              - entity: sensor.tv_schlafzimmer_wochentlich
                name: TV-Schlafzimmer
              - entity: sensor.tv_wohnzimmer_router_wochentlich
                name: TV-Wohnzimmer
              - entity: sensor.kia_ceed_sw_stromverbrauch_wochentlich
                name: Autoladegerät
              - entity: sensor.gefriertruhe_wochentlich
                name: Gefriertruhe
              - entity: sensor.tv_phil_wochentlich
                name: TV-Phil
              - entity: sensor.kaffeevollautomat_wochentlich
                name: Kaffeevollautomat
              - entity: sensor.kuchenmaschine_wochentlich
                name: Küchenmaschine
              - entity: sensor.gartenbeleuchtung_wochentlich
                name: Gartenbeleuchtung
              - entity: sensor.wohnzimmer_salzlampe_wochentlich
                name: Wohnzimmer-Salzlampe
            title: Stromnutzung
            state_color: false
            sort:
              method: state
              reverse: true
              numeric: true
          - type: custom:auto-entities
            card:
              type: entities
              title: Monat
            entities:
              - entity: sensor.pc_daniel_monatlich
                name: PC-Daniel
              - entity: sensor.pc_nick_monatlich
                icon: mdi:desktop-tower-monitor
                name: PC-Nick
              - entity: sensor.pc_phil_monatlich
                name: PC-Phil
              - entity: sensor.nas_ha_laptop_monatlich
                name: NAS & HA & Laptop
              - entity: sensor.spulmaschine_monatlich
                name: Spülmaschine
              - entity: sensor.trockner_monatlich
                name: Trockner
              - entity: sensor.waschmaschine_monatlich
                name: Waschmaschine
              - entity: sensor.backofen_monatlich
                name: Backofen
              - entity: sensor.kuhlschrank_monatlich
                name: Kühlschrank
              - entity: sensor.kuhlschrank_schuppen_monatlich
                name: Schuppen
              - entity: sensor.tv_schlafzimmer_monatlich
                name: TV-Schlafzimmer
              - entity: sensor.tv_wohnzimmer_router_monatlich
                name: TV-Wohnzimmer
              - entity: sensor.kia_ceed_sw_stromverbrauch_monatlich
                name: Autoladegerät
              - entity: sensor.tv_konsolen_nick_monatlich
                name: TV- & Konsolen Nick
              - entity: sensor.gefriertruhe_monatlich
                name: Gefriertruhe
              - entity: sensor.tv_phil_monatlich
                name: TV-Pil
              - entity: sensor.kaffeevollautomat_monatlich
                name: Kaffeevollautomat
            title: Stromnutzung
            state_color: false
            sort:
              method: state
              reverse: true
              numeric: true
          - type: custom:auto-entities
            card:
              type: entities
              title: Jahr
            entities:
              - entity: sensor.pc_daniel_jahrlich
                name: PC-Daniel
              - entity: sensor.pc_nick_jahrlich
                name: PC-Nick
              - entity: sensor.pc_phil_jahrlich
                name: PC-Phil
              - entity: sensor.nas_ha_laptop_jahrlich
                name: NAS & HA & Laptop
              - entity: sensor.spulmaschine_jahrlich
                name: Spülmaschine
              - entity: sensor.trockner_jahrlich
                name: Trockner
              - entity: sensor.waschmaschine_jahr
                name: Waschmaschine
              - entity: sensor.backofen_jahrlich
                name: Backofen
              - entity: sensor.kuhlschrank_jahrlich
                name: Kühlschrank
              - entity: sensor.kuhlschrank_schuppen_jahrlich
                name: Schuppen
              - entity: sensor.tv_schlafzimmer_jahrlich
                name: TV-Schlafzimmer
              - entity: sensor.tv_wohnzimmer_router_jahrlich
                name: TV-Wohnzimmer
              - entity: sensor.kia_ceed_sw_stromverbrauch_jahrlich
                name: Autoladegerät
              - entity: sensor.tv_konsolen_nick_jahrlich
                name: TV- & Konsolen Nick
              - entity: sensor.gefriertruhe_jahrlich
                name: Gefriertruhe
              - entity: sensor.tv_phil_jahrlich
                name: TV-Phil
              - entity: sensor.kaffeevollautomat_jahrlich
                name: Kaffeevollautomat
              - entity: sensor.kuchenmaschine_jahrlich
                name: Küchenmaschine
              - entity: sensor.gartenbeleuchtung_jahrlich
                name: Gartenbeleuchtung
              - entity: sensor.wohnzimmer_salzlampe_jahrlich
                name: Wohnzimmer-Salzlampe
            title: Stromnutzung
            state_color: false
            sort:
              method: state
              reverse: true
              numeric: true
          - type: custom:auto-entities
            filter:
              include:
                - entity_id: '*stromkosten*monat*'
              exclude:
                - entity_id: input_number.stromkosten_tag
            sort:
              method: state
              numeric: true
              reverse: true
              ignore_case: false
            show_empty: false
            card:
              type: entities
              title: Stromkosten Monat
              state_color: false
          - type: custom:auto-entities
            filter:
              include:
                - entity_id: '*stromkosten*jahr*'
              exclude:
                - entity_id: input_number.stromkosten_tag
            sort:
              method: state
              numeric: true
              reverse: true
              ignore_case: false
            show_empty: false
            card:
              type: entities
              title: Stromkosten Jahr
              state_color: false
      - type: grid
        cards:
          - type: heading
            heading: Einzelstatistiken Geräte
          - type: custom:mini-graph-card
            hour24: true
            entities:
              - entity: sensor.autoladegerat_leistung
              - entity: sensor.kia_ceed_sw_stromverbrauch_taglich
                show_state: true
                show_graph: false
            show:
              extrema: true
              legend: false
              average: true
              fill: fade
            name: Autoladegerät
            line_width: 2
            lower_bound: 0
            min_bound_range: 100
            points_per_hour: 10
          - type: custom:mini-graph-card
            hour24: true
            entities:
              - entity: sensor.waschmaschine_power
              - entity: sensor.waschmaschine_taglich
                show_state: true
                show_graph: false
            icon: mdi:washing-machine
            show:
              extrema: true
              legend: false
              average: true
              fill: fade
            name: Waschmaschine
            line_width: 2
            lower_bound: 0
            min_bound_range: 100
            points_per_hour: 10
          - type: custom:mini-graph-card
            hour24: true
            entities:
              - entity: sensor.trockner_power
              - entity: sensor.trockner_taglich
                show_state: true
                show_graph: false
            icon: mdi:tumble-dryer
            show:
              extrema: true
              legend: false
              average: true
              fill: fade
            name: Trockner
            line_width: 2
            lower_bound: 0
            min_bound_range: 100
            points_per_hour: 10
          - type: custom:mini-graph-card
            hour24: true
            entities:
              - entity: sensor.backofen_power
              - entity: sensor.backofen_taglich
                show_state: true
                show_graph: false
            icon: mdi:stove
            show:
              extrema: true
              legend: false
              average: true
              fill: fade
            name: Backofen
            line_width: 2
            lower_bound: 0
            min_bound_range: 100
            points_per_hour: 10
          - type: custom:mini-graph-card
            hour24: true
            entities:
              - entity: sensor.spulmaschine_power
              - entity: sensor.spulmaschine_taglich
                show_state: true
                show_graph: false
            icon: mdi:dishwasher
            show:
              extrema: true
              legend: false
              average: true
              fill: fade
            name: Spülmaschine
            line_width: 2
            lower_bound: 0
            min_bound_range: 100
            points_per_hour: 10
          - type: custom:mini-graph-card
            hour24: true
            entities:
              - entity: sensor.nas_ha_laptop_power
              - entity: sensor.nas_ha_laptop_taglich
                show_state: true
                show_graph: false
            icon: mdi:server
            show:
              extrema: true
              legend: false
              average: true
              fill: fade
            name: NAS & Laptop & HA
            line_width: 2
            lower_bound: 0
            min_bound_range: 100
            points_per_hour: 10
            hours_to_show: 12
          - type: custom:mini-graph-card
            hour24: true
            entities:
              - entity: sensor.pc_daniel_power
              - entity: sensor.pc_daniel_taglich
                show_state: true
                show_graph: false
            icon: mdi:desktop-tower-monitor
            show:
              extrema: true
              legend: false
              average: true
              fill: fade
            name: PC Daniel
            line_width: 2
            lower_bound: 0
            min_bound_range: 100
            points_per_hour: 10
            hours_to_show: 12
          - type: custom:mini-graph-card
            hour24: true
            entities:
              - entity: sensor.pc_phil_power
              - entity: sensor.pc_phil_taglich
                show_state: true
                show_graph: false
            icon: mdi:desktop-tower-monitor
            show:
              extrema: true
              legend: false
              average: true
              fill: fade
            name: PC Phil
            line_width: 2
            lower_bound: 0
            min_bound_range: 100
            points_per_hour: 10
          - type: custom:mini-graph-card
            hour24: true
            entities:
              - entity: sensor.pc_nick_power
              - entity: sensor.pc_nick_taglich
                show_state: true
                show_graph: false
            icon: mdi:desktop-tower-monitor
            show:
              extrema: true
              legend: false
              average: true
              fill: fade
            name: PC Nick
            line_width: 2
            lower_bound: 0
            min_bound_range: 100
            points_per_hour: 10
            hours_to_show: 12
          - type: custom:mini-graph-card
            hour24: true
            entities:
              - entity: sensor.kaffeevollautomat_power
              - entity: sensor.kaffeevollautomat_taglich
                show_state: true
                show_graph: false
            icon: mdi:server
            show:
              extrema: true
              legend: false
              average: true
              fill: fade
            name: Kaffeevollautomat
            line_width: 2
            lower_bound: 0
            min_bound_range: 100
            points_per_hour: 10
            hours_to_show: 12
          - type: custom:mini-graph-card
            hour24: true
            entities:
              - entity: sensor.gefriertruhe_power
              - entity: sensor.gefriertruhe_taglich
                show_state: true
                show_graph: false
            show:
              extrema: true
              legend: false
              average: true
              fill: fade
            name: Gefrierschrank
            line_width: 2
            lower_bound: 0
            min_bound_range: 100
            points_per_hour: 10
          - type: custom:mini-graph-card
            hour24: true
            entities:
              - entity: sensor.kuhlschrank_power
              - entity: sensor.kuhlschrank_taglich
                show_state: true
                show_graph: false
            show:
              extrema: true
              legend: false
              average: true
              fill: fade
            name: Kühlschrank
            line_width: 2
            lower_bound: 0
            min_bound_range: 100
            points_per_hour: 10
    cards: []
  - title: Solar
    path: solar
    icon: mdi:solar-power-variant
    type: sections
    sections:
      - type: grid
        cards:
          - type: horizontal-stack
            cards:
              - type: gauge
                entity: sensor.gesamtleistung
                severity:
                  green: 0
                  yellow: 2000
                  red: 4000
                max: 5000
                name: Stromverbrauch aktuell
                needle: true
              - type: gauge
                entity: sensor.solar_gesamtleistung
                max: 880
                name: Solarproduktion aktuell
                needle: true
                severity:
                  green: 400
                  yellow: 100
                  red: 0
          - type: horizontal-stack
            cards:
              - type: gauge
                entity: sensor.stromverbrauch_solarproduktion_diff_kwh
                needle: false
                name: Strombezug heute
                max: 25
              - type: gauge
                entity: sensor.solar_produktion_von_heute
                needle: true
                max: 6
                severity:
                  green: 3
                  yellow: 1
                  red: 0
                name: Produktion heute
          - type: horizontal-stack
            cards:
              - type: gauge
                entity: sensor.solarleistung_modul_1_0
                needle: false
                max: 440
                name: Solarmodul 1
              - type: gauge
                entity: sensor.solarleistung_modul_2_0
                needle: false
                max: 440
                name: Solarmodul 2
          - type: horizontal-stack
            cards:
              - type: gauge
                entity: sensor.solar_produktion_von_heute_ab_p1
                needle: true
                max: 5
                severity:
                  green: 1.5
                  yellow: 0.5
                  red: 0
                name: Modul 1 heute
              - type: gauge
                entity: sensor.solar_produktion_von_heute_ab_p2
                needle: true
                max: 5
                severity:
                  green: 1.5
                  yellow: 0.5
                  red: 0
                name: Modul 2 heute
          - type: horizontal-stack
            cards:
              - type: gauge
                entity: sensor.solarproduktion_modul_1_monat
                needle: false
                name: M1 Monat
                max: 50
              - type: gauge
                entity: sensor.solarproduktion_modul_2_monat
                needle: false
                max: 50
                name: M2 Monat
          - type: horizontal-stack
            cards:
              - type: entity
                entity: sensor.balkonsolar_vorteil
                name: Vorteil Tag
              - type: entity
                entity: input_number.balkonkraftwerk_amortisierung
                name: BKW Armotisierung
          - type: horizontal-stack
            cards:
              - type: entity
                entity: sensor.balkonsolar_vorteil_monat
                name: Vorteil Monat
              - type: entity
                entity: sensor.balkonsolar_vorteil_jahr
                name: Vorteil Jahr
          - type: energy-solar-graph
            title: Solarproduktion
            card_mod:
              style: |
                ha-card {
                  border-radius: var(--border-radius, 12px);
                  background: var(--card-background-color, var(--primary-background-color));
                  color: var(--primary-text-color);
                  padding: 8px;
                }
          - type: custom:apexcharts-card
            header:
              show: true
              show_states: true
              colorize_states: true
              title: Produktion vs Verbrauch
            apex_config:
              chart:
                stacked: true
                background: transparent
                foreColor: var(--primary-text-color)
                toolbar:
                  show: true
                animations:
                  enabled: true
                  easing: easeinout
            graph_span: 30d
            span:
              end: day
            show:
              last_updated: true
            series:
              - entity: sensor.solar_produktion_von_heute
                name: Produktion
                type: column
                group_by:
                  func: max
                  duration: 24h
                color: '#4CAF50'
              - entity: sensor.stromverbrauch_kwh_taglich
                name: Verbrauch
                type: column
                group_by:
                  func: max
                  duration: 24h
                color: '#FF9800'
            card_mod:
              style: |
                ha-card {
                  border-radius: var(--border-radius, 12px);
                  background: var(--card-background-color, var(--primary-background-color));
                  color: var(--primary-text-color);
                  padding: 16px;
                }
                .apexcharts-text {
                  fill: var(--primary-text-color) !important;
                }
                .apexcharts-legend-text {
                  color: var(--primary-text-color) !important;
                }
                .apexcharts-gridline {
                  stroke: var(--divider-color, rgba(127,127,127,0.12));
                }
                .apexcharts-tooltip {
                  background: var(--card-background-color) !important;
                  color: var(--primary-text-color) !important;
                  border: 1px solid var(--divider-color) !important;
                }
          - type: custom:apexcharts-card
            header:
              show: true
              show_states: true
              colorize_states: true
              title: Solarproduktion 14-Tage
            apex_config:
              chart:
                stacked: true
                background: transparent
                foreColor: var(--primary-text-color)
                toolbar:
                  show: true
                animations:
                  enabled: true
                  easing: easeinout
            graph_span: 14d
            span:
              end: day
            show:
              last_updated: true
            series:
              - entity: sensor.solar_produktion_von_heute
                name: Produktion
                type: column
                color: orange
                group_by:
                  func: max
                  duration: 1d
            card_mod:
              style: |
                ha-card {
                  border-radius: var(--border-radius, 12px);
                  background: var(--card-background-color, var(--primary-background-color));
                  color: var(--primary-text-color);
                  padding: 16px;
                }
                .apexcharts-text {
                  fill: var(--primary-text-color) !important;
                }
                .apexcharts-legend-text {
                  color: var(--primary-text-color) !important;
                }
                .apexcharts-gridline {
                  stroke: var(--divider-color, rgba(127,127,127,0.12));
                }
                .apexcharts-tooltip {
                  background: var(--card-background-color) !important;
                  color: var(--primary-text-color) !important;
                  border: 1px solid var(--divider-color) !important;
                }
          - type: custom:apexcharts-card
            header:
              show: true
              show_states: true
              colorize_states: true
              title: Solarproduktion Monat
            apex_config:
              chart:
                stacked: true
                background: transparent
                foreColor: var(--primary-text-color)
                toolbar:
                  show: true
                animations:
                  enabled: true
                  easing: easeinout
            graph_span: 30d
            span:
              end: day
            show:
              last_updated: true
            series:
              - entity: sensor.solar_produktion_von_heute
                name: Produktion
                type: column
                color: orange
                group_by:
                  func: max
                  duration: 1d
            card_mod:
              style: |
                ha-card {
                  border-radius: var(--border-radius, 12px);
                  background: var(--card-background-color, var(--primary-background-color));
                  color: var(--primary-text-color);
                  padding: 16px;
                }
                .apexcharts-text {
                  fill: var(--primary-text-color) !important;
                }
                .apexcharts-legend-text {
                  color: var(--primary-text-color) !important;
                }
                .apexcharts-gridline {
                  stroke: var(--divider-color, rgba(127,127,127,0.12));
                }
                .apexcharts-tooltip {
                  background: var(--card-background-color) !important;
                  color: var(--primary-text-color) !important;
                  border: 1px solid var(--divider-color) !important;
                }
          - type: custom:apexcharts-card
            header:
              show: true
              show_states: true
              colorize_states: true
              title: Solarproduktion vs Verbrauch (Tagesvergleich)
            apex_config:
              chart:
                stacked: false
                background: transparent
                foreColor: var(--primary-text-color)
                toolbar:
                  show: true
                animations:
                  enabled: true
                  easing: easeinout
            graph_span: 12month
            span:
              end: month
            series:
              - entity: sensor.solarproduktion_monat
                name: Produktion
                type: column
                color: '#4CAF50'
                group_by:
                  func: max
                  duration: 1month
              - entity: sensor.stromverbrauch_kwh_monatlich
                name: Verbrauch
                type: column
                color: '#FF9800'
                group_by:
                  func: max
                  duration: 1month
            card_mod:
              style: |
                ha-card {
                  border-radius: var(--border-radius, 12px);
                  background: var(--card-background-color, var(--primary-background-color));
                  color: var(--primary-text-color);
                  padding: 16px;
                }
          - type: horizontal-stack
            cards:
              - type: gauge
                entity: sensor.balkonkraftwerk_power
                max: 880
                name: BKW Leistung
                needle: true
                severity:
                  green: 400
                  yellow: 100
                  red: 0
              - type: gauge
                entity: sensor.balkonkraftwerk_tag
                needle: true
                max: 6
                severity:
                  green: 3
                  yellow: 1
                  red: 0
                name: BKW heute
          - type: horizontal-stack
            cards:
              - type: gauge
                entity: sensor.solar_gesamtleistung
                max: 880
                name: WR Leistung
                needle: true
                severity:
                  green: 400
                  yellow: 100
                  red: 0
              - type: gauge
                entity: sensor.solar_produktion_von_heute
                needle: true
                max: 6
                severity:
                  green: 3
                  yellow: 1
                  red: 0
                name: WR heute
          - chart_type: bar
            period: month
            type: statistics-graph
            entities:
              - sensor.balkonkraftwerk_monat
            stat_types:
              - sum
              - change
      - type: grid
        cards:
          - type: heading
            heading: ' '
          - type: weather-forecast
            entity: weather.lingen
            show_current: true
            show_forecast: true
            forecast_type: daily
            secondary_info_attribute: cloud_coverage
            card_mod:
              style: |
                ha-card {
                  border-radius: var(--border-radius, 12px);
                  background: var(--card-background-color, var(--primary-background-color));
                  color: var(--primary-text-color);
                  font-size: 18px;
                  padding: 8px;
                }
                .current, .forecast, .temp, .weather-icon, .secondary {
                  color: var(--primary-text-color) !important;
                  fill: var(--primary-text-color) !important;
                }
                .forecast {
                  justify-content: space-between;
                  padding: 0 8px;
                }
                .temp {
                  font-weight: 500;
                  margin: 4px 0;
                }
                .weather-icon {
                  height: 40px;
                  width: 40px;
                  margin: 4px 0;
                }
                .time {
                  font-size: 16px !important;
                  opacity: 0.9;
                }
          - type: horizontal-stack
            cards:
              - type: custom:compass-card
                indicator_sensors:
                  - sensor: sensor.windsensor_windwinkel
                value_sensors:
                  - sensor: sensor.windsensor_windgeschwindigkeit
                language: de
                header:
                  title:
                    value: Wind
                card_mod:
                  style: |
                    ha-card {
                      border-radius: var(--border-radius, 12px);
                      background: var(--card-background-color);
                      color: var(--primary-text-color);
                    }
                    .compass {
                      --compass-heading-color: var(--primary-text-color);
                      --compass-indicator-color: var(--accent-color);
                      --compass-value-color: var(--primary-text-color);
                    }
                    .header {
                      color: var(--primary-text-color);
                    }
              - type: custom:compass-card
                indicator_sensors:
                  - sensor: sensor.windsensor_boenwinkel
                value_sensors:
                  - sensor: sensor.windsensor_boenstarke
                language: de
                header:
                  title:
                    value: Böe
                card_mod:
                  style: |
                    ha-card {
                      border-radius: var(--border-radius, 12px);
                      background: var(--card-background-color);
                      color: var(--primary-text-color);
                    }
                    .compass {
                      --compass-heading-color: var(--primary-text-color);
                      --compass-indicator-color: var(--accent-color);
                      --compass-value-color: var(--primary-text-color);
                    }
                    .header {
                      color: var(--primary-text-color);
                    }
          - type: custom:power-flow-card-plus
            title: Energiefluss
            entities:
              battery:
                entity: ''
                state_of_charge: sensor.mi_pad_5_battery_level
              solar:
                entity: sensor.solar_gesamtleistung
                display_zero_state: true
                color_value: true
                color_icon: true
              grid:
                entity:
                  consumption: sensor.stromverbrauch_differenz
                  production: sensor.einspeisung
                color_value: false
                secondary_info:
                  entity: sensor.einspeisung_kwh_tag
                  unit_of_measurement: kWh
                  unit_white_space: true
              home:
                subtract_individual: false
            clickable_entities: true
            use_new_flow_rate_model: true
            w_decimals: 0
            kw_decimals: 1
            min_flow_rate: 0.75
            max_flow_rate: 6
            max_expected_power: 2000
            min_expected_power: 0.01
            watt_threshold: 1000
            display_zero_lines:
              mode: show
              transparency: 50
              grey_color:
                - 189
                - 189
                - 189
            transparency_zero_lines: 0
            card_mod:
              style: |
                ha-card {
                  border-radius: var(--border-radius, 12px);
                  background: var(--card-background-color, var(--primary-background-color));
                  color: var(--primary-text-color);
                  padding: 16px;
                }
                .power-flow-card-plus,
                .power-flow-card-plus__title,
                .power-flow-card-plus__value,
                .power-flow-card-plus__label,
                .power-flow-card-plus__secondary {
                  color: var(--primary-text-color) !important;
                }
                .power-flow-card-plus__flow-line {
                  filter: drop-shadow(0 0 2px rgba(0,0,0,0.08));
                }
                .power-flow-card-plus__entity {
                  transition: transform 0.2s;
                }
                .power-flow-card-plus__entity:hover {
                  transform: scale(1.03);
                  box-shadow: 0 2px 8px rgba(0,0,0,0.08);
                }
          - type: custom:auto-entities
            card:
              type: entities
              title: Statistik
              show_header_toggle: false
              state_color: true
            filter:
              include:
                - name: Solarproduktion*
              exclude: []
            sort:
              method: domain
              numeric: false
              ignore_case: false
            card_mod:
              style: |
                ha-card {
                  border-radius: var(--border-radius, 12px);
                  background: var(--card-background-color, var(--primary-background-color));
                  padding: 12px;
                  box-shadow: var(--ha-card-box-shadow, 0 2px 4px rgba(0,0,0,0.1));
                }

                /* Überschrift */
                .card-header {
                  color: var(--primary-text-color);
                  font-size: 1.2em;
                  font-weight: 500;
                  padding: 8px 16px;
                }

                /* Einträge */
                .entities {
                  padding: 0.5rem;
                }

                /* Einzelne Zeilen */
                .entity-row {
                  padding: 8px 16px;
                  border-radius: 8px;
                  margin: 4px 0;
                  transition: background-color 0.2s;
                }
                .entity-row:hover {
                  background: var(--secondary-background-color);
                }

                /* Namen und Werte */
                .entity-row .name {
                  color: var(--primary-text-color);
                  font-weight: 400;
                }
                .entity-row .state {
                  color: var(--primary-text-color);
                  font-weight: 500;
                }

                /* Icons */
                .entity-row ha-icon {
                  color: var(--primary-color);
                }
          - type: custom:auto-entities
            card:
              type: entities
            filter:
              include:
                - name: Verbrauch - Produktion *
              exclude: []
            sort:
              method: state
              numeric: true
          - type: custom:auto-entities
            card:
              type: entities
              title: Balkonkraftwerk Stecker
            filter:
              include:
                - name: Balkonkraftwerk - *
                - name: Balkonkraftwerk Leistung
                - name: Balkonkraftwerk Energie
              exclude: []
  - title: Wetter
    path: wetter
    icon: mdi:weather-partly-cloudy
    type: sections
    sections:
      - type: grid
        cards:
          - type: heading
            heading: Sensoren
          - type: horizontal-stack
            cards:
              - type: custom:mini-graph-card
                name: Aussentemperatur
                entities:
                  - entity: sensor.netatmo_draussen_temperature
                points_per_hour: 2
                hours_to_show: 24
                hour24: true
                more_info: false
                show:
                  legend: false
                  extrema: true
                  average: true
                color_thresholds:
                  - value: 40
                    color: '#D11208'
                  - value: 30
                    color: '#EF6D4D'
                  - value: 20
                    color: '#FBCE17'
                  - value: 15
                    color: '#7BD71B'
                  - value: 10
                    color: '#B9F3C5'
                  - value: 0
                    color: '#BFDC94'
                  - value: -10
                    color: '#672BE1'
              - type: custom:mini-graph-card
                name: Feuchte Aussen
                entities:
                  - entity: sensor.netatmo_draussen_humidity
                points_per_hour: 2
                hours_to_show: 24
                hour24: true
                more_info: false
                show:
                  legend: false
                  extrema: true
                  average: true
                color_thresholds:
                  - value: 100
                    color: Red
                  - value: 65
                    color: Orange
                  - value: 0
                    color: Green
          - type: horizontal-stack
            cards:
              - type: custom:compass-card
                indicator_sensors:
                  - sensor: sensor.windsensor_windwinkel
                value_sensors:
                  - sensor: sensor.windsensor_windgeschwindigkeit
                language: de
                header:
                  title:
                    value: Wind
              - type: custom:compass-card
                indicator_sensors:
                  - sensor: sensor.windsensor_boenwinkel
                value_sensors:
                  - sensor: sensor.windsensor_boenstarke
                language: de
                header:
                  title:
                    value: Böe
          - type: horizontal-stack
            cards:
              - type: custom:mini-graph-card
                name: Wind
                entities:
                  - entity: sensor.windsensor_windgeschwindigkeit
                points_per_hour: 1
                hours_to_show: 24
                hour24: true
                more_info: false
                show:
                  legend: false
                  extrema: true
                  average: true
              - type: custom:mini-graph-card
                name: Windböe
                entities:
                  - entity: sensor.windsensor_boenstarke
                points_per_hour: 1
                hours_to_show: 24
                hour24: true
                more_info: false
                show:
                  legend: false
                  extrema: true
                  average: true
          - type: horizontal-stack
            cards:
              - type: statistic
                period:
                  calendar:
                    period: year
                stat_type: max
                entity: sensor.windsensor_windgeschwindigkeit
                name: Max. Windstärke
              - type: statistic
                entity: sensor.windsensor_boenstarke
                period:
                  calendar:
                    period: year
                stat_type: max
                name: Max. Windböe
                icon: mdi:windsock
          - type: custom:mini-graph-card
            name: Wind
            hours_to_show: 24
            points_per_hour: 1
            line_width: 2
            decimals: 1
            entities:
              - entity: sensor.windsensor_boenstarke
                name: Windböe
                show_state: true
                state_adaptive_color: true
              - entity: sensor.windsensor_windgeschwindigkeit
                name: Geschwindigkeit
                show_state: true
                state_adaptive_color: true
            show:
              labels: true
              icon: true
              state: true
              extrema: true
          - type: custom:apexcharts-card
            apex_config:
              chart:
                stacked: true
            graph_span: 7d
            span:
              end: day
            show:
              last_updated: true
            header:
              show: true
              show_states: true
              colorize_states: true
              title: Wind 7-Tage
            series:
              - entity: sensor.windsensor_windgeschwindigkeit
                name: Wind
                type: column
                color: orangered
                group_by:
                  func: max
                  duration: 1d
              - entity: sensor.windsensor_boenstarke
                name: Windböe
                type: column
                color: slateblue
                group_by:
                  func: max
                  duration: 1d
          - chart_type: line
            period: day
            type: statistics-graph
            entities:
              - sensor.windsensor_boenstarke
              - sensor.windsensor_windgeschwindigkeit
            stat_types:
              - max
            logarithmic_scale: false
            days_to_show: 10
            title: Windverlauf
          - show_name: true
            show_icon: true
            show_state: true
            type: glance
            entities:
              - entity: sensor.regen_niederschlag_taglich
                name: Tag
              - entity: sensor.regen_niederschlag_wochentlich
                name: Woche
              - entity: sensor.regen_niederschlag_monatlich
                name: Monat
              - entity: sensor.regen_niederschlag_jahrlich
                name: Jahr
            title: Regenmenge
          - type: custom:apexcharts-card
            experimental:
              color_threshold: true
            graph_span: 5d
            span:
              end: day
            show:
              last_updated: true
            header:
              show: true
              title: Regen 5-Tage
              show_states: true
              colorize_states: true
            yaxis:
              - min: 0
                max: ~25
                decimals: 0
                apex_config:
                  tickAmount: 5
            series:
              - entity: sensor.regensensor_niederschlag_heute
                show:
                  header_color_threshold: true
                  extremas: true
                type: column
                name: Menge
                group_by:
                  func: last
                  duration: 1d
          - type: custom:mini-graph-card
            name: Regensensor
            hours_to_show: 12
            points_per_hour: 4
            decimals: 1
            entities:
              - entity: sensor.regensensor_niederschlag
                name: Rain
                show_state: false
                state_adaptive_color: true
              - entity: sensor.regensensor_niederschlag_heute
                name: Rain
                show_state: true
                show_graph: false
                state_adaptive_color: true
            show:
              labels: true
              icon: false
              state: true
              graph: bar
          - type: custom:mini-graph-card
            name: Niederschlag
            hours_to_show: 24
            points_per_hour: 1
            line_width: 2
            decimals: 1
            entities:
              - entity: sensor.regensensor_niederschlag_heute
                name: Niederschlag
                show_state: true
                state_adaptive_color: true
            show:
              labels: true
              icon: true
              state: true
              extrema: true
          - chart_type: bar
            period: hour
            type: statistics-graph
            entities:
              - sensor.regensensor_niederschlag
            stat_types:
              - mean
            logarithmic_scale: false
            days_to_show: 1
            title: Niederschlag
            hide_legend: true
      - type: grid
        cards:
          - type: heading
            heading: Wetterdienste
          - type: custom:layout-card
            layout_type: custom:grid-layout
            cards:
              - type: custom:layout-card
                layout_type: custom:grid-layout
                layout:
                  margin: 0
                cards:
                  - type: custom:vertical-stack-in-card
                    cards:
                      - square: false
                        type: grid
                        cards:
                          - show_current: true
                            show_forecast: false
                            type: weather-forecast
                            entity: weather.lingen
                            name: Lingen
                            secondary_info_attribute: wind_speed
                            forecast_type: legacy
                          - type: custom:weather-chart-card
                            entity: weather.lingen
                            animated_icons: true
                            icon_style: style1
                            show_main: false
                            show_current_condition: true
                            show_attributes: false
                            show_time: false
                            show_day: false
                            show_date: false
                            show_humidity: true
                            show_pressure: true
                            show_wind_direction: true
                            show_wind_speed: true
                            show_sun: true
                            forecast:
                              labels_font_size: '11'
                              show_wind_forecast: true
                              condition_icons: true
                              round_temp: false
                              style: style2
                            title: ''
                            current_temp_size: '28'
                            icons: ''
                            units:
                              pressure: ''
                              speed: ''
                            temp: ''
                            press: ''
                            humid: ''
                            uv: ''
                            winddir: ''
                            windspeed: ''
                          - type: custom:more-info-card
                            entity: weather.lingen
                            title: []
                        columns: 1
            layout:
              margin: -1
            view_layout:
              grid-area: row1
          - type: custom:neerslag-card
            entity: sensor.neerslag_buienalarm_regen_data
            title: Niederschlag
          - type: custom:layout-card
            layout_type: custom:grid-layout
            layout:
              margin: 0
            cards:
              - type: custom:vertical-stack-in-card
                cards:
                  - type: entities
                    entities:
                      - type: custom:multiple-entity-row
                        entity: sensor.kreis_emsland_aktuelle_warnstufe
                        name: WARNUNG
                        toggle: false
                        state_color: true
                        show_state: true
                        secondary_info: ''
                        icon: mdi:exclamation-thick
                        entities:
                          - entity: sensor.kreis_emsland_aktuelle_warnstufe
                            attribute: warning_1_name
                            name: Warnung vor
                          - entity: sensor.kreis_emsland_aktuelle_warnstufe
                            attribute: warning_1_start
                            format: time
                            name: Von
                          - entity: sensor.kreis_emsland_aktuelle_warnstufe
                            attribute: warning_1_end
                            format: time
                            name: Bis
                        state_header: Anzahl Warnungen
                        column: true
                        card_mod:
                          style:
                            .: |
                              :host {
                                --paper-item-icon-color: red;
                                --mdc-icon-size: 40px;
                              }
              - type: markdown
                title: Wetterwarnungen
                content: >-
                  {% set current_count =
                  state_attr("sensor.kreis_emsland_aktuelle_warnstufe",
                  "warning_count") %} {% set advance_count =
                  state_attr("sensor.kreis_emsland_vorwarnstufe",
                  "warning_count") %}

                  {% if ((current_count == 0 or current_count == None) and
                  (advance_count == 0 or advance_count == None)) %}
                    **<font color=#44739e>Keine Warnungen</font>**
                  {% else %}
                    {% for i in range(current_count) %}
                      {% set headline = state_attr("sensor.kreis_emsland_aktuelle_warnstufe", "warning_" ~ loop.index ~ "_headline") %}
                      {% set description = state_attr("sensor.kreis_emsland_aktuelle_warnstufe", "warning_" ~ loop.index ~ "_description") %}
                      {% set time_start = state_attr("sensor.kreis_emsland_aktuelle_warnstufe", "warning_" ~ loop.index ~ "_start") | as_timestamp %}
                      {% set time_end = state_attr("sensor.kreis_emsland_aktuelle_warnstufe", "warning_" ~ loop.index ~ "_end") | as_timestamp %}
                  **<font color=#fdd835>{{ headline }}</font>**

                  *<font color=gray>{{ time_start | timestamp_custom("%a,
                  %H:%M") }} - {{ time_end | timestamp_custom("%a, %H:%M")
                  }}</font>* {{ description|trim }} {% if not loop.last %} ***
                  {% endif %}
                    {% endfor %}

                    {% for i in range(advance_count) %}
                      {% set headline = state_attr("sensor.kreis_emsland_vorwarnstufe", "warning_" ~ loop.index ~ "_headline") %}
                      {% set description = state_attr("sensor.kreis_emsland_vorwarnstufe", "warning_" ~ loop.index ~ "_description") %}
                      {% set time_start = state_attr("sensor.kreis_emsland_vorwarnstufe", "warning_" ~ loop.index ~ "_start") | as_timestamp %}
                      {% set time_end = state_attr("sensor.kreis_emsland_vorwarnstufe", "warning_" ~ loop.index ~ "_end") | as_timestamp %}
                  **<font color=#fdd835>{{ headline }}</font>**

                  *<font color=gray>{{ time_start | timestamp_custom("%a,
                  %H:%M") }} - {{ time_end | timestamp_custom("%a, %H:%M")
                  }}</font>* {{ description|trim }} {% if not loop.last %} ***
                  {% endif %}
                    {% endfor %}
                  {% endif %}
              - type: picture-glance
                camera_image: camera.warnkarte
                camera_view: auto
                entities: []
      - type: grid
        cards:
          - type: heading
            heading: Vorhersage
          - type: iframe
            url: >-
              https://radar.wo-cloud.com/mobile/embedded?wrx=52.528,7.327&wrm=8&wry=52.528,7.327
            aspect_ratio: 100%
          - type: conditional
            conditions:
              - entity: sensor.kreis_emsland_aktuelle_warnstufe
                state_not: '0'
            card:
              type: entities
              entities:
                - type: custom:multiple-entity-row
                  entity: sensor.kreis_emsland_aktuelle_warnstufe
                  name: WARNUNG
                  toggle: false
                  state_color: true
                  show_state: true
                  secondary_info: ''
                  icon: mdi:exclamation-thick
                  entities:
                    - entity: sensor.kreis_emsland_aktuelle_warnstufe
                      attribute: warning_1_name
                      name: Warnung vor
                    - entity: sensor.kreis_emsland_aktuelle_warnstufe
                      attribute: warning_1_start
                      format: time
                      name: Von
                    - entity: sensor.kreis_emsland_aktuelle_warnstufe
                      attribute: warning_1_end
                      format: time
                      name: Bis
                  state_header: Anzahl Warnungen
                  column: true
                  card_mod:
                    style:
                      .: |
                        :host {
                          --paper-item-icon-color: red;
                          --mdc-icon-size: 40px;
                        }
          - type: conditional
            conditions:
              - condition: state
                entity: sensor.kreis_emsland_aktuelle_warnstufe
                state_not: '0'
              - condition: state
                entity: sensor.kreis_emsland_vorwarnstufe
                state: '0'
            card:
              type: vertical-stack
              cards:
                - type: markdown
                  title: Wetterwarnungen
                  content: >-
                    {% set current_count =
                    state_attr("sensor.kreis_emsland_aktuelle_warnstufe",
                    "warning_count") %}

                    {% set advance_count =
                    state_attr("sensor.kreis_emsland_vorwarnstufe",
                    "warning_count") %}

                    {% if ((current_count == 0 or current_count == None) and
                    (advance_count == 0 or advance_count == None)) %}
                      **<font color=#44739e>Keine Warnungen</font>**
                    {% else %}
                      {% for i in range(current_count) %}
                        {% set headline = state_attr("sensor.kreis_emsland_aktuelle_warnstufe", "warning_" ~ loop.index ~ "_headline") %}
                        {% set description = state_attr("sensor.kreis_emsland_aktuelle_warnstufe", "warning_" ~ loop.index ~ "_description") %}
                        {% set level = state_attr("sensor.kreis_emsland_aktuelle_warnstufe", "warning_" ~ loop.index ~ "_level") %}
                        {% set time_start = state_attr("sensor.kreis_emsland_aktuelle_warnstufe", "warning_" ~ loop.index ~ "_start") | as_timestamp %}
                        {% set weekday_start = time_start | timestamp_custom("%w", True) | int %}
                        {% set time_end = state_attr("sensor.kreis_emsland_aktuelle_warnstufe", "warning_" ~ loop.index ~ "_end") | as_timestamp %}
                        {% set weekday_end = time_end | timestamp_custom("%w", True) | int %}
                    **<font color=#fdd835>{{ headline }}</font>**     

                    *<font color=gray>{{
                    ['Montag','Dienstag','Mittwoch','Donnerstag','Freitag','Samstag','Sonntag'][weekday_start-1]
                    ~ ", " ~ time_start | timestamp_custom("%H:%M") ~ " - " ~
                    ['Montag','Dienstag','Mittwoch','Donnerstag','Freitag','Samstag','Sonntag'][weekday_end-1]
                    ~ ", " ~ time_end | timestamp_custom("%H:%M") }}</font>*
                        {{ description|trim }}
                        {% if not loop.last %}
                    ***
                        {% endif %}
                      {% endfor %}
                      {% if ((current_count != 0) and (advance_count != 0)) %}{% endif %}
                      {% for i in range(advance_count) %}
                        {% set headline = state_attr("sensor.kreis_emsland_vorwarnstufe", "warning_" ~ loop.index ~ "_headline") %}
                        {% set description = state_attr("sensor.kreis_emsland_vorwarnstufe", "warning_" ~ loop.index ~ "_description") %}
                        {% set level = state_attr("sensor.kreis_emsland_vorwarnstufe", "warning_" ~ loop.index ~ "_level") %}
                        {% set time_start = state_attr("sensor.kreis_emsland_vorwarnstufe", "warning_" ~ loop.index ~ "_start") | as_timestamp%}
                        {% set weekday_start = time_start | timestamp_custom("%w", True) | int %}
                        {% set time_end = state_attr("sensor.kreis_emsland_vorwarnstufe", "warning_" ~ loop.index ~ "_end") | as_timestamp %}
                        {% set weekday_end = time_end | timestamp_custom("%w", True) | int %}
                    **<font color=#fdd835>{{ headline }}</font>**

                    *<font color=gray>{{
                    ['Montag','Dienstag','Mittwoch','Donnerstag','Freitag','Samstag','Sonntag'][weekday_start-1]
                    ~ ", " ~ time_start | timestamp_custom("%H:%M") ~ " - " ~
                    ['Montag','Dienstag','Mittwoch','Donnerstag','Freitag','Samstag','Sonntag'][weekday_end-1]
                    ~ ", " ~ time_end | timestamp_custom("%H:%M") }}</font>*
                        {{ description|trim }}
                        {% if not loop.last %}
                    ***
                        {% endif %}
                      {% endfor %}
                    {% endif %} 
                - camera_view: auto
                  type: picture-glance
                  entities: []
                  camera_image: camera.warnkarte
          - type: custom:hourly-weather
            entity: weather.lingen
            num_segments: '11'
            show_wind: speed
            name: Prognose
            show_precipitation_amounts: true
            show_precipitation_probability: false
            icons: true
            label_spacing: '2'
            offset: '0'
          - type: entities
            entities:
              - entity: sensor.rrraintext
              - entity: sensor.rrrainin30min
              - entity: sensor.rrrainin60min
              - entity: sensor.rrrainin120min
            title: Regenradar Lingen
          - type: entities
            entities:
              - entity: sun.sun
              - entity: sensor.sun_next_dusk
                name: Nächste Abenddämmerung
              - entity: sensor.sun_next_midnight
                name: Nächste Mitternacht
              - entity: sensor.sun_next_dawn
                name: Nächste Morgendämmerung
              - entity: sensor.sun_next_noon
                name: Nächsten Mittag
              - entity: sensor.sun_next_rising
                name: Nächster Sonnenaufgang
              - entity: sensor.sun_next_setting
                name: Nächster Sonnenuntergang
            title: Sun
          - type: custom:horizon-card
            moon: true
            refresh_period: 60
            fields:
              sunrise: true
              sunset: true
              dawn: true
              noon: true
              dusk: true
              azimuth: true
              sun_azimuth: true
              moon_azimuth: true
              elevation: true
              sun_elevation: true
              moon_elevation: true
              moonrise: true
              moonset: true
              moon_phase: true
            southern_flip: false
            moon_phase_rotation: -10
            language: de
            time_format: language
            number_format: language
            latitude: 52.56571
            longitude: 7.29161
            elevation: 21
            time_zone: Europe/Berlin
            debug_level: 0
    max_columns: 4
    cards: []
  - title: Geräte
    path: geraete
    icon: mdi:washing-machine
    type: sections
    sections:
      - type: grid
        cards:
          - type: heading
            heading: Waschmaschine
          - type: custom:button-card
            entity: sensor.waschmaschine_status
            name: Waschmaschine
            icon: mdi:washing-machine
            show_state: false
            show_label: false
            custom_fields:
              status: |
                [[[
                  const laufend = states['input_boolean.waschmaschine_lauft']?.state === 'on';
                  const fertig = states['input_boolean.waschmaschine_fertig']?.state === 'on';
                  
                  const getDuration = (datetimeEntityId) => {
                    const dateStr = states[datetimeEntityId]?.state;
                    if (!dateStr) return null;
                    const startTime = new Date(dateStr);
                    const now = new Date();
                    const diffMs = now - startTime;
                    const totalMin = Math.floor(diffMs / 60000);
                    const hours = Math.floor(totalMin / 60);
                    const minutes = totalMin % 60;
                    let result = '';
                    if (hours > 0) result += `${hours} Std. `;
                    if (minutes > 0 || hours === 0) result += `${minutes} Min`;
                    return result.trim();
                  };

                  if (laufend) {
                    const seit = getDuration('input_datetime.waschmaschine_startzeit');
                    return seit ? `🌀 Läuft seit ${seit}` : '🌀 Läuft';
                  }

                  if (fertig) {
                    const seit = getDuration('input_datetime.waschmaschine_fertig');
                    return seit ? `✅ Fertig seit ${seit}` : '✅ Fertig';
                  }

                  return '🛑 Aus';
                ]]]
              info: |
                [[[
                  const laufend = states['input_boolean.waschmaschine_lauft']?.state === 'on';
                  const fertig = states['input_boolean.waschmaschine_fertig']?.state === 'on';
                  const powerRaw = parseFloat(states['sensor.waschmaschine_power']?.state || '0');
                  const power = powerRaw > 0 ? ` · ⚡ ${powerRaw} W` : '';

                  if (laufend) {
                    const fortschritt = states['sensor.waschmaschine_fortschritt']?.state || '–';
                    const verbleibend = states['sensor.waschmaschine_verbleibend']?.state || '–';
                    return `<div style="margin-top: 10px;">${fortschritt}% · ⏳ ${verbleibend} Min${power}</div>`;
                  }

                  if (fertig) return `<div style="margin-top: 10px;">🧺 Wäsche fertig${power}</div>`;
                  return `<div style="margin-top: 10px;">☑️ Bereit${power}</div>`;
                ]]]
              progress: |
                [[[
                  const laufend = states['input_boolean.waschmaschine_lauft']?.state === 'on';
                  if (!laufend) return '';

                  const fortschritt = parseInt(states['sensor.waschmaschine_fortschritt']?.state || 0);
                  return `
                    <div style="background: rgba(255,255,255,0.25); height: 8px; border-radius: 4px; overflow: hidden; margin-top: 12px;">
                      <div style="width: ${fortschritt}%; background: #ffffff; height: 100%; transition: width 0.4s ease-in-out;"></div>
                    </div>
                  `;
                ]]]
              zaehler: |
                [[[
                  const starts = states['sensor.tageszahler_waschmaschine']?.state || '0';
                  const tag = states['sensor.waschmaschine_taglich']?.state || '–';
                  const monat = states['sensor.waschmaschine_monatlich']?.state || '–';
                  return `🔁 ${starts} · ${tag} kWh · ${monat} kWh`;
                ]]]
            styles:
              card:
                - height: 300px
                - border-radius: 18px
                - padding: 14px
                - background: |
                    [[[
                      if (states['input_boolean.waschmaschine_lauft']?.state === 'on')
                        return "linear-gradient(145deg, #2196f3, #1976d2)";
                      if (states['input_boolean.waschmaschine_fertig']?.state === 'on')
                        return "linear-gradient(145deg, #4caf50, #2e7d32)";
                      return "var(--card-background-color)";
                    ]]]
                - color: |
                    [[[
                      if (
                        states['input_boolean.waschmaschine_lauft']?.state === 'on' ||
                        states['input_boolean.waschmaschine_fertig']?.state === 'on'
                      ) return "white";
                      return "var(--primary-text-color)";
                    ]]]
                - box-shadow: 0 6px 14px rgba(0, 0, 0, 0.15)
                - transition: all 0.3s ease
              grid:
                - grid-template-areas: |
                    "i"
                    "n"
                    "status"
                    "info"
                    "progress"
                    "zaehler"
                - grid-template-rows: 1fr auto auto auto auto auto
                - grid-template-columns: 1fr
              name:
                - font-weight: 600
                - font-size: 1.3em
                - letter-spacing: 0.3px
              icon:
                - animation: |
                    [[[
                      if (states['input_boolean.waschmaschine_lauft']?.state === 'on')
                        return "pulse 2s infinite ease-in-out";
                      if (states['input_boolean.waschmaschine_fertig']?.state === 'on')
                        return "blink 1.2s infinite ease-in-out";
                      return "none";
                    ]]]
              custom_fields:
                status:
                  - text-align: center
                  - font-size: 1em
                  - font-weight: 500
                  - opacity: 0.9
                  - padding-top: 4px
                info:
                  - text-align: center
                  - font-size: 1em
                  - font-weight: 500
                  - opacity: 0.85
                progress:
                  - width: 100%
                zaehler:
                  - text-align: center
                  - font-size: 0.95em
                  - padding-top: 12px
                  - opacity: 0.75
            tap_action:
              action: fire-dom-event
              browser_mod:
                service: browser_mod.popup
                data:
                  title: Waschmaschine zurücksetzen?
                  size: normal
                  content:
                    type: vertical-stack
                    cards:
                      - type: markdown
                        content: >
                          {% if is_state('input_boolean.waschmaschine_fertig',
                          'on') %}
                            Möchtest du den Status **"Fertig"** der Waschmaschine zurücksetzen?
                          {% else %}
                            Waschmaschine ist aktuell **nicht fertig** – kein Zurücksetzen nötig.
                          {% endif %}
                      - type: conditional
                        conditions:
                          - entity: input_boolean.waschmaschine_fertig
                            state: 'on'
                        card:
                          type: horizontal-stack
                          cards:
                            - type: custom:button-card
                              name: ❌ Abbrechen
                              icon: mdi:close
                              tap_action:
                                action: fire-dom-event
                                browser_mod:
                                  service: browser_mod.close_popup
                              styles:
                                card:
                                  - border-radius: 12px
                                  - background: rgba(255, 255, 255, 0.1)
                                  - color: var(--primary-text-color)
                                  - box-shadow: none
                                  - padding: 12px
                                  - height: 50px
                            - type: custom:button-card
                              name: ✅ Zurücksetzen
                              icon: mdi:restart
                              tap_action:
                                action: fire-dom-event
                                browser_mod:
                                  service: browser_mod.sequence
                                  data:
                                    sequence:
                                      - service: input_boolean.turn_off
                                        data:
                                          entity_id: input_boolean.waschmaschine_fertig
                                      - service: browser_mod.close_popup
                              styles:
                                card:
                                  - border-radius: 12px
                                  - background: linear-gradient(145deg,
                                  - color: white
                                  - box-shadow: 0 4px 10px rgba(0,0,0,0.2)
                                  - padding: 12px
                                  - height: 50px
            extra_styles: |
              @keyframes blink {
                0% { opacity: 1; }
                50% { opacity: 0.4; }
                100% { opacity: 1; }
              }

              @keyframes pulse {
                0% { transform: scale(1); }
                50% { transform: scale(1.1); }
                100% { transform: scale(1); }
              }
          - type: custom:bar-card
            entities:
              - entity: sensor.waschmaschine_fortschritt
                name: Waschmaschine
                icon: mdi:washing-machine
                color: auto
                show_value: true
                show_icon: true
                show_name: true
                unit_of_measurement: '%'
                severity:
                  - from: 0
                    to: 30
                    color: '#3498db'
                  - from: 31
                    to: 70
                    color: '#f1c40f'
                  - from: 71
                    to: 100
                    color: '#2ecc71'
            height: 28px
            round: true
            icon_position: inside
            value_style: slider
            title_position: top
            width: 100%
            animation:
              state: 'on'
              speed: 1.5
            style: |
              ha-card {
                height: 300px;
                display: flex;
                flex-direction: column;
                justify-content: center;
                border-radius: 16px;
                padding: 12px;
                background: var(--card-background-color);
                box-shadow: 0 4px 14px rgba(0, 0, 0, 0.15);
              }

              .bar-card-name {
                font-weight: 600;
                font-size: 1em;
                padding-bottom: 4px;
              }

              .bar-card-value {
                font-weight: bold;
                font-size: 0.95em;
                color: #ffffff;
              }
          - type: horizontal-stack
            cards:
              - type: tile
                entity: sensor.tageszahler_waschmaschine
                vertical: false
                hide_state: false
                show_entity_picture: false
                name: Zähler
              - type: tile
                entity: sensor.waschmaschine_stoppuhr
                vertical: false
                name: Dauer
                hide_state: false
                icon: mdi:timer
          - square: false
            type: grid
            columns: 2
            cards:
              - type: markdown
                content: |
                  ### 🧺 Letzte Waschgänge
                  **1.** {{
                    as_timestamp(states('input_datetime.waschmaschine_fertig')) | timestamp_custom('%d.%m.%Y %H:%M')
                  }}

                  **2.** {{
                    as_timestamp(states('input_datetime.waschmaschine_fertig_2')) | timestamp_custom('%d.%m.%Y %H:%M')
                  }}

                  **3.** {{
                    as_timestamp(states('input_datetime.waschmaschine_fertig_3')) | timestamp_custom('%d.%m.%Y %H:%M')
                  }}
              - type: markdown
                content: >
                  ### ⏱️ Laufzeiten (Min.)

                  **1.** {{ states('input_number.waschmaschine_laufzeit_1') }}
                  min  


                  **2.** {{ states('input_number.waschmaschine_laufzeit_2') }}
                  min  


                  **3.** {{ states('input_number.waschmaschine_laufzeit_3') }}
                  min
          - type: horizontal-stack
            cards:
              - type: tile
                entity: input_datetime.waschmaschine_startzeit
                vertical: true
              - type: tile
                entity: input_datetime.waschmaschine_fertig
                vertical: true
          - type: horizontal-stack
            cards:
              - type: tile
                entity: sensor.waschmaschine_taglich
                vertical: true
                name: Stromverbrauch Tag
              - type: tile
                entity: sensor.waschmaschine_monatlich
                vertical: true
                name: Stromverbrauch Monat
          - type: horizontal-stack
            cards:
              - type: tile
                entity: sensor.stromkosten_waschmaschine_monat
                vertical: true
                name: Stromkosten Monat
              - type: tile
                entity: sensor.stromkosten_waschmaschine_jahr
                vertical: true
                name: Stromkosten Jahr
          - type: custom:apexcharts-card
            experimental:
              color_threshold: true
            graph_span: 5d
            span:
              end: day
            show:
              last_updated: true
            header:
              show: true
              title: Nutzung Waschmaschine
              show_states: true
              colorize_states: true
            yaxis:
              - min: 0
                max: ~5
                decimals: 0
                apex_config:
                  tickAmount: 5
            series:
              - entity: sensor.nutzung_waschmaschine
                show:
                  header_color_threshold: true
                  extremas: true
                  as_duration: hour
                type: column
                name: Dauer
                group_by:
                  func: last
                  duration: 1d
                color_threshold:
                  - value: 1
                    color: dodgerblue
                  - value: 2
                    color: darkcyan
                  - value: 3
                    color: orange
                  - value: 4
                    color: orangered
                  - value: 5
                    color: darkred
      - type: grid
        cards:
          - type: heading
            heading: Trockner
          - type: custom:button-card
            entity: sensor.trockner_status
            name: Trockner
            icon: mdi:tumble-dryer
            show_state: false
            show_label: false
            custom_fields:
              status: |
                [[[
                  const laufend = states['input_boolean.trockner_lauft']?.state === 'on';
                  const fertig = states['input_boolean.trockner_fertig']?.state === 'on';

                  const getDuration = (datetimeEntityId) => {
                    const dateStr = states[datetimeEntityId]?.state;
                    if (!dateStr) return null;
                    const startTime = new Date(dateStr);
                    const now = new Date();
                    const diffMs = now - startTime;
                    const totalMin = Math.floor(diffMs / 60000);
                    const hours = Math.floor(totalMin / 60);
                    const minutes = totalMin % 60;
                    let result = '';
                    if (hours > 0) result += `${hours} Std. `;
                    if (minutes > 0 || hours === 0) result += `${minutes} Min`;
                    return result.trim();
                  };

                  if (laufend) {
                    const seit = getDuration('input_datetime.trockner_startzeit');
                    return seit ? `🌀 Läuft seit ${seit}` : '🌀 Läuft';
                  }

                  if (fertig) {
                    const seit = getDuration('input_datetime.trockner_fertig');
                    return seit ? `✅ Fertig seit ${seit}` : '✅ Fertig';
                  }

                  return '🛑 Aus';
                ]]]
              info: |
                [[[
                  const laufend = states['input_boolean.trockner_lauft']?.state === 'on';
                  const fertig = states['input_boolean.trockner_fertig']?.state === 'on';
                  const powerRaw = parseFloat(states['sensor.trockner_power']?.state || '0');
                  const power = powerRaw > 0 ? ` · ⚡ ${powerRaw} W` : '';

                  if (laufend) {
                    const fortschritt = states['sensor.trockner_fortschritt']?.state || '–';
                    const verbleibend = states['sensor.trockner_verbleibend']?.state || '–';
                    return `<div style="margin-top: 10px;">${fortschritt}% · ⏳ ${verbleibend} Min${power}</div>`;
                  }

                  if (fertig) return `<div style="margin-top: 10px;">🧺 Trocken${power}</div>`;
                  return `<div style="margin-top: 10px;">☑️ Bereit${power}</div>`;
                ]]]
              progress: |
                [[[
                  const laufend = states['input_boolean.trockner_lauft']?.state === 'on';
                  if (!laufend) return '';

                  const fortschritt = parseInt(states['sensor.trockner_fortschritt']?.state || 0);
                  return `
                    <div style="background: rgba(255,255,255,0.25); height: 8px; border-radius: 4px; overflow: hidden; margin-top: 12px;">
                      <div style="width: ${fortschritt}%; background: #ffffff; height: 100%; transition: width 0.4s ease-in-out;"></div>
                    </div>
                  `;
                ]]]
              zaehler: |
                [[[
                  const starts = states['sensor.tageszahler_trockner']?.state || '0';
                  const tag = states['sensor.trockner_taglich']?.state || '–';
                  const monat = states['sensor.trockner_monatlich']?.state || '–';
                  return `🔁 ${starts} · ${tag} kWh · ${monat} kWh`;
                ]]]
            styles:
              card:
                - height: 300px
                - border-radius: 18px
                - padding: 14px
                - background: |
                    [[[
                      if (states['input_boolean.trockner_lauft']?.state === 'on')
                        return "linear-gradient(145deg, #ff9800, #f57c00)";
                      if (states['input_boolean.trockner_fertig']?.state === 'on')
                        return "linear-gradient(145deg, #4caf50, #2e7d32)";
                      return "var(--card-background-color)";
                    ]]]
                - color: |
                    [[[
                      if (
                        states['input_boolean.trockner_lauft']?.state === 'on' ||
                        states['input_boolean.trockner_fertig']?.state === 'on'
                      ) return "white";
                      return "var(--primary-text-color)";
                    ]]]
                - box-shadow: 0 6px 14px rgba(0, 0, 0, 0.15)
                - transition: all 0.3s ease
              grid:
                - grid-template-areas: |
                    "i"
                    "n"
                    "status"
                    "info"
                    "progress"
                    "zaehler"
                - grid-template-rows: 1fr auto auto auto auto auto
                - grid-template-columns: 1fr
              name:
                - font-weight: 600
                - font-size: 1.3em
                - letter-spacing: 0.3px
              icon:
                - animation: |
                    [[[
                      if (states['input_boolean.trockner_lauft']?.state === 'on')
                        return "pulse 2s infinite ease-in-out";
                      if (states['input_boolean.trockner_fertig']?.state === 'on')
                        return "blink 1.2s infinite ease-in-out";
                      return "none";
                    ]]]
              custom_fields:
                status:
                  - text-align: center
                  - font-size: 1em
                  - font-weight: 500
                  - opacity: 0.9
                  - padding-top: 4px
                info:
                  - text-align: center
                  - font-size: 1em
                  - font-weight: 500
                  - opacity: 0.85
                progress:
                  - width: 100%
                zaehler:
                  - text-align: center
                  - font-size: 0.95em
                  - padding-top: 12px
                  - opacity: 0.75
            tap_action:
              action: fire-dom-event
              browser_mod:
                service: browser_mod.popup
                data:
                  title: Trockner zurücksetzen?
                  size: normal
                  content:
                    type: vertical-stack
                    cards:
                      - type: markdown
                        content: >
                          {% if is_state('input_boolean.trockner_fertig', 'on')
                          %}
                            Möchtest du den Status **"Fertig"** des Trockners zurücksetzen?
                          {% else %}
                            Trockner ist aktuell **nicht fertig** – kein Zurücksetzen nötig.
                          {% endif %}
                      - type: conditional
                        conditions:
                          - entity: input_boolean.trockner_fertig
                            state: 'on'
                        card:
                          type: horizontal-stack
                          cards:
                            - type: custom:button-card
                              name: ❌ Abbrechen
                              icon: mdi:close
                              tap_action:
                                action: fire-dom-event
                                browser_mod:
                                  service: browser_mod.close_popup
                              styles:
                                card:
                                  - border-radius: 12px
                                  - background: rgba(255, 255, 255, 0.1)
                                  - color: var(--primary-text-color)
                                  - box-shadow: none
                                  - padding: 12px
                                  - height: 50px
                            - type: custom:button-card
                              name: ✅ Zurücksetzen
                              icon: mdi:restart
                              tap_action:
                                action: fire-dom-event
                                browser_mod:
                                  service: browser_mod.sequence
                                  data:
                                    sequence:
                                      - service: input_boolean.turn_off
                                        data:
                                          entity_id: input_boolean.trockner_fertig
                                      - service: browser_mod.close_popup
                              styles:
                                card:
                                  - border-radius: 12px
                                  - background: linear-gradient(145deg,
                                  - color: white
                                  - box-shadow: 0 4px 10px rgba(0,0,0,0.2)
                                  - padding: 12px
                                  - height: 50px
            extra_styles: |
              @keyframes blink {
                0% { opacity: 1; }
                50% { opacity: 0.4; }
                100% { opacity: 1; }
              }

              @keyframes pulse {
                0% { transform: scale(1); }
                50% { transform: scale(1.1); }
                100% { transform: scale(1); }
              }
          - type: custom:bar-card
            entities:
              - entity: sensor.trockner_fortschritt
                name: Trockner
                icon: mdi:tumble-dryer
                unit_of_measurement: '%'
                severity:
                  - from: 0
                    to: 30
                    color: '#3498db'
                  - from: 31
                    to: 70
                    color: '#f1c40f'
                  - from: 71
                    to: 100
                    color: '#2ecc71'
                show_value: true
                show_icon: true
                show_name: true
            height: 28px
            round: true
            icon_position: inside
            value_style: slider
            title_position: top
            width: 100%
            animation:
              state: 'on'
              speed: 1.5
            style: |
              ha-card {
                height: 300px;
                display: flex;
                flex-direction: column;
                justify-content: center;
                border-radius: 16px;
                padding: 12px;
                background: var(--card-background-color);
                box-shadow: 0 4px 14px rgba(0, 0, 0, 0.15);
              }

              .bar-card-name {
                font-weight: 600;
                font-size: 1em;
                padding-bottom: 4px;
              }

              .bar-card-value {
                font-weight: bold;
                font-size: 0.95em;
                color: #ffffff;
              }
          - type: horizontal-stack
            cards:
              - type: tile
                entity: sensor.tageszahler_trockner
                vertical: false
                hide_state: false
                show_entity_picture: false
                name: Zähler
              - type: tile
                entity: sensor.trockner_stoppuhr
                vertical: false
                name: Dauer
                hide_state: false
                icon: mdi:timer
          - square: false
            type: grid
            columns: 2
            cards:
              - type: markdown
                content: >
                  ### 🌀 Letzte Trockengänge

                  **1.** {{
                  as_timestamp(states('input_datetime.trockner_fertig')) |
                  timestamp_custom('%d.%m.%Y %H:%M') }}


                  **2.** {{
                  as_timestamp(states('input_datetime.trockner_fertig_2')) |
                  timestamp_custom('%d.%m.%Y %H:%M') }}


                  **3.** {{
                  as_timestamp(states('input_datetime.trockner_fertig_3')) |
                  timestamp_custom('%d.%m.%Y %H:%M') }}
              - type: markdown
                content: |
                  ### ⏱️ Laufzeiten (Min.)
                  **1.** {{ states('input_number.trockner_laufzeit_1') }} min  

                  **2.** {{ states('input_number.trockner_laufzeit_2') }} min  

                  **3.** {{ states('input_number.trockner_laufzeit_3') }} min
          - type: horizontal-stack
            cards:
              - type: tile
                entity: input_datetime.trockner_startzeit
                vertical: true
              - type: tile
                entity: input_datetime.trockner_fertig
                vertical: true
          - type: horizontal-stack
            cards:
              - type: tile
                entity: sensor.trockner_taglich
                vertical: true
                name: Stromverbrauch Tag
              - type: tile
                entity: sensor.trockner_monatlich
                vertical: true
                name: Stromverbrauch Monat
          - type: horizontal-stack
            cards:
              - type: tile
                entity: sensor.stromkosten_trockner_monat
                vertical: true
                name: Stromkosten Monat
              - type: tile
                entity: sensor.stromkosten_trockner_jahr
                vertical: true
                name: Stromkosten Jahr
          - type: custom:apexcharts-card
            experimental:
              color_threshold: true
            graph_span: 5d
            span:
              end: day
            show:
              last_updated: true
            header:
              show: true
              title: Nutzung Trockner
              show_states: true
              colorize_states: true
            yaxis:
              - min: 0
                max: ~5
                decimals: 0
                apex_config:
                  tickAmount: 5
            series:
              - entity: sensor.nutzung_trockner
                show:
                  header_color_threshold: true
                  extremas: true
                  as_duration: hour
                type: column
                name: Dauer
                group_by:
                  func: last
                  duration: 1d
                color_threshold:
                  - value: 1
                    color: dodgerblue
                  - value: 2
                    color: darkcyan
                  - value: 3
                    color: orange
                  - value: 4
                    color: orangered
                  - value: 5
                    color: darkred
      - type: grid
        cards:
          - type: heading
            heading: Spülmaschine
          - type: custom:button-card
            entity: sensor.spulmaschine_status
            name: Spülmaschine
            icon: mdi:dishwasher
            show_state: false
            show_label: false
            custom_fields:
              status: |
                [[[
                  const laufend = states['input_boolean.spulmaschine_lauft']?.state === 'on';
                  const fertig = states['input_boolean.spulmaschine_fertig']?.state === 'on';

                  const getDuration = (datetimeEntityId) => {
                    const dateStr = states[datetimeEntityId]?.state;
                    if (!dateStr) return null;
                    const startTime = new Date(dateStr);
                    const now = new Date();
                    const diffMs = now - startTime;
                    const totalMin = Math.floor(diffMs / 60000);
                    const hours = Math.floor(totalMin / 60);
                    const minutes = totalMin % 60;
                    let result = '';
                    if (hours > 0) result += `${hours} Std. `;
                    if (minutes > 0 || hours === 0) result += `${minutes} Min`;
                    return result.trim();
                  };

                  if (laufend) {
                    const seit = getDuration('input_datetime.spulmaschine_startzeit');
                    return seit ? `🌀 Läuft seit ${seit}` : '🌀 Läuft';
                  }

                  if (fertig) {
                    const seit = getDuration('input_datetime.spulmaschine_fertig');
                    return seit ? `✅ Fertig seit ${seit}` : '✅ Fertig';
                  }

                  return '🛑 Aus';
                ]]]
              info: |
                [[[
                  const laufend = states['input_boolean.spulmaschine_lauft']?.state === 'on';
                  const fertig = states['input_boolean.spulmaschine_fertig']?.state === 'on';
                  const powerRaw = parseFloat(states['sensor.spulmaschine_power']?.state || '0');
                  const power = powerRaw > 0 ? ` · ⚡ ${powerRaw} W` : '';

                  if (laufend) {
                    const fortschritt = states['sensor.spulmaschine_fortschritt']?.state || '–';
                    const verbleibend = states['sensor.spulmaschine_verbleibend']?.state || '–';
                    return `<div style="margin-top: 10px;">${fortschritt}% · ⏳ ${verbleibend} Min${power}</div>`;
                  }

                  if (fertig) return `<div style="margin-top: 10px;">🍽️ Sauber${power}</div>`;
                  return `<div style="margin-top: 10px;">☑️ Bereit${power}</div>`;
                ]]]
              progress: |
                [[[
                  const laufend = states['input_boolean.spulmaschine_lauft']?.state === 'on';
                  if (!laufend) return '';

                  const fortschritt = parseInt(states['sensor.spulmaschine_fortschritt']?.state || 0);
                  return `
                    <div style="background: rgba(255,255,255,0.25); height: 8px; border-radius: 4px; overflow: hidden; margin-top: 12px;">
                      <div style="width: ${fortschritt}%; background: #ffffff; height: 100%; transition: width 0.4s ease-in-out;"></div>
                    </div>
                  `;
                ]]]
              zaehler: |
                [[[
                  const starts = states['sensor.tageszahler_spulmaschine']?.state || '0';
                  const tag = states['sensor.spulmaschine_taglich']?.state || '–';
                  const monat = states['sensor.spulmaschine_monatlich']?.state || '–';
                  return `🔁 ${starts} · ${tag} kWh · ${monat} kWh`;
                ]]]
            styles:
              card:
                - height: 300px
                - border-radius: 18px
                - padding: 14px
                - background: |
                    [[[
                      if (states['input_boolean.spulmaschine_lauft']?.state === 'on')
                        return "linear-gradient(145deg, #00bcd4, #0097a7)";
                      if (states['input_boolean.spulmaschine_fertig']?.state === 'on')
                        return "linear-gradient(145deg, #4caf50, #2e7d32)";
                      return "var(--card-background-color)";
                    ]]]
                - color: |
                    [[[
                      if (
                        states['input_boolean.spulmaschine_lauft']?.state === 'on' ||
                        states['input_boolean.spulmaschine_fertig']?.state === 'on'
                      ) return "white";
                      return "var(--primary-text-color)";
                    ]]]
                - box-shadow: 0 6px 14px rgba(0, 0, 0, 0.15)
                - transition: all 0.3s ease
              grid:
                - grid-template-areas: |
                    "i"
                    "n"
                    "status"
                    "info"
                    "progress"
                    "zaehler"
                - grid-template-rows: 1fr auto auto auto auto auto
                - grid-template-columns: 1fr
              name:
                - font-weight: 600
                - font-size: 1.3em
                - letter-spacing: 0.3px
              icon:
                - animation: |
                    [[[
                      if (states['input_boolean.spulmaschine_lauft']?.state === 'on')
                        return "pulse 2s infinite ease-in-out";
                      if (states['input_boolean.spulmaschine_fertig']?.state === 'on')
                        return "blink 1.2s infinite ease-in-out";
                      return "none";
                    ]]]
              custom_fields:
                status:
                  - text-align: center
                  - font-size: 1em
                  - font-weight: 500
                  - opacity: 0.9
                  - padding-top: 4px
                info:
                  - text-align: center
                  - font-size: 1em
                  - font-weight: 500
                  - opacity: 0.85
                progress:
                  - width: 100%
                zaehler:
                  - text-align: center
                  - font-size: 0.95em
                  - padding-top: 12px
                  - opacity: 0.75
            tap_action:
              action: fire-dom-event
              browser_mod:
                service: browser_mod.popup
                data:
                  title: Spülmaschine zurücksetzen?
                  size: normal
                  content:
                    type: vertical-stack
                    cards:
                      - type: markdown
                        content: >
                          {% if is_state('input_boolean.spulmaschine_fertig',
                          'on') %}
                            Möchtest du den Status **"Fertig"** der Spülmaschine zurücksetzen?
                          {% else %}
                            Spülmaschine ist aktuell **nicht fertig** – kein Zurücksetzen nötig.
                          {% endif %}
                      - type: conditional
                        conditions:
                          - entity: input_boolean.spulmaschine_fertig
                            state: 'on'
                        card:
                          type: horizontal-stack
                          cards:
                            - type: custom:button-card
                              name: ❌ Abbrechen
                              icon: mdi:close
                              tap_action:
                                action: fire-dom-event
                                browser_mod:
                                  service: browser_mod.close_popup
                              styles:
                                card:
                                  - border-radius: 12px
                                  - background: rgba(255, 255, 255, 0.1)
                                  - color: var(--primary-text-color)
                                  - box-shadow: none
                                  - padding: 12px
                                  - height: 50px
                            - type: custom:button-card
                              name: ✅ Zurücksetzen
                              icon: mdi:restart
                              tap_action:
                                action: fire-dom-event
                                browser_mod:
                                  service: browser_mod.sequence
                                  data:
                                    sequence:
                                      - service: input_boolean.turn_off
                                        data:
                                          entity_id: input_boolean.spulmaschine_fertig
                                      - service: browser_mod.close_popup
                              styles:
                                card:
                                  - border-radius: 12px
                                  - background: linear-gradient(145deg,
                                  - color: white
                                  - box-shadow: 0 4px 10px rgba(0,0,0,0.2)
                                  - padding: 12px
                                  - height: 50px
          - type: custom:bar-card
            entities:
              - entity: sensor.spulmaschine_fortschritt
                name: Spülmaschine
                icon: mdi:dishwasher
                unit_of_measurement: '%'
                severity:
                  - from: 0
                    to: 30
                    color: '#3498db'
                  - from: 31
                    to: 70
                    color: '#f1c40f'
                  - from: 71
                    to: 100
                    color: '#2ecc71'
                show_value: true
                show_icon: true
                show_name: true
            height: 28px
            round: true
            icon_position: inside
            value_style: slider
            title_position: top
            width: 100%
            animation:
              state: 'on'
              speed: 1.5
            style: |
              ha-card {
                height: 300px;
                display: flex;
                flex-direction: column;
                justify-content: center;
                border-radius: 16px;
                padding: 12px;
                background: var(--card-background-color);
                box-shadow: 0 4px 14px rgba(0, 0, 0, 0.15);
              }

              .bar-card-name {
                font-weight: 600;
                font-size: 1em;
                padding-bottom: 4px;
              }

              .bar-card-value {
                font-weight: bold;
                font-size: 0.95em;
                color: #ffffff;
              }
          - type: horizontal-stack
            cards:
              - type: tile
                entity: sensor.tageszahler_spulmaschine
                vertical: false
                name: Zähler
                hide_state: false
                icon: mdi:timer
              - type: tile
                entity: sensor.spulmaschine_stoppuhr
                vertical: false
                name: Dauer
                hide_state: false
                icon: mdi:timer
          - square: false
            type: grid
            columns: 2
            cards:
              - type: markdown
                content: >
                  ### 🍽️ Letzte Spülgänge

                  **1.** {{
                  as_timestamp(states('input_datetime.spulmaschine_fertig')) |
                  timestamp_custom('%d.%m.%Y %H:%M') }}


                  **2.** {{
                  as_timestamp(states('input_datetime.spulmaschine_fertig_2')) |
                  timestamp_custom('%d.%m.%Y %H:%M') }}


                  **3.** {{
                  as_timestamp(states('input_datetime.spulmaschine_fertig_3')) |
                  timestamp_custom('%d.%m.%Y %H:%M') }}
              - type: markdown
                content: >
                  ### ⏱️ Laufzeiten (Min.)

                  **1.** {{ states('input_number.spulmaschine_laufzeit_1') }}
                  min  


                  **2.** {{ states('input_number.spulmaschine_laufzeit_2') }}
                  min  


                  **3.** {{ states('input_number.spulmaschine_laufzeit_3') }}
                  min
          - type: horizontal-stack
            cards:
              - type: tile
                entity: input_datetime.spulmaschine_startzeit
                vertical: true
              - type: tile
                entity: input_datetime.spulmaschine_fertig
                vertical: true
          - type: horizontal-stack
            cards:
              - type: tile
                entity: sensor.spulmaschine_taglich
                vertical: true
                name: Stromverbrauch Tag
              - type: tile
                entity: sensor.spulmaschine_monatlich
                vertical: true
                name: Stromverbrauch Monat
          - type: horizontal-stack
            cards:
              - type: tile
                entity: sensor.stromkosten_spulmaschine_monat
                vertical: true
                name: Stromkosten Monat
              - type: tile
                entity: sensor.stromkosten_spulmaschine_jahr
                vertical: true
                name: Stromkosten Jahr
          - type: custom:apexcharts-card
            experimental:
              color_threshold: true
            graph_span: 5d
            span:
              end: day
            show:
              last_updated: true
            header:
              show: true
              title: Nutzung Spülmaschine
              show_states: true
              colorize_states: true
            yaxis:
              - min: 0
                max: ~5
                decimals: 0
                apex_config:
                  tickAmount: 5
            series:
              - entity: sensor.nutzung_spulmaschine
                show:
                  header_color_threshold: true
                  extremas: true
                  as_duration: hour
                type: column
                name: Dauer
                group_by:
                  func: last
                  duration: 1d
                color_threshold:
                  - value: 1
                    color: dodgerblue
                  - value: 2
                    color: darkcyan
                  - value: 3
                    color: orange
                  - value: 4
                    color: orangered
                  - value: 5
                    color: darkred
      - type: grid
        cards:
          - type: heading
            heading: Backofen
          - type: custom:button-card
            entity: input_boolean.backofen_lauft
            name: Backofen
            icon: mdi:stove
            show_state: false
            show_label: false
            custom_fields:
              status: |
                [[[
                  const laufend = entity.state === 'on';
                  const stoppuhr = states['sensor.backofen_stoppuhr']?.state || '–';
                  if (laufend && stoppuhr !== '–') return `🔥 Läuft seit ${stoppuhr}`;
                  return '🛑 Aus';
                ]]]
              info: |
                [[[
                  const laufend = entity.state === 'on';
                  const laufzeit = states['sensor.backofen_stoppuhr']?.state || '–';
                  const power = parseFloat(states['sensor.backofen_power']?.state || '0');

                  if (laufend && power > 0) return `<div style="margin-top: 10px;">⏱ ${laufzeit} · ⚡ ${power} W</div>`;
                  if (laufend) return `<div style="margin-top: 10px;">⏱ ${laufzeit}</div>`;
                  if (power > 0) return `<div style="margin-top: 10px;">⚡ ${power} W</div>`;
                  return "";
                ]]]
              zaehler: |
                [[[
                  const starts = states['sensor.tageszahler_backofen']?.state || '0';
                  const tag = states['sensor.backofen_taglich']?.state || '–';
                  const monat = states['sensor.backofen_monatlich']?.state || '–';
                  return `🔁 ${starts} · ${tag} kWh · ${monat} kWh`;
                ]]]
            styles:
              card:
                - height: 300px
                - border-radius: 18px
                - padding: 14px
                - background: |
                    [[[
                      if (entity.state === 'on')
                        return "linear-gradient(145deg, #ff5722, #e64a19)";
                      return "var(--card-background-color)";
                    ]]]
                - color: |
                    [[[
                      if (entity.state === 'on')
                        return "white";
                      return "var(--primary-text-color)";
                    ]]]        
                - box-shadow: 0 6px 14px rgba(0, 0, 0, 0.15)
                - transition: all 0.3s ease
              grid:
                - grid-template-areas: |
                    "i"
                    "n"
                    "status"
                    "info"
                    "zaehler"
                - grid-template-rows: 1fr auto auto auto auto
                - grid-template-columns: 1fr
              name:
                - font-weight: 600
                - font-size: 1.3em
                - letter-spacing: 0.3px
              icon:
                - animation: |
                    [[[
                      return entity.state === 'on' ? "pulse 2s infinite ease-in-out" : "none";
                    ]]]
              custom_fields:
                status:
                  - text-align: center
                  - font-size: 1em
                  - font-weight: 500
                  - opacity: 0.9
                  - padding-top: 4px
                info:
                  - text-align: center
                  - font-size: 1em
                  - font-weight: 500
                  - opacity: 0.85
                zaehler:
                  - text-align: center
                  - font-size: 0.95em
                  - padding-top: 12px
                  - opacity: 0.75
            tap_action:
              action: more-info
            extra_styles: |
              @keyframes pulse {
                0% { transform: scale(1); }
                50% { transform: scale(1.1); }
                100% { transform: scale(1); }
              }
          - type: horizontal-stack
            cards:
              - type: tile
                entity: sensor.tageszahler_backofen
                vertical: false
                name: Zähler
                hide_state: false
                icon: mdi:timer
              - type: tile
                entity: sensor.backofen_stoppuhr
                vertical: false
                name: Dauer
                hide_state: false
                icon: mdi:timer
          - type: horizontal-stack
            cards:
              - type: tile
                entity: input_datetime.backofen_startzeit
                vertical: true
              - type: tile
                entity: input_datetime.backofen_endzeit
                vertical: true
          - type: horizontal-stack
            cards:
              - type: tile
                entity: sensor.backofen_taglich
                vertical: true
                name: Stromverbrauch Tag
              - type: tile
                entity: sensor.backofen_monatlich
                vertical: true
                name: Stromverbrauch Monat
          - type: horizontal-stack
            cards:
              - type: tile
                entity: sensor.stromkosten_backofen_monat
                vertical: true
                name: Stromkosten Monat
              - type: tile
                entity: sensor.stromkosten_backofen_jahr
                vertical: true
                name: Stromkosten Jahr
          - type: custom:apexcharts-card
            experimental:
              color_threshold: true
            graph_span: 5d
            span:
              end: day
            show:
              last_updated: true
            header:
              show: true
              title: Nutzung Backofen
              show_states: true
              colorize_states: true
            yaxis:
              - min: 0
                max: ~5
                decimals: 0
                apex_config:
                  tickAmount: 5
            series:
              - entity: sensor.nutzung_backofen
                show:
                  header_color_threshold: true
                  extremas: true
                  as_duration: hour
                type: column
                name: Dauer
                group_by:
                  func: last
                  duration: 1d
                color_threshold:
                  - value: 1
                    color: dodgerblue
                  - value: 2
                    color: darkcyan
                  - value: 3
                    color: orange
                  - value: 4
                    color: orangered
                  - value: 5
                    color: darkred
      - type: grid
        cards:
          - type: heading
            heading: Autoladegerät
          - type: custom:button-card
            entity: input_boolean.autoladegerat_an
            name: Autoladegerät
            icon: mdi:ev-station
            show_state: false
            show_label: false
            custom_fields:
              status: |
                [[[
                  const laufend = entity.state === 'on';
                  const fertig = states['input_boolean.auto_ladegerat_fertig']?.state === 'on';
                  const dauer = states['sensor.autoladegerat_stoppuhr']?.state || '–';
                  if (laufend && dauer !== '–') return `🔌 Lädt seit ${dauer}`;
                  if (fertig) return '✅ Fertig geladen';
                  return '🛑 Aus';
                ]]]
              info: |
                [[[
                  const power = parseFloat(states['sensor.autoladegerat_leistung']?.state || '0');
                  if (power > 5) return `<div style="margin-top: 10px;">⚡ ${power} W</div>`;
                  return "";
                ]]]
              zaehler: |
                [[[
                  const tagRaw = states['sensor.kia_ceed_sw_stromverbrauch_taglich']?.state || '0';
                  const monatRaw = states['sensor.kia_ceed_sw_stromverbrauch_monatlich']?.state || '0';
                  const tag = isNaN(parseFloat(tagRaw)) ? '–' : parseFloat(tagRaw).toFixed(2);
                  const monat = isNaN(parseFloat(monatRaw)) ? '–' : parseFloat(monatRaw).toFixed(2);
                  return `📊 ${tag} kWh · ${monat} kWh`;
                ]]]
            styles:
              card:
                - height: 300px
                - border-radius: 18px
                - padding: 14px
                - background: |
                    [[[
                      if (states['input_boolean.auto_ladegerat_fertig']?.state === 'on')
                        return "linear-gradient(145deg, #4caf50, #2e7d32)";
                      if (entity.state === 'on')
                        return "linear-gradient(145deg, #ffa726, #fb8c00)";
                      return "var(--card-background-color)";
                    ]]]
                - color: |
                    [[[
                      if (states['input_boolean.auto_ladegerat_fertig']?.state === 'on')
                        return "white";
                      if (entity.state === 'on')
                        return "white";
                      return "var(--primary-text-color)";
                    ]]]
                - box-shadow: 0 6px 14px rgba(0, 0, 0, 0.15)
                - transition: all 0.3s ease
              grid:
                - grid-template-areas: |
                    "i"
                    "n"
                    "status"
                    "info"
                    "zaehler"
                - grid-template-rows: 1fr auto auto auto auto
                - grid-template-columns: 1fr
              name:
                - font-weight: 600
                - font-size: 1.3em
                - letter-spacing: 0.3px
              icon:
                - animation: |
                    [[[
                      if (states['input_boolean.auto_ladegerat_fertig']?.state === 'on')
                        return "pulse-green 2s infinite";
                      if (entity.state === 'on')
                        return "pulse 2s infinite ease-in-out";
                      return "none";
                    ]]]
                - color: |
                    [[[
                      if (states['input_boolean.auto_ladegerat_fertig']?.state === 'on')
                        return "#4CAF50";
                      if (entity.state === 'on')
                        return "orange";
                      return "var(--primary-text-color)";
                    ]]]
              custom_fields:
                status:
                  - text-align: center
                  - font-size: 1em
                  - font-weight: 500
                  - opacity: 0.9
                  - padding-top: 4px
                info:
                  - text-align: center
                  - font-size: 1em
                  - font-weight: 500
                  - opacity: 0.85
                zaehler:
                  - text-align: center
                  - font-size: 0.95em
                  - padding-top: 12px
                  - opacity: 0.75
            tap_action:
              action: fire-dom-event
              browser_mod:
                service: browser_mod.popup
                data:
                  title: Autoladegerät zurücksetzen?
                  size: normal
                  content:
                    type: vertical-stack
                    cards:
                      - type: markdown
                        content: >
                          {% if is_state('input_boolean.auto_ladegerat_fertig',
                          'on') %}
                            Möchtest du den Status **"Fertig geladen"** zurücksetzen?
                          {% else %}
                            Autoladegerät ist aktuell **nicht fertig** – kein Zurücksetzen nötig.
                          {% endif %}
                      - type: conditional
                        conditions:
                          - entity: input_boolean.auto_ladegerat_fertig
                            state: 'on'
                        card:
                          type: horizontal-stack
                          cards:
                            - type: custom:button-card
                              name: ❌ Abbrechen
                              icon: mdi:close
                              tap_action:
                                action: fire-dom-event
                                browser_mod:
                                  service: browser_mod.close_popup
                              styles:
                                card:
                                  - border-radius: 12px
                                  - background: rgba(255, 255, 255, 0.1)
                                  - color: var(--primary-text-color)
                                  - box-shadow: none
                                  - padding: 12px
                                  - height: 50px
                            - type: custom:button-card
                              name: ✅ Zurücksetzen
                              icon: mdi:restart
                              tap_action:
                                action: fire-dom-event
                                browser_mod:
                                  service: browser_mod.sequence
                                  data:
                                    sequence:
                                      - service: input_boolean.turn_off
                                        data:
                                          entity_id: input_boolean.auto_ladegerat_fertig
                                      - service: browser_mod.close_popup
                              styles:
                                card:
                                  - border-radius: 12px
                                  - background: linear-gradient(145deg,
                                  - color: white
                                  - box-shadow: 0 4px 10px rgba(0,0,0,0.2)
                                  - padding: 12px
                                  - height: 50px
            extra_styles: |
              @keyframes pulse {
                0% { transform: scale(1); }
                50% { transform: scale(1.1); }
                100% { transform: scale(1); }
              }
              @keyframes pulse-green {
                0% { opacity: 1; }
                50% { opacity: 0.6; }
                100% { opacity: 1; }
              }
          - type: horizontal-stack
            cards:
              - type: tile
                entity: binary_sensor.ceed_ev_battery_plug
                vertical: false
                hide_state: false
                name: Stecker
              - type: tile
                entity: binary_sensor.ceed_ev_battery_charge
                vertical: false
                name: Ladezustand
                hide_state: false
          - type: horizontal-stack
            cards:
              - type: custom:battery-state-card
                entities:
                  - entity: sensor.ceed_ev_battery_level
                    name: Akkustand
                vertical: false
                name: Akkustand
                hide_state: false
                icon: mdi:car-battery
              - type: tile
                entity: sensor.autoladegerat_stoppuhr
                vertical: false
                name: Dauer
                hide_state: false
                icon: mdi:timer
          - type: horizontal-stack
            cards:
              - type: tile
                entity: input_datetime.autoladegerat_startzeit
                vertical: true
              - type: tile
                entity: input_datetime.autoladegerat_endzeit
                vertical: true
          - type: horizontal-stack
            cards:
              - type: tile
                entity: sensor.kia_ceed_sw_stromverbrauch_taglich
                vertical: true
                name: Stromverbrauch Tag
              - type: tile
                entity: sensor.kia_ceed_sw_stromverbrauch_monatlich
                vertical: true
                name: Stromverbrauch Monat
          - type: horizontal-stack
            cards:
              - type: tile
                entity: sensor.stromkosten_autoladegerat_monat
                vertical: true
                name: Stromkosten Monat
              - type: tile
                entity: sensor.stromkosten_autoladegerat_jahr
                vertical: true
                name: Stromkosten Jahr
          - type: custom:apexcharts-card
            experimental:
              color_threshold: true
            graph_span: 5d
            span:
              end: day
            show:
              last_updated: true
            header:
              show: true
              title: Nutzung Autoladegerät
              show_states: true
              colorize_states: true
            yaxis:
              - min: 0
                max: ~5
                decimals: 0
                apex_config:
                  tickAmount: 5
            series:
              - entity: sensor.nutzung_autoladegerat
                show:
                  header_color_threshold: true
                  extremas: true
                  as_duration: hour
                type: column
                name: Dauer
                group_by:
                  func: last
                  duration: 1d
                color_threshold:
                  - value: 1
                    color: dodgerblue
                  - value: 2
                    color: darkcyan
                  - value: 3
                    color: orange
                  - value: 7
                    color: orangered
                  - value: 8
                    color: darkred
      - type: grid
        cards:
          - type: heading
            heading: Airfryer & Küchenmaschine
            heading_style: title
          - type: custom:button-card
            entity: input_boolean.airfryer_kuchenmaschine
            name: Airfryer & Brotbackautomat
            icon: phu:airfryer
            show_state: false
            show_label: false
            custom_fields:
              status: |
                [[[
                  const isOn = states[entity.entity_id].state === 'on';
                  const stoppuhr = states['sensor.airfryer_stoppuhr']?.state || '–';
                  if (isOn) {
                    return stoppuhr !== '–' ? `🔥 Läuft seit ${stoppuhr}` : '🔥 Läuft';
                  }
                  return '🛑 Aus';
                ]]]
              info: |
                [[[
                  const isOn = states[entity.entity_id].state === 'on';
                  const stoppuhr = states['sensor.airfryer_stoppuhr']?.state || '–';
                  const power = parseFloat(states['sensor.kuchenmaschine_power']?.state || '0');

                  if (isOn && power > 0) return `<div style="margin-top: 10px;">⏱ ${stoppuhr} · ⚡ ${power.toFixed(0)} W</div>`;
                  if (isOn) return `<div style="margin-top: 10px;">⏱ ${stoppuhr}</div>`;
                  if (power > 0) return `<div style="margin-top: 10px;">⚡ ${power.toFixed(0)} W</div>`;
                  return "";
                ]]]
              zaehler: |
                [[[
                  const starts = states['sensor.tageszahler_airfryer']?.state || '0';
                  const tag = parseFloat(states['sensor.kuchenmaschine_taglich']?.state || 0).toFixed(2);
                  const monat = parseFloat(states['sensor.kuchenmaschine_monatlich']?.state || 0).toFixed(2);
                  return `🔁 ${starts} · ${tag} kWh · ${monat} kWh`;
                ]]]
            styles:
              card:
                - height: 300px
                - border-radius: 18px
                - padding: 14px
                - background: |
                    [[[
                      return states[entity.entity_id].state === 'on' 
                        ? "linear-gradient(145deg, #ff9800, #fb8c00)"
                        : "var(--card-background-color)";
                    ]]]
                - color: |
                    [[[
                      return states[entity.entity_id].state === 'on'
                        ? "white"
                        : "var(--primary-text-color)";
                    ]]]
                - box-shadow: 0 6px 14px rgba(0, 0, 0, 0.15)
                - transition: all 0.3s ease
              grid:
                - grid-template-areas: |
                    "i"
                    "n"
                    "status"
                    "info"
                    "zaehler"
                - grid-template-rows: 1fr auto auto auto auto
                - grid-template-columns: 1fr
              name:
                - font-weight: 600
                - font-size: 1.3em
                - letter-spacing: 0.3px
              icon:
                - animation: |
                    [[[
                      return states[entity.entity_id].state === 'on' 
                        ? "pulse 2s infinite ease-in-out" 
                        : "none";
                    ]]]
              custom_fields:
                status:
                  - text-align: center
                  - font-size: 1em
                  - font-weight: 500
                  - opacity: 0.9
                  - padding-top: 4px
                info:
                  - text-align: center
                  - font-size: 1em
                  - font-weight: 500
                  - opacity: 0.85
                zaehler:
                  - text-align: center
                  - font-size: 0.95em
                  - padding-top: 12px
                  - opacity: 0.75
            tap_action:
              action: more-info
            extra_styles: |
              @keyframes pulse {
                0% { transform: scale(1); }
                50% { transform: scale(1.1); }
                100% { transform: scale(1); }
              }
          - type: horizontal-stack
            cards:
              - type: tile
                entity: sensor.tageszahler_airfryer
                vertical: false
                name: Zähler
                hide_state: false
                icon: mdi:timer
                features_position: bottom
              - type: tile
                entity: sensor.airfryer_stoppuhr
                vertical: false
                name: Dauer
                hide_state: false
                icon: mdi:timer
                features_position: bottom
          - type: horizontal-stack
            cards:
              - type: tile
                entity: input_datetime.airfryer_startzeit
                name: Airfryer Startzeit
                vertical: true
                features_position: bottom
              - type: tile
                entity: input_datetime.airfryer_endzeit
                name: Airfryer Endzeit
                vertical: true
                features_position: bottom
          - type: horizontal-stack
            cards:
              - type: tile
                entity: sensor.kuchenmaschine_taglich
                vertical: true
                name: Stromverbrauch Tag
                features_position: bottom
              - type: tile
                entity: sensor.kuchenmaschine_monatlich
                vertical: true
                name: Stromverbrauch Monat
                features_position: bottom
          - type: custom:apexcharts-card
            experimental:
              color_threshold: true
            graph_span: 5d
            span:
              end: day
            show:
              last_updated: true
            header:
              show: true
              title: Nutzung Airfryer & Küchenmaschine
              show_states: true
              colorize_states: true
            yaxis:
              - min: 0
                max: ~4
                decimals: 0
                apex_config:
                  tickAmount: 5
            series:
              - entity: sensor.nutzung_airfryer
                show:
                  header_color_threshold: true
                  extremas: true
                  as_duration: hour
                type: column
                name: Dauer
                group_by:
                  func: last
                  duration: 1d
                color_threshold:
                  - value: 1
                    color: dodgerblue
                  - value: 2
                    color: darkcyan
                  - value: 3
                    color: orange
                  - value: 4
                    color: orangered
                  - value: 5
                    color: darkred
      - type: grid
        cards:
          - type: heading
            heading: Kaffeevollautomat
          - type: custom:button-card
            entity: input_boolean.kaffeevollautomat_eingeschaltet
            name: Kaffeevollautomat
            icon: mdi:coffee-maker-outline
            show_state: false
            show_label: false
            custom_fields:
              status: |
                [[[
                  const laufend = entity.state === 'on';
                  const stoppuhr = states['sensor.kaffeevollautomat_stoppuhr']?.state || '–';
                  if (laufend && stoppuhr !== '–') return `☕ Läuft seit ${stoppuhr}`;
                  return '🛑 Aus';
                ]]]
              info: |
                [[[
                  const laufend = entity.state === 'on';
                  const laufzeit = states['sensor.kaffeevollautomat_stoppuhr']?.state || '–';
                  const power = parseFloat(states['sensor.kaffeevollautomat_power']?.state || 0);

                  if (laufend && power > 0) return `<div style="margin-top: 10px;">⏱ ${laufzeit} · ⚡ ${power} W</div>`;
                  if (laufend) return `<div style="margin-top: 10px;">⏱ ${laufzeit}</div>`;
                  if (power > 0) return `<div style="margin-top: 10px;">⚡ ${power} W</div>`;
                  return "";
                ]]]
              zaehler: |
                [[[
                  const starts = states['sensor.tageszahler_kaffeevollautomat']?.state || '0';
                  const tag = parseFloat(states['sensor.kaffeevollautomat_taglich']?.state || 0).toFixed(2);
                  const monat = parseFloat(states['sensor.kaffeevollautomat_monatlich']?.state || 0).toFixed(2);
                  return `🔁 ${starts} · ${tag} kWh · ${monat} kWh`;
                ]]]
            styles:
              card:
                - height: 300px
                - border-radius: 18px
                - padding: 14px
                - background: |
                    [[[
                      if (entity.state === 'on')
                        return "linear-gradient(145deg, #8d6e63, #6d4c41)";
                      return "var(--card-background-color)";
                    ]]]
                - color: |
                    [[[
                      if (entity.state === 'on')
                        return "white";
                      return "var(--primary-text-color)";
                    ]]]
                - box-shadow: 0 6px 14px rgba(0, 0, 0, 0.15)
                - transition: all 0.3s ease
              grid:
                - grid-template-areas: |
                    "i"
                    "n"
                    "status"
                    "info"
                    "zaehler"
                - grid-template-rows: 1fr auto auto auto auto
                - grid-template-columns: 1fr
              name:
                - font-weight: 600
                - font-size: 1.3em
                - letter-spacing: 0.3px
              icon:
                - animation: |
                    [[[
                      return entity.state === 'on' ? "pulse 2s infinite ease-in-out" : "none";
                    ]]]
              custom_fields:
                status:
                  - text-align: center
                  - font-size: 1em
                  - font-weight: 500
                  - opacity: 0.9
                  - padding-top: 4px
                info:
                  - text-align: center
                  - font-size: 1em
                  - font-weight: 500
                  - opacity: 0.85
                zaehler:
                  - text-align: center
                  - font-size: 0.95em
                  - padding-top: 12px
                  - opacity: 0.75
            tap_action:
              action: more-info
            extra_styles: |
              @keyframes pulse {
                0% { transform: scale(1); }
                50% { transform: scale(1.1); }
                100% { transform: scale(1); }
              }
          - type: horizontal-stack
            cards:
              - type: tile
                entity: sensor.tageszahler_kaffeevollautomat
                vertical: false
                name: Zähler
                hide_state: false
                icon: mdi:timer
                features_position: bottom
              - type: tile
                entity: sensor.kaffeevollautomat_stoppuhr
                vertical: false
                name: Dauer
                hide_state: false
                icon: mdi:timer
          - type: horizontal-stack
            cards:
              - type: tile
                entity: input_datetime.kaffeevollautomat_startzeit
                name: Kaffee Startzeit
                vertical: true
              - type: tile
                entity: input_datetime.kaffeevollautomat_endzeit
                name: Kaffee Endzeit
                vertical: true
          - type: horizontal-stack
            cards:
              - type: tile
                entity: sensor.kaffeevollautomat_taglich
                vertical: true
                name: Stromverbrauch Tag
              - type: tile
                entity: sensor.kaffeevollautomat_monatlich
                vertical: true
                name: Stromverbrauch Monat
          - type: horizontal-stack
            cards:
              - type: tile
                entity: sensor.stromkosten_kaffeevollautomat_monat
                vertical: true
                name: Stromkosten Monat
              - type: tile
                entity: sensor.stromkosten_kaffeevollautomat_jahr
                vertical: true
                name: Stromkosten Jahr
          - type: custom:apexcharts-card
            experimental:
              color_threshold: true
            graph_span: 5d
            span:
              end: day
            show:
              last_updated: true
            header:
              show: true
              title: Nutzung Kaffeevollautomat
              show_states: true
              colorize_states: true
            yaxis:
              - min: 0
                max: ~4
                decimals: 0
                apex_config:
                  tickAmount: 5
            series:
              - entity: sensor.nutzung_kaffeevollautomat
                show:
                  header_color_threshold: true
                  extremas: true
                  as_duration: hour
                type: column
                name: Dauer
                group_by:
                  func: last
                  duration: 1d
                color_threshold:
                  - value: 1
                    color: dodgerblue
                  - value: 2
                    color: darkcyan
                  - value: 3
                    color: orange
                  - value: 4
                    color: orangered
                  - value: 5
                    color: darkred
      - type: grid
        cards:
          - type: heading
            heading: Zähler
          - type: custom:auto-entities
            card:
              type: entities
              state_color: false
              title: Monat
            filter:
              include:
                - entity_id: '*zahler*'
              exclude: []
            sort:
              method: state
              numeric: true
              reverse: true
    max_columns: 4
    cards: []
  - title: Heizung
    path: heizung
    icon: mdi:radiator
    type: sections
    sections:
      - type: grid
        cards:
          - type: heading
            heading: Badezimmer
          - type: horizontal-stack
            cards:
              - type: custom:mushroom-template-card
                primary: Temp - Draußen
                entity: sensor.netatmo_draussen_temperature
                secondary: '{{ states(entity) }} °C'
                icon: mdi:thermometer
                icon_color: |
                  {% set s=states(entity)|float(0) %} {% if not is_number(s) %}
                    gray
                  {% elif s < 0 %}
                    indigo
                  {% elif s < 15 %}
                     light-blue
                  {% elif s < 20 %}
                     green
                  {% elif s < 22 %}
                     light-green
                  {% elif s < 25 %}
                    lime
                  {% elif s < 28 %}
                     yellow
                  {% elif s < 31 %}
                     amber
                  {% elif s < 34 %}
                     orange
                  {% elif s < 37 %}
                    deep-orange
                  {% else %}
                    red
                  {% endif %} 
                tap_action:
                  action: more-info
              - type: custom:mushroom-template-card
                primary: Temp - Bad
                entity: sensor.sensor_bad_temperature
                secondary: '{{ states(entity) }} °C'
                icon: mdi:thermometer
                icon_color: |
                  {% set s=states(entity)|float(0) %} {% if not is_number(s) %}
                    gray
                  {% elif s < 0 %}
                    indigo
                  {% elif s < 15 %}
                     light-blue
                  {% elif s < 20 %}
                     green
                  {% elif s < 22 %}
                     light-green
                  {% elif s < 25 %}
                    lime
                  {% elif s < 28 %}
                     yellow
                  {% elif s < 31 %}
                     amber
                  {% elif s < 34 %}
                     orange
                  {% elif s < 37 %}
                    deep-orange
                  {% else %}
                    red
                  {% endif %}           
                tap_action:
                  action: more-info
          - type: horizontal-stack
            cards:
              - type: custom:mushroom-template-card
                primary: Feuchte - Draußen
                entity: sensor.netatmo_draussen_humidity
                secondary: '{{ states(entity) }} %'
                icon: |
                  {% set s=states(entity)|float(0) %} {% if not is_number(s) %}
                    gray
                  {% elif s <= 65 %}
                    mdi:water-percent
                  {% else %}
                    mdi:water-percent-alert
                  {% endif %} 
                icon_color: |
                  {% set s=states(entity)|float(0) %} {% if not is_number(s) %}
                    gray
                  {% elif s <= 60 %}
                    green
                  {% elif s <= 65 %}
                    deep-orange
                  {% else %}
                    red
                  {% endif %}     
              - type: custom:mushroom-template-card
                primary: Feuchte - Bad
                entity: sensor.sensor_bad_humidity
                secondary: '{{ states(entity) }} %'
                icon: |
                  {% set s=states(entity)|float(0) %} {% if not is_number(s) %}
                    gray
                  {% elif s <= 65 %}
                    mdi:water-percent
                  {% else %}
                    mdi:water-percent-alert
                  {% endif %} 
                icon_color: |
                  {% set s=states(entity)|float(0) %} {% if not is_number(s) %}
                    gray
                  {% elif s <= 60 %}
                    green
                  {% elif s <= 65 %}
                    deep-orange
                  {% else %}
                    red
                  {% endif %}
          - type: horizontal-stack
            cards:
              - type: entity
                entity: sensor.thermal_comfort_bad_absolute_luftfeuchtigkeit
                name: Bad
                card_mod:
                  style: |
                    ha-card .name {
                      font-size: 15px;
                    }        
                    ha-card .value {
                      font-size: 15px;
                    }
                    ha-card .measurement {
                      font-size: 15px;
                    }
              - type: entity
                entity: sensor.thermal_comfort_outside_absolute_luftfeuchtigkeit
                name: Außen
                card_mod:
                  style: |
                    ha-card .name {
                      font-size: 15px;
                    }        
                    ha-card .value {
                      font-size: 15px;
                    }
                    ha-card .measurement {
                      font-size: 15px;
                    }
              - type: entity
                entity: sensor.luftf_abs_diff_bad
                name: Diff
                card_mod:
                  style: |
                    ha-card .name {
                      font-size: 15px;
                    }        
                    ha-card .value {
                      font-size: 15px;
                    }
                    ha-card .measurement {
                      font-size: 15px;
                    }
          - type: horizontal-stack
            cards:
              - type: custom:mushroom-template-card
                primary: Fenster-Bad
                entity: binary_sensor.fenster_bad_contact
                name: Fenster
                secondary: |
                  {% if is_state('binary_sensor.fenster_bad_contact', 'off') %}
                    Zu
                  {% else %}
                    Auf
                  {% endif %}
                icon: |
                  {% if is_state('binary_sensor.fenster_bad_contact', 'off') %}
                    mdi:window-closed
                  {% else %}
                    mdi:window-open
                  {% endif %}
                icon_color: |
                  {% if is_state('binary_sensor.fenster_bad_contact', 'off') %}
                    green
                  {% else %}
                    red
                  {% endif %}
                tap_action:
                  action: more-info
              - type: custom:mushroom-template-card
                primary: Personen
                entity: input_boolean.anwesenheit_zuhause
                name: Anwesend
                secondary: |
                  {% if is_state('input_boolean.anwesenheit_zuhause', 'off') %}
                    Abwesend
                  {% else %}
                    Anwesend
                  {% endif %}
                icon: |
                  {% if is_state('input_boolean.anwesenheit_zuhause', 'off') %}
                    mdi:account-group
                  {% else %}
                    mdi:account-group
                  {% endif %}
                icon_color: |
                  {% if is_state('input_boolean.anwesenheit_zuhause', 'off') %}
                    red
                  {% else %}
                    orange
                  {% endif %}
                tap_action:
                  action: more-info
          - type: custom:mushroom-climate-card
            entity: climate.heizung_bad
            show_temperature_control: true
            collapsible_controls: false
            hvac_modes:
              - heat
              - 'off'
            layout: horizontal
            name: Bad
          - type: vertical-stack
            cards:
              - type: entities
                entities:
                  - entity: automation.advancedheating_v5_bad
                    name: Automation Bad
                    state_color: true
                  - entity: timer.heizung_bad_partytimer
                    name: Partytimer
                    state_color: true
                  - entity: schedule.heizung_bad
                    name: Heizen laut Zeitplan
                    state_color: true
                  - entity: sensor.heizung_bad_ausgeschaltet
                    name: Heizung ausgeschaltet
              - type: custom:battery-state-card
                secondary_info: '{last_changed}'
                entities:
                  entity: sensor.heizung_bad_battery
                sort:
                  by: state
                collapse: 8
                bulk_rename:
                  - from: ' Battery'
                  - from: ' level'
                colors:
                  steps:
                    - '#ff0000'
                    - '#ffff00'
                    - '#00ff00'
                  gradient: true
          - type: custom:vertical-stack-in-card
            title: Badezimmer
            cards:
              - type: grid
                square: false
                columns: 2
                cards:
                  - type: custom:mushroom-entity-card
                    entity: sensor.sensor_bad_temperature
                    primary_info: state
                    secondary_info: name
                    name: Temperature
                    icon_color: green
                  - type: custom:mushroom-entity-card
                    entity: sensor.sensor_bad_humidity
                    primary_info: state
                    secondary_info: name
                    name: Humidity
                    icon_color: blue
              - type: custom:mini-graph-card
                entities:
                  - entity: sensor.sensor_bad_temperature
                    name: Temperature
                    color: var(--green-color)
                  - entity: sensor.sensor_bad_humidity
                    name: Humidity
                    color: var(--blue-color)
                    y_axis: secondary
                hours_to_show: 24
                line_width: 3
                font_size: 50
                animate: true
                show:
                  name: false
                  icon: false
                  state: false
                  legend: false
                  fill: fade
          - type: thermostat
            entity: climate.heizung_bad
            show_current_as_primary: false
            features:
              - style: icons
                hvac_modes:
                  - 'off'
                  - auto
                  - heat
                type: climate-hvac-modes
      - type: grid
        cards:
          - type: heading
            heading: Büro
          - type: horizontal-stack
            cards:
              - type: custom:mushroom-template-card
                primary: Temp - Draußen
                entity: sensor.netatmo_draussen_temperature
                secondary: '{{ states(entity) }} °C'
                icon: mdi:thermometer
                icon_color: |
                  {% set s=states(entity)|float(0) %} {% if not is_number(s) %}
                    gray
                  {% elif s < 0 %}
                    indigo
                  {% elif s < 15 %}
                     light-blue
                  {% elif s < 20 %}
                     green
                  {% elif s < 22 %}
                     light-green
                  {% elif s < 25 %}
                    lime
                  {% elif s < 28 %}
                     yellow
                  {% elif s < 31 %}
                     amber
                  {% elif s < 34 %}
                     orange
                  {% elif s < 37 %}
                    deep-orange
                  {% else %}
                    red
                  {% endif %} 
                tap_action:
                  action: more-info
              - type: custom:mushroom-template-card
                primary: Temp - Büro
                entity: sensor.sensor_buro_temperature
                secondary: '{{ states(entity) }} °C'
                icon: mdi:thermometer
                icon_color: |
                  {% set s=states(entity)|float(0) %} {% if not is_number(s) %}
                    gray
                  {% elif s < 0 %}
                    indigo
                  {% elif s < 15 %}
                     light-blue
                  {% elif s < 20 %}
                     green
                  {% elif s < 22 %}
                     light-green
                  {% elif s < 25 %}
                    lime
                  {% elif s < 28 %}
                     yellow
                  {% elif s < 31 %}
                     amber
                  {% elif s < 34 %}
                     orange
                  {% elif s < 37 %}
                    deep-orange
                  {% else %}
                    red
                  {% endif %}           
                tap_action:
                  action: more-info
          - type: horizontal-stack
            cards:
              - type: custom:mushroom-template-card
                primary: Feuchte - Draußen
                entity: sensor.netatmo_draussen_humidity
                secondary: '{{ states(entity) }} %'
                icon: |
                  {% set s=states(entity)|float(0) %} {% if not is_number(s) %}
                    gray
                  {% elif s <= 65 %}
                    mdi:water-percent
                  {% else %}
                    mdi:water-percent-alert
                  {% endif %} 
                icon_color: |
                  {% set s=states(entity)|float(0) %} {% if not is_number(s) %}
                    gray
                  {% elif s <= 60 %}
                    green
                  {% elif s <= 65 %}
                    deep-orange
                  {% else %}
                    red
                  {% endif %}     
              - type: custom:mushroom-template-card
                primary: Feuchte - Büro
                entity: sensor.sensor_buro_humidity
                secondary: '{{ states(entity) }} %'
                icon: |
                  {% set s=states(entity)|float(0) %} {% if not is_number(s) %}
                    gray
                  {% elif s <= 65 %}
                    mdi:water-percent
                  {% else %}
                    mdi:water-percent-alert
                  {% endif %} 
                icon_color: |
                  {% set s=states(entity)|float(0) %} {% if not is_number(s) %}
                    gray
                  {% elif s <= 60 %}
                    green
                  {% elif s <= 65 %}
                    deep-orange
                  {% else %}
                    red
                  {% endif %}
          - type: horizontal-stack
            cards:
              - type: entity
                entity: sensor.thermal_comfort_buro_absolute_luftfeuchtigkeit
                name: Büro
                card_mod:
                  style: |
                    ha-card .name {
                      font-size: 15px;
                    }        
                    ha-card .value {
                      font-size: 15px;
                    }
                    ha-card .measurement {
                      font-size: 15px;
                    }
              - type: entity
                entity: sensor.thermal_comfort_outside_absolute_luftfeuchtigkeit
                name: Außen
                card_mod:
                  style: |
                    ha-card .name {
                      font-size: 15px;
                    }        
                    ha-card .value {
                      font-size: 15px;
                    }
                    ha-card .measurement {
                      font-size: 15px;
                    }
              - type: entity
                entity: sensor.luftf_abs_diff_buro
                name: Diff
                card_mod:
                  style: |
                    ha-card .name {
                      font-size: 15px;
                    }        
                    ha-card .value {
                      font-size: 15px;
                    }
                    ha-card .measurement {
                      font-size: 15px;
                    }
          - type: horizontal-stack
            cards:
              - type: custom:mushroom-template-card
                primary: Fenster-Büro
                entity: binary_sensor.fenster_buro_contact
                name: Fenster
                secondary: |
                  {% if is_state('binary_sensor.fenster_buro_contact', 'off') %}
                    Zu
                  {% else %}
                    Auf
                  {% endif %}
                icon: |
                  {% if is_state('binary_sensor.fenster_buro_contact', 'off') %}
                    mdi:window-closed
                  {% else %}
                    mdi:window-open
                  {% endif %}
                icon_color: |
                  {% if is_state('binary_sensor.fenster_buro_contact', 'off') %}
                    green
                  {% else %}
                    red
                  {% endif %}
                tap_action:
                  action: more-info
              - type: custom:mushroom-template-card
                primary: Personen
                entity: input_boolean.anwesenheit_zuhause
                name: Anwesend
                secondary: |
                  {% if is_state('input_boolean.anwesenheit_zuhause', 'off') %}
                    Abwesend
                  {% else %}
                    Anwesend
                  {% endif %}
                icon: |
                  {% if is_state('input_boolean.anwesenheit_zuhause', 'off') %}
                    mdi:account-group
                  {% else %}
                    mdi:account-group
                  {% endif %}
                icon_color: |
                  {% if is_state('input_boolean.anwesenheit_zuhause', 'off') %}
                    red
                  {% else %}
                    orange
                  {% endif %}
                tap_action:
                  action: more-info
          - type: custom:mushroom-climate-card
            entity: climate.heizung_buro
            show_temperature_control: true
            collapsible_controls: true
            hvac_modes:
              - heat
              - 'off'
            layout: horizontal
            name: Büro
          - type: vertical-stack
            cards:
              - type: entities
                entities:
                  - entity: automation.advancedheating_v5_buro
                    name: Automation Büro
                    state_color: true
                  - entity: input_boolean.urlaub_daniel
                  - entity: timer.heizung_buro_partytimer
                    name: Partytimer
                    state_color: true
                  - entity: schedule.heizung_buro_zeitplan
                    name: Heizen laut Zeitplan
                    state_color: true
                  - entity: sensor.heizung_buro_ausgeschaltet
                    name: Heizung ausgeschaltet
              - type: custom:battery-state-card
                secondary_info: '{last_changed}'
                entities:
                  entity: sensor.heizung_buro_battery
                sort:
                  by: state
                collapse: 8
                bulk_rename:
                  - from: ' Battery'
                  - from: ' level'
                colors:
                  steps:
                    - '#ff0000'
                    - '#ffff00'
                    - '#00ff00'
                  gradient: true
          - type: custom:vertical-stack-in-card
            title: Büro
            cards:
              - type: grid
                square: false
                columns: 2
                cards:
                  - type: custom:mushroom-entity-card
                    entity: sensor.sensor_buro_temperature
                    primary_info: state
                    secondary_info: name
                    name: Temperature
                    icon_color: green
                  - type: custom:mushroom-entity-card
                    entity: sensor.sensor_buro_humidity
                    primary_info: state
                    secondary_info: name
                    name: Humidity
                    icon_color: blue
              - type: custom:mini-graph-card
                entities:
                  - entity: sensor.sensor_buro_temperature
                    name: Temperature
                    color: var(--green-color)
                  - entity: sensor.sensor_buro_humidity
                    name: Humidity
                    color: var(--blue-color)
                    y_axis: secondary
                hours_to_show: 24
                line_width: 3
                font_size: 50
                animate: true
                show:
                  name: false
                  icon: false
                  state: false
                  legend: false
                  fill: fade
          - type: thermostat
            entity: climate.heizung_buro
            show_current_as_primary: false
            features:
              - style: icons
                hvac_modes:
                  - 'off'
                  - auto
                  - heat
                type: climate-hvac-modes
      - type: grid
        cards:
          - type: heading
            heading: Wohn- & Esszimmer
          - type: horizontal-stack
            cards:
              - type: custom:mushroom-template-card
                primary: Temp - Draußen
                entity: sensor.netatmo_draussen_temperature
                secondary: '{{ states(entity) }} °C'
                icon: mdi:thermometer
                icon_color: |
                  {% set s=states(entity)|float(0) %} {% if not is_number(s) %}
                    gray
                  {% elif s < 0 %}
                    indigo
                  {% elif s < 15 %}
                     light-blue
                  {% elif s < 20 %}
                     green
                  {% elif s < 22 %}
                     light-green
                  {% elif s < 25 %}
                    lime
                  {% elif s < 28 %}
                     yellow
                  {% elif s < 31 %}
                     amber
                  {% elif s < 34 %}
                     orange
                  {% elif s < 37 %}
                    deep-orange
                  {% else %}
                    red
                  {% endif %} 
                tap_action:
                  action: more-info
              - type: custom:mushroom-template-card
                primary: Temp - Wohnz
                entity: sensor.sensor_wohnzimmer_temperature
                secondary: '{{ states(entity) }} °C'
                icon: mdi:thermometer
                icon_color: |
                  {% set s=states(entity)|float(0) %} {% if not is_number(s) %}
                    gray
                  {% elif s < 0 %}
                    indigo
                  {% elif s < 15 %}
                     light-blue
                  {% elif s < 20 %}
                     green
                  {% elif s < 22 %}
                     light-green
                  {% elif s < 25 %}
                    lime
                  {% elif s < 28 %}
                     yellow
                  {% elif s < 31 %}
                     amber
                  {% elif s < 34 %}
                     orange
                  {% elif s < 37 %}
                    deep-orange
                  {% else %}
                    red
                  {% endif %}           
                tap_action:
                  action: more-info
          - type: horizontal-stack
            cards:
              - type: custom:mushroom-template-card
                primary: Feuchte - Draußen
                entity: sensor.netatmo_draussen_humidity
                secondary: '{{ states(entity) }} %'
                icon: |
                  {% set s=states(entity)|float(0) %} {% if not is_number(s) %}
                    gray
                  {% elif s <= 65 %}
                    mdi:water-percent
                  {% else %}
                    mdi:water-percent-alert
                  {% endif %} 
                icon_color: |
                  {% set s=states(entity)|float(0) %} {% if not is_number(s) %}
                    gray
                  {% elif s <= 60 %}
                    green
                  {% elif s <= 65 %}
                    deep-orange
                  {% else %}
                    red
                  {% endif %}     
              - type: custom:mushroom-template-card
                primary: Feuchte - Wohn
                entity: sensor.sensor_wohnzimmer_humidity
                secondary: '{{ states(entity) }} %'
                icon: |
                  {% set s=states(entity)|float(0) %} {% if not is_number(s) %}
                    gray
                  {% elif s <= 65 %}
                    mdi:water-percent
                  {% else %}
                    mdi:water-percent-alert
                  {% endif %} 
                icon_color: |
                  {% set s=states(entity)|float(0) %} {% if not is_number(s) %}
                    gray
                  {% elif s <= 60 %}
                    green
                  {% elif s <= 65 %}
                    deep-orange
                  {% else %}
                    red
                  {% endif %}
          - type: horizontal-stack
            cards:
              - type: entity
                entity: sensor.thermal_comfort_wohnzimmer_absolute_luftfeuchtigkeit
                name: Wohn
                card_mod:
                  style: |
                    ha-card .name {
                      font-size: 15px;
                    }        
                    ha-card .value {
                      font-size: 15px;
                    }
                    ha-card .measurement {
                      font-size: 15px;
                    }
              - type: entity
                entity: sensor.thermal_comfort_outside_absolute_luftfeuchtigkeit
                name: Außen
                card_mod:
                  style: |
                    ha-card .name {
                      font-size: 15px;
                    }        
                    ha-card .value {
                      font-size: 15px;
                    }
                    ha-card .measurement {
                      font-size: 15px;
                    }
              - type: entity
                entity: sensor.luftf_abs_diff_wohnzimmer
                name: Diff
                card_mod:
                  style: |
                    ha-card .name {
                      font-size: 15px;
                    }        
                    ha-card .value {
                      font-size: 15px;
                    }
                    ha-card .measurement {
                      font-size: 15px;
                    }
          - type: horizontal-stack
            cards:
              - type: custom:mushroom-template-card
                primary: Terrasse
                entity: binary_sensor.terrassentur_window_and_door_sensor_5
                secondary: >
                  {% if
                  is_state('binary_sensor.terrassentur_window_and_door_sensor_5',
                  'off') %}
                    Zu
                  {% else %}
                    Auf
                  {% endif %}
                icon: >
                  {% if
                  is_state('binary_sensor.terrassentur_window_and_door_sensor_5',
                  'off') %}
                    mdi:window-closed
                  {% else %}
                    mdi:window-open
                  {% endif %}
                icon_color: >
                  {% if
                  is_state('binary_sensor.terrassentur_window_and_door_sensor_5',
                  'off') %}
                    green
                  {% else %}
                    red
                  {% endif %}
                tap_action:
                  action: more-info
              - type: custom:mushroom-template-card
                primary: Personen
                entity: input_boolean.anwesenheit_zuhause
                name: Anwesend
                secondary: |
                  {% if is_state('input_boolean.anwesenheit_zuhause', 'off') %}
                    Abwesend
                  {% else %}
                    Anwesend
                  {% endif %}
                icon: |
                  {% if is_state('input_boolean.anwesenheit_zuhause', 'off') %}
                    mdi:account-group
                  {% else %}
                    mdi:account-group
                  {% endif %}
                icon_color: |
                  {% if is_state('input_boolean.anwesenheit_zuhause', 'off') %}
                    red
                  {% else %}
                    orange
                  {% endif %}
                tap_action:
                  action: more-info
          - type: custom:mushroom-climate-card
            entity: climate.heizung_esszimmer
            show_temperature_control: true
            collapsible_controls: true
            hvac_modes:
              - heat
              - 'off'
            layout: horizontal
            name: Esszimmer
          - type: custom:mushroom-climate-card
            entity: climate.heizung_wohnzimmer
            show_temperature_control: true
            collapsible_controls: true
            hvac_modes:
              - heat
              - 'off'
            layout: horizontal
            name: Wohnzimmer
          - type: vertical-stack
            cards:
              - type: entities
                entities:
                  - entity: automation.advancedheating_v5_wohnzimmer
                    name: Automation Wohnzimmer
                    state_color: true
                  - entity: timer.heizung_wohnzimmer_partytime
                    name: Partytimer
                    state_color: true
                  - entity: schedule.heizung_wohnzimmer_zeitplan
                    name: Heizen laut Zeitplan
                    state_color: true
                  - entity: sensor.heizung_esszimmer_ausgeschaltet
                    name: Esszimmer ausgeschaltet
                  - entity: sensor.heizung_wohnzimmer_ausgeschaltet
                    name: Wohnzimmer ausgeschaltet
              - type: custom:battery-state-card
                secondary_info: '{last_changed}'
                entities:
                  entity: sensor.heizung_esszimmer_battery
                sort:
                  by: state
                collapse: 8
                bulk_rename:
                  - from: ' Battery'
                  - from: ' level'
                colors:
                  steps:
                    - '#ff0000'
                    - '#ffff00'
                    - '#00ff00'
                  gradient: true
              - type: custom:battery-state-card
                secondary_info: '{last_changed}'
                entities:
                  entity: sensor.heizung_wohnzimmer_battery
                sort:
                  by: state
                collapse: 8
                bulk_rename:
                  - from: ' Battery'
                  - from: ' level'
                colors:
                  steps:
                    - '#ff0000'
                    - '#ffff00'
                    - '#00ff00'
                  gradient: true
          - type: custom:vertical-stack-in-card
            title: Wohn- & Esszimmer
            cards:
              - type: grid
                square: false
                columns: 2
                cards:
                  - type: custom:mushroom-entity-card
                    entity: sensor.sensor_wohnzimmer_temperature
                    primary_info: state
                    secondary_info: name
                    name: Temperature
                    icon_color: green
                  - type: custom:mushroom-entity-card
                    entity: sensor.sensor_wohnzimmer_humidity
                    primary_info: state
                    secondary_info: name
                    name: Humidity
                    icon_color: blue
              - type: custom:mini-graph-card
                entities:
                  - entity: sensor.sensor_wohnzimmer_temperature
                    name: Temperature
                    color: var(--green-color)
                  - entity: sensor.sensor_wohnzimmer_humidity
                    name: Humidity
                    color: var(--blue-color)
                    y_axis: secondary
                hours_to_show: 24
                line_width: 3
                font_size: 50
                animate: true
                show:
                  name: false
                  icon: false
                  state: false
                  legend: false
                  fill: fade
          - type: thermostat
            entity: climate.heizung_esszimmer
            show_current_as_primary: false
            features:
              - style: icons
                hvac_modes:
                  - 'off'
                  - auto
                  - heat
                type: climate-hvac-modes
          - type: thermostat
            entity: climate.heizung_wohnzimmer
            show_current_as_primary: false
            features:
              - style: icons
                hvac_modes:
                  - 'off'
                  - auto
                  - heat
                type: climate-hvac-modes
      - type: grid
        cards:
          - type: heading
            heading: Küche
          - type: horizontal-stack
            cards:
              - type: custom:mushroom-template-card
                primary: Temp - Draußen
                entity: sensor.netatmo_draussen_temperature
                secondary: '{{ states(entity) }} °C'
                icon: mdi:thermometer
                icon_color: |
                  {% set s=states(entity)|float(0) %} {% if not is_number(s) %}
                    gray
                  {% elif s < 0 %}
                    indigo
                  {% elif s < 15 %}
                     light-blue
                  {% elif s < 20 %}
                     green
                  {% elif s < 22 %}
                     light-green
                  {% elif s < 25 %}
                    lime
                  {% elif s < 28 %}
                     yellow
                  {% elif s < 31 %}
                     amber
                  {% elif s < 34 %}
                     orange
                  {% elif s < 37 %}
                    deep-orange
                  {% else %}
                    red
                  {% endif %} 
                tap_action:
                  action: more-info
              - type: custom:mushroom-template-card
                primary: Temp - Küche
                entity: sensor.netatmo_innen_temperature
                secondary: '{{ states(entity) }} °C'
                icon: mdi:thermometer
                icon_color: |
                  {% set s=states(entity)|float(0) %} {% if not is_number(s) %}
                    gray
                  {% elif s < 0 %}
                    indigo
                  {% elif s < 15 %}
                     light-blue
                  {% elif s < 20 %}
                     green
                  {% elif s < 22 %}
                     light-green
                  {% elif s < 25 %}
                    lime
                  {% elif s < 28 %}
                     yellow
                  {% elif s < 31 %}
                     amber
                  {% elif s < 34 %}
                     orange
                  {% elif s < 37 %}
                    deep-orange
                  {% else %}
                    red
                  {% endif %}           
                tap_action:
                  action: more-info
          - type: horizontal-stack
            cards:
              - type: custom:mushroom-template-card
                primary: Feuchte - Draußen
                entity: sensor.netatmo_draussen_humidity
                secondary: '{{ states(entity) }} %'
                icon: |
                  {% set s=states(entity)|float(0) %} {% if not is_number(s) %}
                    gray
                  {% elif s <= 65 %}
                    mdi:water-percent
                  {% else %}
                    mdi:water-percent-alert
                  {% endif %} 
                icon_color: |
                  {% set s=states(entity)|float(0) %} {% if not is_number(s) %}
                    gray
                  {% elif s <= 60 %}
                    green
                  {% elif s <= 65 %}
                    deep-orange
                  {% else %}
                    red
                  {% endif %}     
              - type: custom:mushroom-template-card
                primary: Feuchte - Küche
                entity: sensor.netatmo_innen_humidity
                secondary: '{{ states(entity) }} %'
                icon: |
                  {% set s=states(entity)|float(0) %} {% if not is_number(s) %}
                    gray
                  {% elif s <= 65 %}
                    mdi:water-percent
                  {% else %}
                    mdi:water-percent-alert
                  {% endif %} 
                icon_color: |
                  {% set s=states(entity)|float(0) %} {% if not is_number(s) %}
                    gray
                  {% elif s <= 60 %}
                    green
                  {% elif s <= 65 %}
                    deep-orange
                  {% else %}
                    red
                  {% endif %}
          - type: horizontal-stack
            cards:
              - type: entity
                entity: sensor.thermal_comfort_kuche_absolute_luftfeuchtigkeit
                name: Küche
                card_mod:
                  style: |
                    ha-card .name {
                      font-size: 15px;
                    }        
                    ha-card .value {
                      font-size: 15px;
                    }
                    ha-card .measurement {
                      font-size: 15px;
                    }
              - type: entity
                entity: sensor.thermal_comfort_outside_absolute_luftfeuchtigkeit
                name: Außen
                card_mod:
                  style: |
                    ha-card .name {
                      font-size: 15px;
                    }        
                    ha-card .value {
                      font-size: 15px;
                    }
                    ha-card .measurement {
                      font-size: 15px;
                    }
              - type: entity
                entity: sensor.luftf_abs_diff_kuche
                name: Diff
                card_mod:
                  style: |
                    ha-card .name {
                      font-size: 15px;
                    }        
                    ha-card .value {
                      font-size: 15px;
                    }
                    ha-card .measurement {
                      font-size: 15px;
                    }
          - type: horizontal-stack
            cards:
              - type: custom:mushroom-template-card
                primary: Fenster-Küche
                entity: binary_sensor.fenster_kuche_contact
                name: Küche
                secondary: >
                  {% if is_state('binary_sensor.fenster_kuche_contact', 'off')
                  %}
                    Zu
                  {% else %}
                    Auf
                  {% endif %}
                icon: >
                  {% if is_state('binary_sensor.fenster_kuche_contact', 'off')
                  %}
                    mdi:window-closed
                  {% else %}
                    mdi:window-open
                  {% endif %}
                icon_color: >
                  {% if is_state('binary_sensor.fenster_kuche_contact', 'off')
                  %}
                    green
                  {% else %}
                    red
                  {% endif %}
                tap_action:
                  action: more-info
              - type: custom:mushroom-template-card
                primary: Personen
                entity: input_boolean.anwesenheit_zuhause
                name: Anwesend
                secondary: |
                  {% if is_state('input_boolean.anwesenheit_zuhause', 'off') %}
                    Abwesend
                  {% else %}
                    Anwesend
                  {% endif %}
                icon: |
                  {% if is_state('input_boolean.anwesenheit_zuhause', 'off') %}
                    mdi:account-group
                  {% else %}
                    mdi:account-group
                  {% endif %}
                icon_color: |
                  {% if is_state('input_boolean.anwesenheit_zuhause', 'off') %}
                    red
                  {% else %}
                    orange
                  {% endif %}
                tap_action:
                  action: more-info
          - type: custom:mushroom-climate-card
            entity: climate.heizung_kuche
            show_temperature_control: true
            collapsible_controls: true
            hvac_modes:
              - heat
              - 'off'
            layout: horizontal
            name: Küche
          - type: vertical-stack
            cards:
              - type: entities
                entities:
                  - entity: automation.advancedheating_v5_kuche
                    name: Automation Küche
                    state_color: true
                  - entity: timer.heizung_kuche_partytimer
                    name: Partytimer
                    state_color: true
                  - entity: schedule.heizung_kuche_zeitplan
                    name: Heizen laut Zeitplan
                    state_color: true
                  - entity: sensor.heizung_kuche_ausgeschaltet
                    name: Heizung ausgeschaltet
              - type: custom:battery-state-card
                secondary_info: '{last_changed}'
                entities:
                  entity: sensor.heizung_kuche_battery
                sort:
                  by: state
                collapse: 8
                bulk_rename:
                  - from: ' Battery'
                  - from: ' level'
                colors:
                  steps:
                    - '#ff0000'
                    - '#ffff00'
                    - '#00ff00'
                  gradient: true
          - type: custom:vertical-stack-in-card
            title: Küche
            cards:
              - type: grid
                square: false
                columns: 2
                cards:
                  - type: custom:mushroom-entity-card
                    entity: sensor.netatmo_innen_temperature
                    primary_info: state
                    secondary_info: name
                    name: Temperature
                    icon_color: green
                  - type: custom:mushroom-entity-card
                    entity: sensor.netatmo_innen_humidity
                    primary_info: state
                    secondary_info: name
                    name: Humidity
                    icon_color: blue
              - type: custom:mini-graph-card
                entities:
                  - entity: sensor.netatmo_innen_temperature
                    name: Temperature
                    color: var(--green-color)
                  - entity: sensor.netatmo_innen_humidity
                    name: Humidity
                    color: var(--blue-color)
                    y_axis: secondary
                hours_to_show: 24
                line_width: 3
                font_size: 50
                animate: true
                show:
                  name: false
                  icon: false
                  state: false
                  legend: false
                  fill: fade
          - type: thermostat
            entity: climate.heizung_kuche
            show_current_as_primary: false
            features:
              - style: icons
                hvac_modes:
                  - 'off'
                  - auto
                  - heat
                type: climate-hvac-modes
      - type: grid
        cards:
          - type: heading
            heading: WC OG
            heading_style: title
          - type: horizontal-stack
            cards:
              - type: custom:mushroom-template-card
                primary: Temp - Draußen
                entity: sensor.netatmo_draussen_temperature
                secondary: '{{ states(entity) }} °C'
                icon: mdi:thermometer
                icon_color: |
                  {% set s=states(entity)|float(0) %} {% if not is_number(s) %}
                    gray
                  {% elif s < 0 %}
                    indigo
                  {% elif s < 15 %}
                     light-blue
                  {% elif s < 20 %}
                     green
                  {% elif s < 22 %}
                     light-green
                  {% elif s < 25 %}
                    lime
                  {% elif s < 28 %}
                     yellow
                  {% elif s < 31 %}
                     amber
                  {% elif s < 34 %}
                     orange
                  {% elif s < 37 %}
                    deep-orange
                  {% else %}
                    red
                  {% endif %} 
                tap_action:
                  action: more-info
              - type: custom:mushroom-template-card
                primary: Temp - WC OG
                entity: sensor.wc_og_temperature
                secondary: '{{ states(entity) }} °C'
                icon: mdi:thermometer
                icon_color: |
                  {% set s=states(entity)|float(0) %} {% if not is_number(s) %}
                    gray
                  {% elif s < 0 %}
                    indigo
                  {% elif s < 15 %}
                     light-blue
                  {% elif s < 20 %}
                     green
                  {% elif s < 22 %}
                     light-green
                  {% elif s < 25 %}
                    lime
                  {% elif s < 28 %}
                     yellow
                  {% elif s < 31 %}
                     amber
                  {% elif s < 34 %}
                     orange
                  {% elif s < 37 %}
                    deep-orange
                  {% else %}
                    red
                  {% endif %}           
                tap_action:
                  action: more-info
          - type: horizontal-stack
            cards:
              - type: custom:mushroom-template-card
                primary: Feuchte - Draußen
                entity: sensor.netatmo_draussen_humidity
                secondary: '{{ states(entity) }} %'
                icon: |
                  {% set s=states(entity)|float(0) %} {% if not is_number(s) %}
                    gray
                  {% elif s <= 65 %}
                    mdi:water-percent
                  {% else %}
                    mdi:water-percent-alert
                  {% endif %} 
                icon_color: |
                  {% set s=states(entity)|float(0) %} {% if not is_number(s) %}
                    gray
                  {% elif s <= 60 %}
                    green
                  {% elif s <= 65 %}
                    deep-orange
                  {% else %}
                    red
                  {% endif %}     
              - type: custom:mushroom-template-card
                primary: Feuchte - WC OG
                entity: sensor.wc_og_humidity
                secondary: '{{ states(entity) }} %'
                icon: |
                  {% set s=states(entity)|float(0) %} {% if not is_number(s) %}
                    gray
                  {% elif s <= 65 %}
                    mdi:water-percent
                  {% else %}
                    mdi:water-percent-alert
                  {% endif %} 
                icon_color: |
                  {% set s=states(entity)|float(0) %} {% if not is_number(s) %}
                    gray
                  {% elif s <= 60 %}
                    green
                  {% elif s <= 65 %}
                    deep-orange
                  {% else %}
                    red
                  {% endif %}
          - type: horizontal-stack
            cards:
              - type: entity
                entity: sensor.thermal_comfort_wc_og_absolute_luftfeuchtigkeit
                name: WC OG
                card_mod:
                  style: |
                    ha-card .name {
                      font-size: 15px;
                    }        
                    ha-card .value {
                      font-size: 15px;
                    }
                    ha-card .measurement {
                      font-size: 15px;
                    }
              - type: entity
                entity: sensor.thermal_comfort_outside_absolute_luftfeuchtigkeit
                name: Außen
                card_mod:
                  style: |
                    ha-card .name {
                      font-size: 15px;
                    }        
                    ha-card .value {
                      font-size: 15px;
                    }
                    ha-card .measurement {
                      font-size: 15px;
                    }
              - type: entity
                entity: sensor.luftf_abs_diff_wc_og
                name: Diff
                card_mod:
                  style: |
                    ha-card .name {
                      font-size: 15px;
                    }        
                    ha-card .value {
                      font-size: 15px;
                    }
                    ha-card .measurement {
                      font-size: 15px;
                    }
          - type: horizontal-stack
            cards:
              - type: custom:mushroom-template-card
                primary: Fenster WC-OG
                entity: binary_sensor.fenster_wc_og_contact
                name: Küche
                secondary: >
                  {% if is_state('binary_sensor.fenster_wc_og_contact', 'off')
                  %}
                    Zu
                  {% else %}
                    Auf
                  {% endif %}
                icon: >
                  {% if is_state('binary_sensor.fenster_wc_og_contact', 'off')
                  %}
                    mdi:window-closed
                  {% else %}
                    mdi:window-open
                  {% endif %}
                icon_color: >
                  {% if is_state('binary_sensor.fenster_wc_og_contact', 'off')
                  %}
                    green
                  {% else %}
                    red
                  {% endif %}
                tap_action:
                  action: more-info
              - type: custom:mushroom-template-card
                primary: Personen
                entity: input_boolean.anwesenheit_zuhause
                name: Anwesend
                secondary: |
                  {% if is_state('input_boolean.anwesenheit_zuhause', 'off') %}
                    Abwesend
                  {% else %}
                    Anwesend
                  {% endif %}
                icon: |
                  {% if is_state('input_boolean.anwesenheit_zuhause', 'off') %}
                    mdi:account-group
                  {% else %}
                    mdi:account-group
                  {% endif %}
                icon_color: |
                  {% if is_state('input_boolean.anwesenheit_zuhause', 'off') %}
                    red
                  {% else %}
                    orange
                  {% endif %}
                tap_action:
                  action: more-info
          - type: custom:mushroom-climate-card
            entity: climate.heizung_wc_og
            show_temperature_control: true
            collapsible_controls: false
            hvac_modes:
              - heat
              - 'off'
            layout: horizontal
            name: WC-OG
          - type: vertical-stack
            cards:
              - type: entities
                entities:
                  - entity: automation.advancedheating_v5_wc_og
                    name: Automation WC-OG
                    state_color: true
                  - entity: sensor.heizung_wc_og_ausgeschaltet
                    name: Heizung ausgeschaltet
              - type: custom:battery-state-card
                secondary_info: '{last_changed}'
                entities:
                  entity: binary_sensor.heizung_wc_og_battery
                sort:
                  by: state
                collapse: 8
                bulk_rename:
                  - from: ' Battery'
                  - from: ' level'
                colors:
                  steps:
                    - '#ff0000'
                    - '#ffff00'
                    - '#00ff00'
                  gradient: true
          - type: custom:vertical-stack-in-card
            title: WC OG
            cards:
              - type: grid
                square: false
                columns: 2
                cards:
                  - type: custom:mushroom-entity-card
                    entity: sensor.wc_og_temperature
                    primary_info: state
                    secondary_info: name
                    name: Temperature
                    icon_color: green
                  - type: custom:mushroom-entity-card
                    entity: sensor.wc_og_humidity
                    primary_info: state
                    secondary_info: name
                    name: Humidity
                    icon_color: blue
              - type: custom:mini-graph-card
                entities:
                  - entity: sensor.wc_og_temperature
                    name: Temperature
                    color: var(--green-color)
                  - entity: sensor.wc_og_humidity
                    name: Humidity
                    color: var(--blue-color)
                    y_axis: secondary
                hours_to_show: 24
                line_width: 3
                font_size: 50
                animate: true
                show:
                  name: false
                  icon: false
                  state: false
                  legend: false
                  fill: fade
          - type: thermostat
            entity: climate.heizung_wc_og
            show_current_as_primary: false
            features:
              - style: icons
                hvac_modes:
                  - 'off'
                  - auto
                  - heat
                type: climate-hvac-modes
      - type: grid
        cards:
          - type: heading
            heading: WC EG
            heading_style: title
          - type: horizontal-stack
            cards:
              - type: custom:mushroom-template-card
                primary: Temp - Draußen
                entity: sensor.netatmo_draussen_temperature
                secondary: '{{ states(entity) }} °C'
                icon: mdi:thermometer
                icon_color: |
                  {% set s=states(entity)|float(0) %} {% if not is_number(s) %}
                    gray
                  {% elif s < 0 %}
                    indigo
                  {% elif s < 15 %}
                     light-blue
                  {% elif s < 20 %}
                     green
                  {% elif s < 22 %}
                     light-green
                  {% elif s < 25 %}
                    lime
                  {% elif s < 28 %}
                     yellow
                  {% elif s < 31 %}
                     amber
                  {% elif s < 34 %}
                     orange
                  {% elif s < 37 %}
                    deep-orange
                  {% else %}
                    red
                  {% endif %} 
                tap_action:
                  action: more-info
              - type: custom:mushroom-template-card
                primary: Temp - WC EG
                entity: sensor.wc_eg_temperature
                secondary: '{{ states(entity) }} °C'
                icon: mdi:thermometer
                icon_color: |
                  {% set s=states(entity)|float(0) %} {% if not is_number(s) %}
                    gray
                  {% elif s < 0 %}
                    indigo
                  {% elif s < 15 %}
                     light-blue
                  {% elif s < 20 %}
                     green
                  {% elif s < 22 %}
                     light-green
                  {% elif s < 25 %}
                    lime
                  {% elif s < 28 %}
                     yellow
                  {% elif s < 31 %}
                     amber
                  {% elif s < 34 %}
                     orange
                  {% elif s < 37 %}
                    deep-orange
                  {% else %}
                    red
                  {% endif %}           
                tap_action:
                  action: more-info
          - type: horizontal-stack
            cards:
              - type: custom:mushroom-template-card
                primary: Feuchte - Draußen
                entity: sensor.netatmo_draussen_humidity
                secondary: '{{ states(entity) }} %'
                icon: |
                  {% set s=states(entity)|float(0) %} {% if not is_number(s) %}
                    gray
                  {% elif s <= 65 %}
                    mdi:water-percent
                  {% else %}
                    mdi:water-percent-alert
                  {% endif %} 
                icon_color: |
                  {% set s=states(entity)|float(0) %} {% if not is_number(s) %}
                    gray
                  {% elif s <= 60 %}
                    green
                  {% elif s <= 65 %}
                    deep-orange
                  {% else %}
                    red
                  {% endif %}     
              - type: custom:mushroom-template-card
                primary: Feuchte - WC EG
                entity: sensor.wc_eg_humidity
                secondary: '{{ states(entity) }} %'
                icon: |
                  {% set s=states(entity)|float(0) %} {% if not is_number(s) %}
                    gray
                  {% elif s <= 65 %}
                    mdi:water-percent
                  {% else %}
                    mdi:water-percent-alert
                  {% endif %} 
                icon_color: |
                  {% set s=states(entity)|float(0) %} {% if not is_number(s) %}
                    gray
                  {% elif s <= 60 %}
                    green
                  {% elif s <= 65 %}
                    deep-orange
                  {% else %}
                    red
                  {% endif %}
          - type: horizontal-stack
            cards:
              - type: entity
                entity: sensor.thermal_comfort_wc_eg_absolute_luftfeuchtigkeit
                name: WC EG
                card_mod:
                  style: |
                    ha-card .name {
                      font-size: 15px;
                    }        
                    ha-card .value {
                      font-size: 15px;
                    }
                    ha-card .measurement {
                      font-size: 15px;
                    }
              - type: entity
                entity: sensor.thermal_comfort_outside_absolute_luftfeuchtigkeit
                name: Außen
                card_mod:
                  style: |
                    ha-card .name {
                      font-size: 15px;
                    }        
                    ha-card .value {
                      font-size: 15px;
                    }
                    ha-card .measurement {
                      font-size: 15px;
                    }
              - type: entity
                entity: sensor.luftf_abs_diff_wc_eg
                name: Diff
                card_mod:
                  style: |
                    ha-card .name {
                      font-size: 15px;
                    }        
                    ha-card .value {
                      font-size: 15px;
                    }
                    ha-card .measurement {
                      font-size: 15px;
                    }
          - type: horizontal-stack
            cards:
              - type: custom:mushroom-template-card
                primary: Fenster WC-EG
                entity: binary_sensor.fenster_wc_eg_contact
                name: WC-EG
                secondary: >
                  {% if is_state('binary_sensor.fenster_wc_eg_contact', 'off')
                  %}
                    Zu
                  {% else %}
                    Auf
                  {% endif %}
                icon: >
                  {% if is_state('binary_sensor.fenster_wc_eg_contact', 'off')
                  %}
                    mdi:window-closed
                  {% else %}
                    mdi:window-open
                  {% endif %}
                icon_color: >
                  {% if is_state('binary_sensor.fenster_wc_eg_contact', 'off')
                  %}
                    green
                  {% else %}
                    red
                  {% endif %}
                tap_action:
                  action: more-info
              - type: custom:mushroom-template-card
                primary: Personen
                entity: input_boolean.anwesenheit_zuhause
                name: Anwesend
                secondary: |
                  {% if is_state('input_boolean.anwesenheit_zuhause', 'off') %}
                    Abwesend
                  {% else %}
                    Anwesend
                  {% endif %}
                icon: |
                  {% if is_state('input_boolean.anwesenheit_zuhause', 'off') %}
                    mdi:account-group
                  {% else %}
                    mdi:account-group
                  {% endif %}
                icon_color: |
                  {% if is_state('input_boolean.anwesenheit_zuhause', 'off') %}
                    red
                  {% else %}
                    orange
                  {% endif %}
                tap_action:
                  action: more-info
          - type: custom:mushroom-climate-card
            entity: climate.heizung_wc_eg
            show_temperature_control: true
            collapsible_controls: false
            hvac_modes:
              - heat
              - 'off'
            layout: horizontal
            name: WC-EG
          - type: vertical-stack
            cards:
              - type: entities
                entities:
                  - entity: automation.advanced_heating_control_v5_wc_eg
                    name: Automation WC-EG
                    state_color: true
                  - entity: sensor.heizung_wc_eg_ausgeschaltet
                    name: Heizung ausgeschaltet
              - type: custom:battery-state-card
                secondary_info: '{last_changed}'
                entities:
                  entity: binary_sensor.heizung_wc_eg_battery_low
                sort:
                  by: state
                collapse: 8
                bulk_rename:
                  - from: ' Battery'
                  - from: ' level'
                colors:
                  steps:
                    - '#ff0000'
                    - '#ffff00'
                    - '#00ff00'
                  gradient: true
          - type: custom:vertical-stack-in-card
            title: WC EG
            cards:
              - type: grid
                square: false
                columns: 2
                cards:
                  - type: custom:mushroom-entity-card
                    entity: sensor.wc_eg_temperature
                    primary_info: state
                    secondary_info: name
                    name: Temperature
                    icon_color: green
                  - type: custom:mushroom-entity-card
                    entity: sensor.wc_eg_humidity
                    primary_info: state
                    secondary_info: name
                    name: Humidity
                    icon_color: blue
              - type: custom:mini-graph-card
                entities:
                  - entity: sensor.wc_eg_temperature
                    name: Temperature
                    color: var(--green-color)
                  - entity: sensor.wc_eg_humidity
                    name: Humidity
                    color: var(--blue-color)
                    y_axis: secondary
                hours_to_show: 24
                line_width: 3
                font_size: 50
                animate: true
                show:
                  name: false
                  icon: false
                  state: false
                  legend: false
                  fill: fade
          - type: thermostat
            entity: climate.heizung_wc_eg
            show_current_as_primary: false
            features:
              - style: icons
                hvac_modes:
                  - 'off'
                  - auto
                  - heat
                type: climate-hvac-modes
    cards: []
    header: {}
  - type: custom:grid-layout
    title: Sanky-Chart
    icon: mdi:sitemap-outline
    cards:
      - type: custom:sankey-chart
        title: Aktuell
        layout: auto
        height: 300
        unit_prefix: W
        round: 1
        convert_units_to: ''
        co2_intensity_entity: sensor.co2_signal_co2_intensity
        gas_co2_intensity: 2351.6459999999997
        min_box_size: 7
        min_box_distance: 8
        show_states: true
        show_units: true
        show_names: true
        show_icons: true
        wide: true
        min_state: 0
        sort_by: state
        energy_date_selection: false
        sections:
          - entities:
              - type: entity
                children:
                  - entity_id: sensor.gesamtleistung
                    name: Verbrauch Gesamt
                entity_id: sensor.balkonkraftwerk_power
                name: Solar
                min_state: 0
                color: '#f4b400'
              - type: entity
                children:
                  - entity_id: sensor.gesamtleistung
                entity_id: sensor.stromverbrauch_differenz
                name: Bezug
                min_state: 0
                color: '#4285f4'
              - type: entity
                children: []
                entity_id: sensor.einspeisung
                name: Einspeisung
                color: '#0f9d58'
          - entities:
              - type: entity
                children:
                  - entity_id: sensor.kuchengeraete
                  - entity_id: sensor.computer
                  - entity_id: sensor.fernseher
                  - entity_id: sensor.auto
                  - entity_id: sensor.schuppen
                entity_id: sensor.gesamtleistung
                name: Gesamt
                color: '#999999'
          - entities:
              - type: entity
                children: []
                entity_id: sensor.kuchengeraete
                name: Küchengeräte
                color: '#ff7043'
              - type: entity
                children:
                  - entity_id: sensor.pc_daniel_power
                  - entity_id: sensor.pc_nick_power
                  - entity_id: sensor.pc_phil_check_power
                  - entity_id: sensor.nas_ha_laptop_power
                entity_id: sensor.computer
                name: Computer
                color: '#8e24aa'
              - type: entity
                children: []
                entity_id: sensor.fernseher
                name: Fernseher
                color: '#29b6f6'
              - type: entity
                children:
                  - entity_id: sensor.autoladegerat_leistung
                entity_id: sensor.auto
                name: Auto
                color: '#5e35b1'
              - type: entity
                children:
                  - entity_id: sensor.kuhlschrank_schuppen_power
                entity_id: sensor.schuppen
                name: Schuppen
                color: '#789262'
      - type: custom:sankey-chart
        title: Heute
        layout: horizontal
        height: 300
        unit_prefix: k
        round: 2
        convert_units_to: ''
        co2_intensity_entity: sensor.co2_signal_co2_intensity
        gas_co2_intensity: 2351.6459999999997
        min_box_size: 8
        min_box_distance: 8
        show_states: true
        show_units: true
        show_names: true
        show_icons: true
        wide: true
        min_state: 0
        sort_by: none
        energy_date_selection: false
        sections:
          - entities:
              - type: entity
                children:
                  - entity_id: sensor.stromverbrauch_gesamt_taglich
                    name: Verbrauch Gesamt
                entity_id: sensor.balkonkraftwerk_tag
                name: Solar
                min_state: 0
                icon: mdi:white-balance-sunny
                color: '#f4b400'
              - type: entity
                children:
                  - entity_id: sensor.stromverbrauch_gesamt_taglich
                entity_id: sensor.stromverbrauch_solarproduktion_diff_kwh_2
                name: Bezug
                min_state: 0
                icon: mdi:transmission-tower-import
                color: '#4285f4'
              - type: entity
                children: []
                entity_id: sensor.einspeisung_kwh_tag
                name: Einspeisung
                icon: mdi:transmission-tower-export
                color: '#0f9d58'
          - entities:
              - type: entity
                children:
                  - entity_id: sensor.computer_tag
                  - entity_id: sensor.fernseher_tag
                  - entity_id: sensor.kuchengerate_tag
                  - entity_id: sensor.auto_tag
                  - entity_id: sensor.schuppen_tag
                entity_id: sensor.stromverbrauch_gesamt_taglich
                name: Gesamt
                color: '#999999'
          - entities:
              - type: entity
                children:
                  - entity_id: sensor.pc_daniel_taglich
                  - entity_id: sensor.pc_nick_taglich
                  - entity_id: sensor.pc_phil_taglich
                  - entity_id: sensor.nas_ha_laptop_taglich
                entity_id: sensor.computer_tag
                name: Computer
                color: '#8e24aa'
              - type: entity
                children:
                  - entity_id: sensor.tv_konsolen_nick_taglich
                  - entity_id: sensor.tv_phil_taglich
                  - entity_id: sensor.tv_schlafzimmer_taglich
                  - entity_id: sensor.tv_wohnzimmer_router_taglich
                entity_id: sensor.fernseher_tag
                name: Fernseher
                color: '#29b6f6'
              - type: entity
                children:
                  - entity_id: sensor.pc_daniel_taglich
                  - entity_id: sensor.pc_nick_taglich
                  - entity_id: sensor.pc_phil_taglich
                  - entity_id: sensor.nas_ha_laptop_taglich
                entity_id: sensor.kuchengerate_tag
                name: Küchengeräte
                color: '#ff7043'
              - type: entity
                children:
                  - entity_id: sensor.kia_ceed_sw_stromverbrauch_taglich
                entity_id: sensor.auto_tag
                name: Auto
                color: '#5e35b1'
              - type: entity
                children:
                  - entity_id: sensor.kuhlschrank_schuppen_taglich
                entity_id: sensor.schuppen_tag
                name: Schuppen
                color: '#789262'
      - type: custom:sankey-chart
        title: Monat
        layout: horizontal
        height: 300
        unit_prefix: k
        round: 0
        convert_units_to: ''
        co2_intensity_entity: sensor.co2_signal_co2_intensity
        gas_co2_intensity: 2351.6459999999997
        min_box_size: 12
        min_box_distance: 4
        show_states: true
        show_units: true
        show_names: true
        show_icons: true
        wide: true
        min_state: 0
        sort_by: state
        energy_date_selection: false
        sections:
          - entities:
              - type: entity
                children:
                  - entity_id: sensor.stromverbrauch_kwh_monatlich
                    name: Verbrauch Gesamt
                entity_id: sensor.balkonkraftwerk_monat
                name: Solar
                min_state: 0
                icon: mdi:white-balance-sunny
                color: '#f4b400'
              - type: entity
                children:
                  - entity_id: sensor.stromverbrauch_kwh_monatlich
                entity_id: sensor.stromverbrauch_solarproduktion_diff_kwh_monat
                name: Bezug
                min_state: 0
                icon: mdi:transmission-tower-import
                color: '#4285f4'
              - type: entity
                children: []
                entity_id: sensor.einspeisung_kwh_monat_2
                name: Einspeisung
                icon: mdi:transmission-tower-export
                color: '#0f9d58'
          - entities:
              - type: entity
                children:
                  - entity_id: sensor.computer_monat
                  - entity_id: sensor.fernseher_monat
                  - entity_id: sensor.kuchengerate_monat
                  - entity_id: sensor.auto_monat
                  - entity_id: sensor.schuppen_monat
                entity_id: sensor.stromverbrauch_kwh_monatlich
                name: Gesamt
                color: '#999999'
          - entities:
              - type: entity
                children:
                  - entity_id: sensor.pc_daniel_monatlich
                  - entity_id: sensor.pc_nick_monatlich
                  - entity_id: sensor.pc_phil_monatlich
                  - entity_id: sensor.nas_ha_laptop_monatlich
                entity_id: sensor.computer_monat
                name: Computer
                color: '#8e24aa'
              - type: entity
                children:
                  - entity_id: sensor.tv_konsolen_nick_monatlich
                  - entity_id: sensor.tv_phil_monatlich
                  - entity_id: sensor.tv_schlafzimmer_monatlich
                  - entity_id: sensor.tv_wohnzimmer_router_monatlich
                entity_id: sensor.fernseher_monat
                name: Fernseher
                color: '#29b6f6'
              - type: entity
                children:
                  - entity_id: sensor.pc_daniel_monatlich
                  - entity_id: sensor.pc_nick_monatlich
                  - entity_id: sensor.pc_phil_monatlich
                  - entity_id: sensor.nas_ha_laptop_monatlich
                entity_id: sensor.kuchengerate_monat
                name: Küchengeräte
                color: '#ff7043'
              - type: entity
                children:
                  - entity_id: sensor.kia_ceed_sw_stromverbrauch_monatlich
                entity_id: sensor.auto_monat
                name: Auto
                color: '#5e35b1'
              - type: entity
                children:
                  - entity_id: sensor.kuhlschrank_schuppen_monatlich
                entity_id: sensor.schuppen_monat
                name: Schuppen
                color: '#789262'
    sections: []
  - title: Garten
    path: garten
    icon: mdi:pine-tree
    badges: []
    cards:
      - type: gauge
        max: 100
        min: 0
        needle: true
        severity:
          green: 50
          yellow: 15
          red: 0
        name: 'Kräutergarten '
        entity: sensor.krautergarten_soil_moisture
      - type: custom:flower-card
        entity: plant.krauterbeet
        battery_sensor: sensor.krautergarten_battery
        show_bars:
          - moisture
          - temperature
          - humidity
        display_type: full
      - type: gauge
        max: 100
        min: 0
        needle: true
        severity:
          green: 50
          yellow: 15
          red: 0
        entity: sensor.blumen_vorn_soil_moisture
        name: 'Blumen vorne '
      - type: custom:flower-card
        entity: plant.blumen_vorn
        battery_sensor: sensor.blumen_vorn_battery
        show_bars:
          - moisture
          - temperature
          - humidity
        display_type: full
      - type: entities
        entities:
          - entity: script.timer_bewasserung_ruckseite
            name: Rückseite
            secondary_info: last-triggered
          - entity: script.timer_bewasserung_terrassenseite
            secondary_info: last-triggered
            name: Terrasse
        state_color: false
        title: Starte Bewässerungsautomatik
      - type: entities
        entities:
          - entity: switch.wasseranschluss_links
            secondary_info: last-changed
            tap_action:
              action: toggle
              confirmation:
                text: Bewässerung ein-/ausstellen?
            name: Rasen Rückseite
          - entity: number.wasseranschluss_links_timer
            name: Rasen Rückseite Timer
          - entity: sensor.wasseranschluss_links_timer_time_left
            name: Rasen Rückseite Restlaufzeit
          - entity: sensor.wasseranschluss_links_water_consumed
            name: Rückseite Wassermenge
          - entity: switch.wasseranschluss_rechts
            name: Rasen Terrassenseite
            secondary_info: last-changed
            tap_action:
              action: toggle
              confirmation:
                text: Bewässerung ein-/ausstellen?
          - entity: number.wasseranschluss_rechts_timer
            name: Terrassenseite Timer
            secondary_info: none
          - entity: sensor.wasseranschluss_rechts_timer_time_left
            name: Terrassenseite Restzeit
          - entity: sensor.wasseranschluss_rechts_water_consumed
            name: Terrasse Wassermenge
        state_color: true
        title: Garten-Bewässerung
      - type: horizontal-stack
        cards:
          - type: custom:mushroom-cover-card
            entity: cover.kuche
            layout: vertical
            show_position_control: true
            show_tilt_position_control: false
            show_buttons_control: true
          - type: custom:mushroom-cover-card
            entity: cover.esszimmer
            layout: vertical
            show_position_control: true
            show_tilt_position_control: false
            show_buttons_control: true
      - type: custom:scheduler-card
        title: Zeitplaner
        include:
          - input_boolean.timer_bewasserung_ruckseite_aktiv
          - input_boolean.timer_bewasserung_terrassenseite_aktiv
          - script.timer_bewasserung_ruckseite
          - script.timer_bewasserung_terrassenseite
          - switch.wasseranschluss_links
          - switch.wasseranschluss_rechts
        exclude: []
      - type: custom:weather-card
        entity: weather.lingen
        number_of_forecasts: '5'
        current: false
        details: true
        forecast: true
        hourly_forecast: true
      - type: custom:vertical-stack-in-card
        title: Draußen
        cards:
          - type: grid
            square: false
            columns: 2
            cards:
              - type: custom:mushroom-entity-card
                entity: sensor.netatmo_draussen_temperature
                primary_info: state
                secondary_info: name
                name: Temperature
                icon_color: green
              - type: custom:mushroom-entity-card
                entity: sensor.netatmo_draussen_humidity
                primary_info: state
                secondary_info: name
                name: Humidity
                icon_color: blue
          - type: custom:mini-graph-card
            entities:
              - entity: sensor.netatmo_draussen_temperature
                name: Temperature
                color: var(--green-color)
              - entity: sensor.netatmo_draussen_humidity
                name: Humidity
                color: var(--blue-color)
                y_axis: secondary
            hours_to_show: 24
            line_width: 3
            font_size: 50
            animate: true
            show:
              name: false
              icon: false
              state: false
              legend: false
              fill: fade
      - type: entities
        entities:
          - entity: sensor.rrraintext
          - entity: sensor.rrrainin30min
          - entity: sensor.rrrainin60min
          - entity: sensor.rrrainin120min
        title: Regenradar Lingen
      - type: custom:clock-weather-card
        entity: weather.lingen
        sun_entity: sun.sun
        weather_icon_type: line
        animated_icon: true
        forecast_days: 5
        locale: de-DE
        time_format: 24
        date_pattern: P
        hide_today_section: true
        hide_forecast_section: false
        hide_clock: true
        hide_date: true
        hourly_forecast: false
        use_browser_time: true
      - type: custom:auto-entities
        card:
          type: entities
          title: Rasen Rückseite
          state_color: true
        filter:
          include:
            - entity_id: '*wasseranschluss_links*'
          exclude:
            - entity_id: '*schedule*'
            - entity_id: '*timer_state*'
            - entity_id: '*cycle*'
        sort:
          method: friendly_name
          numeric: false
          ignore_case: false
          reverse: false
        show_empty: true
      - type: custom:auto-entities
        card:
          type: entities
          title: Terrassenseite
          state_color: true
        filter:
          include:
            - entity_id: '*wasseranschluss_rechts*'
          exclude:
            - entity_id: '*schedule*'
            - entity_id: '*timer_state*'
            - entity_id: '*cycle*'
        sort:
          method: friendly_name
          numeric: false
          ignore_case: false
          reverse: false
        show_empty: true
  - title: Temperaturen
    path: temperaturen
    icon: mdi:thermometer
    badges: []
    cards:
      - type: custom:mini-graph-card
        name: Aussentemperatur
        entities:
          - entity: sensor.netatmo_draussen_temperature
        points_per_hour: 3
        hours_to_show: 24
        hour24: true
        more_info: false
        show:
          legend: false
          extrema: true
          average: true
        color_thresholds:
          - value: 40
            color: '#D11208'
          - value: 30
            color: '#EF6D4D'
          - value: 20
            color: '#FBCE17'
          - value: 15
            color: '#7BD71B'
          - value: 10
            color: '#B9F3C5'
          - value: 0
            color: '#BFDC94'
          - value: -10
            color: '#672BE1'
      - type: custom:vertical-stack-in-card
        title: Aussentemperatur
        cards:
          - type: grid
            square: false
            columns: 2
            cards:
              - type: custom:mushroom-entity-card
                entity: sensor.netatmo_draussen_temperature
                primary_info: state
                secondary_info: name
                name: Temperature
                icon_color: green
              - type: custom:mushroom-entity-card
                entity: sensor.netatmo_draussen_humidity
                primary_info: state
                secondary_info: name
                name: Humidity
                icon_color: blue
          - type: custom:mini-graph-card
            entities:
              - entity: sensor.netatmo_draussen_temperature
                name: Temperature
                color: var(--green-color)
              - entity: sensor.netatmo_draussen_humidity
                name: Humidity
                color: var(--blue-color)
                y_axis: secondary
            hours_to_show: 24
            line_width: 3
            font_size: 50
            animate: true
            show:
              name: false
              icon: false
              state: false
              legend: false
              fill: fade
      - type: custom:vertical-stack-in-card
        title: Badezimmer
        cards:
          - type: grid
            square: false
            columns: 2
            cards:
              - type: custom:mushroom-entity-card
                entity: sensor.sensor_bad_temperature
                primary_info: state
                secondary_info: name
                name: Temperature
                icon_color: green
              - type: custom:mushroom-entity-card
                entity: sensor.sensor_bad_humidity
                primary_info: state
                secondary_info: name
                name: Humidity
                icon_color: blue
          - type: custom:mini-graph-card
            entities:
              - entity: sensor.sensor_bad_temperature
                name: Temperature
                color: var(--green-color)
              - entity: sensor.sensor_bad_humidity
                name: Humidity
                color: var(--blue-color)
                y_axis: secondary
            hours_to_show: 24
            line_width: 3
            font_size: 50
            animate: true
            show:
              name: false
              icon: false
              state: false
              legend: false
              fill: fade
      - type: custom:vertical-stack-in-card
        title: Büro
        cards:
          - type: grid
            square: false
            columns: 2
            cards:
              - type: custom:mushroom-entity-card
                entity: sensor.sensor_buro_temperature
                primary_info: state
                secondary_info: name
                name: Temperature
                icon_color: green
              - type: custom:mushroom-entity-card
                entity: sensor.sensor_buro_humidity
                primary_info: state
                secondary_info: name
                name: Humidity
                icon_color: blue
          - type: custom:mini-graph-card
            entities:
              - entity: sensor.sensor_buro_temperature
                name: Temperature
                color: var(--green-color)
              - entity: sensor.sensor_buro_humidity
                name: Humidity
                color: var(--blue-color)
                y_axis: secondary
            hours_to_show: 24
            line_width: 3
            font_size: 50
            animate: true
            show:
              name: false
              icon: false
              state: false
              legend: false
              fill: fade
      - type: custom:vertical-stack-in-card
        title: Schlafzimmer
        cards:
          - type: grid
            square: false
            columns: 2
            cards:
              - type: custom:mushroom-entity-card
                entity: sensor.sensor_schlafzimmer_temperature
                primary_info: state
                secondary_info: name
                name: Temperature
                icon_color: green
              - type: custom:mushroom-entity-card
                entity: sensor.sensor_schlafzimmer_humidity
                primary_info: state
                secondary_info: name
                name: Humidity
                icon_color: blue
          - type: custom:mini-graph-card
            entities:
              - entity: sensor.sensor_schlafzimmer_temperature
                name: Temperature
                color: var(--green-color)
              - entity: sensor.sensor_schlafzimmer_humidity
                name: Humidity
                color: var(--blue-color)
                y_axis: secondary
            hours_to_show: 24
            line_width: 3
            font_size: 50
            animate: true
            show:
              name: false
              icon: false
              state: false
              legend: false
              fill: fade
      - type: custom:vertical-stack-in-card
        title: WC OG
        cards:
          - type: grid
            square: false
            columns: 2
            cards:
              - type: custom:mushroom-entity-card
                entity: sensor.wc_og_temperature
                primary_info: state
                secondary_info: name
                name: Temperature
                icon_color: green
              - type: custom:mushroom-entity-card
                entity: sensor.wc_og_humidity
                primary_info: state
                secondary_info: name
                name: Humidity
                icon_color: blue
          - type: custom:mini-graph-card
            entities:
              - entity: sensor.wc_og_temperature
                name: Temperature
                color: var(--green-color)
              - entity: sensor.wc_og_humidity
                name: Humidity
                color: var(--blue-color)
                y_axis: secondary
            hours_to_show: 24
            line_width: 3
            font_size: 50
            animate: true
            show:
              name: false
              icon: false
              state: false
              legend: false
              fill: fade
      - type: horizontal-stack
        cards:
          - type: custom:mushroom-entity-card
            name: WC-OG
            entity: sensor.thermal_comfort_wc_og_absolute_luftfeuchtigkeit
            tap_action:
              action: more-info
          - type: custom:mushroom-entity-card
            name: Außen
            entity: sensor.thermal_comfort_outside_absolute_luftfeuchtigkeit
            tap_action:
              action: more-info
          - type: custom:mushroom-entity-card
            name: Diff.
            entity: sensor.luftf_abs_diff_wc_og
            tap_action:
              action: more-info
      - type: custom:vertical-stack-in-card
        title: Zimmer Nick
        cards:
          - type: grid
            square: false
            columns: 2
            cards:
              - type: custom:mushroom-entity-card
                entity: sensor.sensor_nick_temperature
                primary_info: state
                secondary_info: name
                name: Temperature
                icon_color: green
              - type: custom:mushroom-entity-card
                entity: sensor.sensor_nick_humidity
                primary_info: state
                secondary_info: name
                name: Humidity
                icon_color: blue
          - type: custom:mini-graph-card
            entities:
              - entity: sensor.sensor_nick_temperature
                name: Temperature
                color: var(--green-color)
              - entity: sensor.sensor_nick_humidity
                name: Humidity
                color: var(--blue-color)
                y_axis: secondary
            hours_to_show: 24
            line_width: 3
            font_size: 50
            animate: true
            show:
              name: false
              icon: false
              state: false
              legend: false
              fill: fade
      - type: custom:vertical-stack-in-card
        title: Zimmer Phil
        cards:
          - type: grid
            square: false
            columns: 2
            cards:
              - type: custom:mushroom-entity-card
                entity: sensor.sensor_phil_temperature
                primary_info: state
                secondary_info: name
                name: Temperature
                icon_color: green
              - type: custom:mushroom-entity-card
                entity: sensor.sensor_phil_humidity
                primary_info: state
                secondary_info: name
                name: Humidity
                icon_color: blue
          - type: custom:mini-graph-card
            entities:
              - entity: sensor.sensor_phil_temperature
                name: Temperature
                color: var(--green-color)
              - entity: sensor.sensor_phil_humidity
                name: Humidity
                color: var(--blue-color)
                y_axis: secondary
            hours_to_show: 24
            line_width: 3
            font_size: 50
            animate: true
            show:
              name: false
              icon: false
              state: false
              legend: false
              fill: fade
      - type: custom:vertical-stack-in-card
        title: Flur OG
        cards:
          - type: grid
            square: false
            columns: 2
            cards:
              - type: custom:mushroom-entity-card
                entity: sensor.sensor_flur_og_temperature
                primary_info: state
                secondary_info: name
                name: Temperature
                icon_color: green
              - type: custom:mushroom-entity-card
                entity: sensor.sensor_flur_og_humidity
                primary_info: state
                secondary_info: name
                name: Humidity
                icon_color: blue
          - type: custom:mini-graph-card
            entities:
              - entity: sensor.sensor_flur_og_temperature
                name: Temperature
                color: var(--green-color)
              - entity: sensor.sensor_flur_og_humidity
                name: Humidity
                color: var(--blue-color)
                y_axis: secondary
            hours_to_show: 24
            line_width: 3
            font_size: 50
            animate: true
            show:
              name: false
              icon: false
              state: false
              legend: false
              fill: fade
      - type: custom:vertical-stack-in-card
        title: Flur EG
        cards:
          - type: grid
            square: false
            columns: 2
            cards:
              - type: custom:mushroom-entity-card
                entity: sensor.flureg_temperature
                primary_info: state
                secondary_info: name
                name: Temperature
                icon_color: green
              - type: custom:mushroom-entity-card
                entity: sensor.flureg_humidity
                primary_info: state
                secondary_info: name
                name: Humidity
                icon_color: blue
          - type: custom:mini-graph-card
            entities:
              - entity: sensor.flureg_temperature
                name: Temperature
                color: var(--green-color)
              - entity: sensor.flureg_humidity
                name: Humidity
                color: var(--blue-color)
                y_axis: secondary
            hours_to_show: 24
            line_width: 3
            font_size: 50
            animate: true
            show:
              name: false
              icon: false
              state: false
              legend: false
              fill: fade
      - type: custom:vertical-stack-in-card
        title: WC EG
        cards:
          - type: grid
            square: false
            columns: 2
            cards:
              - type: custom:mushroom-entity-card
                entity: sensor.wc_eg_temperature
                primary_info: state
                secondary_info: name
                name: Temperature
                icon_color: green
              - type: custom:mushroom-entity-card
                entity: sensor.wc_eg_humidity
                primary_info: state
                secondary_info: name
                name: Humidity
                icon_color: blue
          - type: custom:mini-graph-card
            entities:
              - entity: sensor.wc_eg_temperature
                name: Temperature
                color: var(--green-color)
              - entity: sensor.wc_eg_humidity
                name: Humidity
                color: var(--blue-color)
                y_axis: secondary
            hours_to_show: 24
            line_width: 3
            font_size: 50
            animate: true
            show:
              name: false
              icon: false
              state: false
              legend: false
              fill: fade
      - type: custom:vertical-stack-in-card
        title: Küche
        cards:
          - type: grid
            square: false
            columns: 2
            cards:
              - type: custom:mushroom-entity-card
                entity: sensor.netatmo_innen_temperature
                primary_info: state
                secondary_info: name
                name: Temperature
                icon_color: green
              - type: custom:mushroom-entity-card
                entity: sensor.netatmo_innen_humidity
                primary_info: state
                secondary_info: name
                name: Humidity
                icon_color: blue
          - type: custom:mini-graph-card
            entities:
              - entity: sensor.netatmo_innen_temperature
                name: Temperature
                color: var(--green-color)
              - entity: sensor.netatmo_innen_humidity
                name: Humidity
                color: var(--blue-color)
                y_axis: secondary
            hours_to_show: 24
            line_width: 3
            font_size: 50
            animate: true
            show:
              name: false
              icon: false
              state: false
              legend: false
              fill: fade
      - type: custom:vertical-stack-in-card
        title: Wohnzimmer
        cards:
          - type: grid
            square: false
            columns: 2
            cards:
              - type: custom:mushroom-entity-card
                entity: sensor.sensor_wohnzimmer_temperature
                primary_info: state
                secondary_info: name
                name: Temperature
                icon_color: green
              - type: custom:mushroom-entity-card
                entity: sensor.sensor_wohnzimmer_humidity
                primary_info: state
                secondary_info: name
                name: Humidity
                icon_color: blue
          - type: custom:mini-graph-card
            entities:
              - entity: sensor.sensor_wohnzimmer_temperature
                name: Temperature
                color: var(--green-color)
              - entity: sensor.sensor_wohnzimmer_humidity
                name: Humidity
                color: var(--blue-color)
                y_axis: secondary
            hours_to_show: 24
            line_width: 3
            font_size: 50
            animate: true
            show:
              name: false
              icon: false
              state: false
              legend: false
              fill: fade
      - chart_type: line
        period: day
        type: statistics-graph
        entities:
          - sensor.netatmo_draussen_temperature
        stat_types:
          - mean
          - min
          - max
        days_to_show: 14
        hide_legend: true
        title: Temperaturverlauf Draußen
      - type: custom:auto-entities
        card:
          type: entities
          title: Temperatur-Sensoren
          state_color: false
          show_header_toggle: true
        filter:
          include:
            - entity_id: sensor.*_temperature
          exclude:
            - entity_id: sensor.ceed*
            - entity_id: sensor.cpu*
            - entity_id: sensor.processor*
        sort:
          method: friendly_name
      - type: custom:battery-state-card
        title: Batteriestand
        secondary_info: '{last_changed}'
        filter:
          include:
            - name: attributes.device_class
              value: battery
          exclude:
            - name: entity_id
              value: binary_sensor.*
        sort:
          by: state
        collapse: 12
      - type: entities
        title: Feuchtigkeit
        entities:
          - entity: sensor.netatmo_draussen_humidity
            name: Aussen
            card_mod:
              style: |
                :host {
                  color:
                    {% if states(config.entity) | float <= 55 %} 
                      default
                    {% elif states(config.entity) | float >= 65 %}
                      red
                    {% endif %}
                    ;
                }
          - entity: sensor.netatmo_innen_humidity
            name: Küche
            card_mod:
              style: |
                :host {
                  color:
                    {% if states(config.entity) | float <= 55 %} 
                      default
                    {% elif states(config.entity) | float >= 65 %}
                      red
                    {% endif %}
                    ;
                }
          - entity: sensor.sensor_bad_humidity
            name: Badzimmer
            card_mod:
              style: |
                :host {
                  color:
                    {% if states(config.entity) | float <= 55 %} 
                      default
                    {% elif states(config.entity) | float >= 65 %}
                      red
                    {% endif %}
                    ;
                } 
          - entity: sensor.sensor_buro_humidity
            name: Büro
            card_mod:
              style: |
                :host {
                  color:
                    {% if states(config.entity) | float <= 55 %} 
                      default
                    {% elif states(config.entity) | float >= 65 %}
                      red
                    {% endif %}
                    ;
                } 
          - entity: sensor.sensor_wohnzimmer_humidity
            name: Wohnzimmer
            card_mod:
              style: |
                :host {
                  color:
                    {% if states(config.entity) | float <= 55 %} 
                      default
                    {% elif states(config.entity) | float >= 65 %}
                      red
                    {% endif %}
                    ;
                }        
          - entity: sensor.wc_og_humidity
            name: WC-OG
            card_mod:
              style: |
                :host {
                  color:
                    {% if states(config.entity) | float <= 55 %} 
                      default
                    {% elif states(config.entity) | float >= 65 %}
                      red
                    {% endif %}
                    ;
                } 
      - type: custom:auto-entities
        card:
          type: entities
          card_mod:
            style: |
              :host {
                color:
                  {% if states(config.entity) | float <= 55 %} 
                    white
                  {% elif states(config.entity) | float >= 65 %}
                    red
                  {% endif %}
                  ;
              }
          cards:
            type: entities
        filter:
          include:
            - entity_id: '*humidity'
          exclude: []
        sort:
          method: state
          numeric: true
          reverse: true
      - type: vertical-stack
        cards:
          - type: custom:bubble-card
            card_type: climate
            entity: climate.heizung_bad
            sub_button:
              - name: HVAC modes menu
                select_attribute: hvac_modes
                show_arrow: false
              - name: Climate temperature
                show_attribute: true
                attribute: temperature
                icon: mdi:thermometer
                state_background: false
              - name: Adjust Temperature
                icon: mdi:plus
                tap_action:
                  action: call-service
                  service: climate.set_temperature
                  service_data:
                    entity_id: climate.heizung_bad
                    temperature: '{{ state_attr(''climate.heizung_bad'', ''temperature'') + 1 }}'
              - name: Decrease Temperature
                icon: mdi:minus
                tap_action:
                  action: call-service
                  service: climate.set_temperature
                  service_data:
                    entity_id: climate.heizung_bad
                    temperature: '{{ state_attr(''climate.heizung_bad'', ''temperature'') - 1 }}'
            name: Bad OG
            show_attribute: false
            show_state: false
          - type: custom:bubble-card
            card_type: button
            button_type: state
            entity: climate.betterthermostat_bad
            show_background: false
            sub_button:
              - entity: climate.betterthermostat_bad
                show_state: false
                state_background: false
                show_attribute: true
                attribute: hvac_modes
                show_background: true
                show_last_changed: false
              - entity: climate.betterthermostat_bad
                state_background: false
                show_last_changed: false
                show_attribute: true
                show_state: false
                attribute: current_temperature
                icon: mdi:thermometer
              - entity: climate.betterthermostat_bad
                show_attribute: true
            name: Badezimmer
            styles: ''
          - type: custom:bubble-card
            card_type: button
            button_type: state
            entity: binary_sensor.fenster_bad_contact
            show_background: false
            sub_button:
              - entity: sensor.sensor_bad_humidity
                show_state: true
                state_background: false
              - entity: sensor.sensor_bad_temperature
                state_background: false
                show_last_changed: false
                show_attribute: false
                show_state: true
            name: Fenster Bad
            styles: ''
          - type: custom:mini-graph-card
            entities:
              - entity: sensor.sensor_bad_temperature
                name: Temperature
                color: '#fc5e03'
              - entity: sensor.sensor_bad_humidity
                name: Humidity
                color: '#03a9fc'
                y_axis: secondary
            height: 100
            hours_to_show: 24
            points_per_hour: 1
            line_width: 1
            font_size: 50
            animate: true
            smoothing: true
            show:
              name: false
              icon: false
              state: null
              legend: false
              fill: fade
          - type: custom:bubble-card
            card_type: empty-column
            card_layout: large-2-rows
  - title: Licht
    path: licht
    icon: mdi:ceiling-light-multiple
    type: custom:horizontal-layout
    badges: []
    cards:
      - type: vertical-stack
        cards:
          - type: custom:mushroom-title-card
            title: Licht
          - type: custom:mushroom-chips-card
            chips:
              - type: template
                entity: binary_sensor.motion_flurog_occupancy
                icon_color: '{{ ''green'' if is_state(entity, ''on'') else ''red'' }}'
                icon: >-
                  {{ 'mdi:motion-sensor' if is_state(entity, 'on') else
                  'mdi:motion-sensor-off' }}
                content: FlurOG
              - type: entity
                entity: sensor.motion_flurog_illuminance
                icon: mdi:sun-wireless-outline
              - type: template
                entity: binary_sensor.flureg_occupancy
                icon_color: '{{ ''green'' if is_state(entity, ''on'') else ''red'' }}'
                icon: >-
                  {{ 'mdi:motion-sensor' if is_state(entity, 'on') else
                  'mdi:motion-sensor-off' }}
                content: FlurEG
              - type: entity
                entity: sensor.flureg_illuminance
                icon: mdi:sun-wireless-outline
            alignment: center
          - type: horizontal-stack
            cards:
              - type: custom:mushroom-light-card
                entity: light.flur_og
                use_light_color: true
                show_brightness_control: true
                show_color_control: true
                show_color_temp_control: true
                collapsible_controls: true
              - type: custom:mushroom-light-card
                entity: light.flur_eg
                use_light_color: true
                show_color_temp_control: true
                collapsible_controls: true
                show_color_control: true
                show_brightness_control: true
                name: Flur EG
      - type: horizontal-stack
        cards:
          - type: custom:mushroom-light-card
            entity: light.buro_screenbar_main
            use_light_color: true
            show_brightness_control: true
            show_color_temp_control: true
            show_color_control: true
            collapsible_controls: false
            name: Büro Hauptlicht
          - type: custom:mushroom-light-card
            entity: light.buro_screenbar_ambilight
            use_light_color: true
            show_brightness_control: true
            show_color_temp_control: true
            show_color_control: true
            name: Büro Ambilight
      - show_name: true
        show_icon: true
        type: button
        tap_action:
          action: toggle
          confirmation:
            text: Licht umschalten?
        entity: light.wohnzimmer_beleuchtung
        show_state: true
      - show_name: true
        show_icon: true
        type: button
        tap_action:
          action: toggle
          confirmation:
            text: Licht umschalten?
        icon: ''
        show_state: true
        entity: light.gartenbeleuchtung
      - type: custom:layout-card
        layout_type: custom:grid-layout
        cards:
          - type: custom:layout-card
            layout_type: custom:grid-layout
            layout:
              margin: 0
            cards:
              - square: false
                type: grid
                cards:
                  - type: custom:mushroom-template-card
                    primary: Wohnzimmer
                    secondary: >-
                      {% if
                      expand('light.wohnzimmer_beleuchtung')|selectattr('state',
                      'eq','on')| list|count > 0 %}  {{
                      expand('light.wohnzimmer_beleuchtung')|selectattr('state',
                      'eq','on')| list|count }} An {% else %} Aus {% endif %}
                    icon: |-
                      {% if is_state('light.wohnzimmer_beleuchtung', 'on') %}
                        mdi:lamps
                      {% else %}
                        mdi:lamps
                      {% endif %}
                    icon_color: |-
                      {% if is_state('light.wohnzimmer_beleuchtung', 'on') %}
                        var(--rgb-accent-color)
                      {% endif %}
                    badge_icon: ''
                    entity: light.wohnzimmer_beleuchtung
                    tap_action:
                      action: fire-dom-event
                      browser_mod:
                        service: browser_mod.popup
                        data:
                          title: Wohnzimmer
                          size: normal
                          content:
                            type: custom:layout-card
                            layout_type: custom:grid-layout
                            layout:
                              margin: 0
                            cards:
                              - type: custom:vertical-stack-in-card
                                cards:
                                  - type: entities
                                    entities:
                                      - entity: light.wohnzimmer_kommode
                                        name: Kommode
                                        secondary_info: last-changed
                                      - entity: light.wohnzimmer_beleuchtung_tv_outlet
                                        name: Vitrine TV
                                        secondary_info: last-changed
                                      - entity: light.wohnzimmer_lampe_links_outlet
                                        name: Stehlampe links
                                        secondary_info: last-changed
                                      - entity: light.wohnzimmer_lampe_rechts_outlet
                                        name: Stehlampe rechts
                                        secondary_info: last-changed
                                      - entity: light.yl_wohnzimmer
                                        name: Yeelight Board links
                                        secondary_info: last-changed
                                      - entity: light.wohnzimmer_led_stripe
                                        name: LED-Stripe TV
                                        secondary_info: last-changed
                                  - type: history-graph
                                    entities:
                                      - entity: light.wohnzimmer_kommode
                                        name: Kommode
                                      - entity: light.wohnzimmer_beleuchtung_tv_outlet
                                        name: Vitrine TV
                                      - entity: light.wohnzimmer_lampe_links_outlet
                                        name: Stehlampe links
                                      - entity: light.wohnzimmer_lampe_rechts_outlet
                                        name: Stehlampe rechts
                                      - entity: light.yl_wohnzimmer
                                        name: Yeelight Board links
                                      - entity: light.wohnzimmer_led_stripe
                                        name: LED-Stripe TV
                                    title: Verlauf
                                    hours_to_show: 24
                                columns: 1
                  - type: custom:mushroom-template-card
                    primary: Flur
                    secondary: >-
                      {% if expand('light.flurbeleuchtung')|selectattr('state',
                      'eq','on')| list|count > 0 %}  {{
                      expand('light.flurbeleuchtung')|selectattr('state',
                      'eq','on')| list|count }} An {% else %} Aus {% endif %}
                    icon: |-
                      {% if is_state('light.flurbeleuchtung', 'on') %}
                        mdi:floor-lamp
                      {% else %}
                        mdi:floor-lamp
                      {% endif %}
                    icon_color: |-
                      {% if is_state('light.flurbeleuchtung', 'on') %}
                        var(--rgb-accent-color)
                      {% endif %}
                    badge_icon: ''
                    entity: light.flurbeleuchtung
                    tap_action:
                      action: fire-dom-event
                      browser_mod:
                        service: browser_mod.popup
                        data:
                          title: Flur
                          size: normal
                          content:
                            type: custom:layout-card
                            layout_type: custom:grid-layout
                            layout:
                              margin: 0
                            cards:
                              - type: custom:vertical-stack-in-card
                                cards:
                                  - type: entities
                                    entities:
                                      - entity: light.flur_eg
                                        name: Flur EG
                                        secondary_info: last-changed
                                      - entity: binary_sensor.flureg_occupancy
                                        name: Flur EG - Motion
                                        secondary_info: last-changed
                                      - entity: sensor.flureg_illuminance
                                        name: Flur EG - Lux
                                        secondary_info: last-changed
                                      - entity: light.flur_og
                                        name: Flur OG
                                        secondary_info: last-changed
                                      - entity: binary_sensor.motion_flurog_occupancy
                                        name: Flur OG - Motion
                                        secondary_info: last-changed
                                      - entity: sensor.motion_flurog_illuminance
                                        name: Flur OG - Lux
                                        secondary_info: last-changed
                                  - type: history-graph
                                    entities:
                                      - entity: light.flur_eg
                                        name: Flur EG
                                      - entity: light.flur_og
                                        name: Flur OG
                                    title: Verlauf
                                    hours_to_show: 24
                                columns: 1
                  - type: custom:mushroom-template-card
                    primary: Schlafzimmer
                    secondary: >-
                      {% if
                      expand('light.nachtlicht_schlafzimmer')|selectattr('state',
                      'eq','on')| list|count > 0 %}  {{
                      expand('light.nachtlicht_schlafzimmer')|selectattr('state',
                      'eq','on')| list|count }} An {% else %} Aus {% endif %}
                    icon: |-
                      {% if is_state('light.nachtlicht_schlafzimmer', 'on') %}
                        mdi:lamp
                      {% else %}
                        mdi:lamp
                      {% endif %}
                    icon_color: |-
                      {% if is_state('light.nachtlicht_schlafzimmer', 'on') %}
                        var(--rgb-accent-color)
                      {% endif %}
                    badge_icon: ''
                    entity: light.nachtlicht_schlafzimmer
                    tap_action:
                      action: fire-dom-event
                      browser_mod:
                        service: browser_mod.popup
                        data:
                          title: Schlafzimmer
                          size: normal
                          content:
                            type: custom:layout-card
                            layout_type: custom:grid-layout
                            layout:
                              margin: 0
                            cards:
                              - type: custom:vertical-stack-in-card
                                cards:
                                  - type: entities
                                    entities:
                                      - entity: light.andrea_nachttisch
                                        name: Andrea
                                        secondary_info: last-changed
                                      - entity: light.daniel_nachttisch_light
                                        name: Daniel
                                        secondary_info: last-changed
                                  - type: history-graph
                                    entities:
                                      - entity: light.andrea_nachttisch
                                        name: Andrea
                                      - entity: light.daniel_nachttisch_light
                                        name: Daniel
                                    title: Verlauf
                                    hours_to_show: 24
                                columns: 1
                  - type: custom:mushroom-template-card
                    primary: Garten
                    icon: |-
                      {% if is_state('light.gartenbeleuchtung', 'on') %}
                        phu:light-string
                      {% else %}
                        phu:light-string
                      {% endif %}
                    icon_color: |-
                      {% if is_state('light.gartenbeleuchtung', 'on') %}
                        var(--rgb-accent-color)
                      {% endif %}
                    badge_icon: ''
                    entity: light.gartenbeleuchtung
                    tap_action:
                      confirmation:
                        text: Licht umschalten?
                      action: toggle
                columns: 2
        layout: {}
        view_layout:
          grid-area: row2
      - type: entities
        entities:
          - entity: light.wohnzimmer_beleuchtung_tv_outlet
            name: Vitrine TV
          - entity: light.wohnzimmer_led_stripe
            name: LED-Stripe TV
          - entity: light.wohnzimmer_lampe_links_outlet
            name: Stehlampe links
          - entity: light.wohnzimmer_lampe_rechts_outlet
            name: Stehlampe rechts
          - entity: light.yl_wohnzimmer
            name: Yeelight Board
          - entity: light.wohnzimmer_kommode
            name: Kommode
        title: Licht Wohnzimmer
        state_color: true
      - type: custom:mushroom-light-card
        use_light_color: true
        show_brightness_control: true
        show_color_temp_control: true
        show_color_control: true
        collapsible_controls: false
        entity: light.wohnzimmer_led_stripe
      - type: custom:mushroom-light-card
        use_light_color: true
        show_brightness_control: true
        show_color_temp_control: true
        show_color_control: true
        collapsible_controls: false
        entity: light.andrea_nachttisch
      - type: light
        entity: light.yl_wohnzimmer
      - type: light
        entity: light.flur_eg
        name: Flur EG
      - type: light
        entity: light.flur_og
      - type: light
        entity: light.wohnzimmer_kommode
      - type: light
        entity: light.buro_screenbar_main
      - type: entities
        entities:
          - entity: light.xmas_garten
            name: X-mas Garten
          - entity: light.xmasbaumvorn
            name: X-mas Vorne
          - entity: light.xmas_baum
            name: X-mas Baum
          - entity: automation.x_mas_outdoor_licht
            name: X-mas Automation
        title: X-mas Licht
        state_color: true
  - title: Server
    path: server
    icon: mdi:nas
    cards: []
    type: sections
    sections:
      - type: grid
        cards:
          - type: heading
            heading: HA Server
          - type: custom:stack-in-card
            cards:
              - type: custom:apexcharts-card
                chart_type: radialBar
                series:
                  - entity: sensor.cpu_temperature
                    color: rgb(255, 87, 34)
                    max: 90
                    show:
                      legend_value: false
                apex_config:
                  plotOptions:
                    radialBar:
                      offsetY: 0
                      startAngle: -108
                      endAngle: 108
                      hollow:
                        size: 70%
                      dataLabels:
                        name:
                          show: false
                        value:
                          show: false
                      track:
                        strokeWidth: 90%
                        margin: 0
                  fill:
                    type: gradient
                    gradient:
                      shade: light
                      type: horizontal
                      shadeIntensity: 0.3
                      inverseColors: false
                      opacityFrom: 1
                      opacityTo: 1
                      stops:
                        - 0
                        - 50
                        - 55
                        - 90
                  legend:
                    show: false
                  chart:
                    height: 240
              - type: custom:mushroom-entity-card
                entity: sensor.cpu_temperature
                primary_info: state
                secondary_info: name
                name: HA CPU
                icon_color: deep-orange
                layout: vertical
                card_mod:
                  style: |
                    ha-card {
                      margin-top: -120px;
                      width: 120px;
                      margin-left: auto;
                      margin-right: auto;
                      border-color: transparent;
                    }
          - type: vertical-stack
            cards:
              - type: custom:uptime-card
                entity: binary_sensor.homeassistant
                icon: mdi:home
                ko_icon: mdi:home-off
                title_template: Home Assistant
                duration:
                  quantity: 1
                  unit: day
                status_adaptive_color: true
                color:
                  ok: steelblue
                  ko: orangered
                alias:
                  ok: Online
                  ko: Offline
                show:
                  icon: true
                  status: true
                  timeline: true
                  average: true
                tooltip:
                  hour24: true
                tap_action: {}
                blink: {}
          - type: custom:vertical-stack-in-card
            title: Homeassistant Server
            cards:
              - type: horizontal-stack
                cards:
                  - type: custom:mini-graph-card
                    entities:
                      - sensor.processor_use
                    name: CPU
                    line_color: '#2980b9'
                    line_width: 2
                    hours_to_show: 24
                  - type: custom:mini-graph-card
                    entities:
                      - sensor.cpu_temperature
                    name: Temp
                    line_color: '#2980b9'
                    line_width: 2
                    hours_to_show: 24
              - type: custom:bar-card
                entity: sensor.disk_use_percent
                name: HDD
                positions:
                  icon: outside
                  name: inside
                color: '#00ba6a'
              - type: custom:bar-card
                entity: sensor.memory_use_percent
                name: RAM
                positions:
                  icon: outside
                  name: inside
              - type: entities
                entities:
                  - entity: sensor.ipv4_address_eno1
                    name: IP-Adresse
                  - entity: update.home_assistant_operating_system_update
                    attribute: installed_version
                    name: HA Version
                    icon: mdi:update
                  - entity: update.home_assistant_supervisor_update
                    name: Addon Updates
                    icon: mdi:cart-plus
                    tap_action:
                      action: navigate
                      navigation_path: /hassio/dashboard
                    style: |
                      :host {
                        {% if states(config.entity) != '0' %}
                          color: rgb(255, 165, 0);
                          --paper-item-icon-color: rgb(255, 165, 0);
                          {% endif %};
                        }
          - type: vertical-stack
            cards:
              - type: custom:mushroom-title-card
                title: InfluxDB
                subtitle: >-
                  Installed v{{ states('sensor.influxdb_version') }} - Latest
                  v{{ states('sensor.influxdb_newest_version') }}  
              - type: custom:mushroom-chips-card
                chips:
                  - type: entity
                    entity: binary_sensor.influxdb_running
                    icon_color: green
                  - type: entity
                    entity: sensor.influxdb_version
                    icon_color: green
                    icon: mdi:package-variant-closed
                  - type: entity
                    entity: sensor.influxdb_cpu_percent
                    icon_color: blue
                  - type: entity
                    entity: sensor.influxdb_memory_percent
                    icon_color: orange
                  - type: entity
                    entity: sensor.influxdb_db_size
              - type: custom:mushroom-update-card
                entity: update.influxdb_update
                show_buttons_control: true
                icon_type: entity-picture
                layout: horizontal
              - type: custom:bar-card
                name: HDD
                positions:
                  icon: outside
                  name: inside
                color: '#00ba6a'
                entities:
                  - entity: sensor.influxdb_db_size
          - type: vertical-stack
            cards:
              - type: custom:mushroom-title-card
                title: ''
                subtitle: >
                  Core v{{ state_attr('update.home_assistant_core_update',
                  'installed_version') }} - OS v{{
                  states('sensor.home_assistant_operating_system_version') }} -
                  Supervisor v{{
                  state_attr('update.home_assistant_supervisor_update',
                  'installed_version') }}
              - type: custom:mushroom-chips-card
                chips:
                  - type: entity
                    entity: sensor.cpu_temperature
                    icon_color: orange
                  - type: entity
                    entity: sensor.processor_use
                    icon_color: blue
                  - type: entity
                    entity: sensor.memory_use_percent
                    icon_color: orange
                  - type: entity
                    entity: sensor.disk_use
                    icon_color: deep-purple
                  - type: entity
                    entity: sensor.network_in_eno1
                    icon_color: green
              - type: horizontal-stack
                cards:
                  - type: custom:mushroom-update-card
                    entity: update.home_assistant_core_update
                    name: HA Core
                    show_buttons_control: true
                    icon_type: entity-picture
                  - type: custom:mushroom-template-card
                    primary: Version Information
                    secondary: >-
                      Installed v{{
                      state_attr('update.home_assistant_core_update',
                      'installed_version')}}

                      Latest v{{ state_attr('update.home_assistant_core_update',
                      'latest_version')}}
                    icon: mdi:package-variant-closed
                    multiline_secondary: true
                    fill_container: true
                    entity: update.home_assistant_core_update
                    tap_action:
                      action: more-info
                    icon_color: >-
                      {% if is_state('update.home_assistant_core_update', 'on')
                      %}
                        orange
                      {% else %}
                        green
                      {% endif %}
                    badge_color: >-
                      {% if is_state('update.home_assistant_core_update', 'on')
                      %}
                        red
                      {% else %}
                        blue
                      {% endif %}
                    badge_icon: >-
                      {% if is_state('update.home_assistant_core_update', 'on')
                      %}
                        mdi:help
                      {% else %}
                        mdi:check-bold
                      {% endif %}
              - type: horizontal-stack
                cards:
                  - type: custom:mushroom-update-card
                    entity: update.home_assistant_operating_system_update
                    name: HA OS
                    show_buttons_control: true
                    icon_type: entity-picture
                  - type: custom:mushroom-template-card
                    primary: Version Information
                    secondary: >-
                      Installed v{{
                      states('sensor.home_assistant_operating_system_version')}}

                      Latest v{{
                      states('sensor.home_assistant_operating_system_newest_version')}}
                    icon: mdi:package-variant-closed
                    multiline_secondary: true
                    fill_container: true
                    entity: update.home_assistant_operating_system_update
                    tap_action:
                      action: more-info
                    icon_color: >-
                      {% if
                      is_state('update.home_assistant_operating_system_update',
                      'on') %}
                        orange
                      {% else %}
                        green
                      {% endif %}
                    badge_color: >-
                      {% if
                      is_state('update.home_assistant_operating_system_update',
                      'on') %}
                        red
                      {% else %}
                        blue
                      {% endif %}
                    badge_icon: >-
                      {% if
                      is_state('update.home_assistant_operating_system_update',
                      'on') %}
                        mdi:help
                      {% else %}
                        mdi:check-bold
                      {% endif %}
              - type: horizontal-stack
                cards:
                  - type: custom:mushroom-update-card
                    entity: update.home_assistant_supervisor_update
                    name: HA Supervisor
                    show_buttons_control: true
                    icon_type: entity-picture
                  - type: custom:mushroom-template-card
                    primary: Version Information
                    secondary: >-
                      Installed v{{
                      state_attr('update.home_assistant_supervisor_update',
                      'installed_version')}}

                      Latest v{{
                      state_attr('update.home_assistant_supervisor_update',
                      'latest_version')}}
                    icon: mdi:package-variant-closed
                    multiline_secondary: true
                    fill_container: true
                    entity: update.home_assistant_core_update
                    tap_action:
                      action: more-info
                    icon_color: >-
                      {% if is_state('update.home_assistant_supervisor_update',
                      'on') %}
                        orange
                      {% else %}
                        green
                      {% endif %}
                    badge_color: >-
                      {% if is_state('update.home_assistant_supervisor_update',
                      'on') %}
                        red
                      {% else %}
                        blue
                      {% endif %}
                    badge_icon: >-
                      {% if is_state('update.home_assistant_supervisor_update',
                      'on') %}
                        mdi:help
                      {% else %}
                        mdi:check-bold
                      {% endif %}
          - type: vertical-stack
            cards:
              - type: custom:mushroom-title-card
                title: HACS Updates
                subtitle: >-
                  Installed v{{ state_attr('update.hacs_update',
                  'installed_version') }} - Latest v{{
                  state_attr('update.hacs_update', 'latest_version') }}
              - type: custom:mushroom-chips-card
                chips:
                  - type: template
                    icon: mdi:web
                    icon_color: blue
                    content: Release Changelog
                    tap_action:
                      action: url
                      url_path: https://github.com/hacs/integration/releases
                  - type: template
                    entity: update.hacs_update
                    content: >-
                      Installed v{{ state_attr('update.hacs_update',
                      'installed_version') }}
                    icon_color: green
                    icon: mdi:package-variant-closed
                    tap_action:
                      action: none
                  - type: template
                    entity: update.hacs_update
                    content: >-
                      Latest v{{ state_attr('update.hacs_update',
                      'latest_version') }}
                    icon_color: orange
                    icon: mdi:package-variant-closed
                    tap_action:
                      action: none
              - type: custom:mushroom-update-card
                entity: update.hacs_update
                layout: horizontal
                show_buttons_control: true
              - type: custom:mushroom-update-card
                entity: update.mushroom_update
                show_buttons_control: true
                icon_type: icon
                layout: horizontal
                name: Mushroom
              - type: custom:mushroom-update-card
                entity: update.mini_graph_card_update
                show_buttons_control: true
                name: Mini Graph Card
                layout: horizontal
              - type: custom:mushroom-update-card
                entity: update.rademacher_homepilot_bridge_update
                name: Rademacher Jalousien
                layout: horizontal
                show_buttons_control: true
              - type: custom:mushroom-update-card
                entity: update.button_card_update
                name: Button Card
                layout: horizontal
                show_buttons_control: true
              - type: custom:mushroom-update-card
                entity: update.vertical_stack_in_card_update
                name: Vertical Stack in Card
                layout: horizontal
                show_buttons_control: true
              - type: custom:mushroom-update-card
                entity: update.waste_collection_schedule_update
                name: Waste Collection Schedule
                layout: horizontal
                show_buttons_control: true
              - type: custom:mushroom-update-card
                entity: update.yeelight_bluetooth_update
                name: Yeelight Bluetooth
                layout: horizontal
                show_buttons_control: true
              - type: custom:mushroom-update-card
                entity: update.watchman_update
                name: Watchman
                layout: horizontal
                show_buttons_control: true
      - type: grid
        cards:
          - type: heading
            heading: Synology Server
          - type: custom:stack-in-card
            cards:
              - type: custom:apexcharts-card
                chart_type: radialBar
                series:
                  - entity: sensor.diskstation_temperatur_2
                    color: rgb(255, 87, 34)
                    max: 90
                    show:
                      legend_value: false
                apex_config:
                  plotOptions:
                    radialBar:
                      offsetY: 0
                      startAngle: -108
                      endAngle: 108
                      hollow:
                        size: 70%
                      dataLabels:
                        name:
                          show: false
                        value:
                          show: false
                      track:
                        strokeWidth: 90%
                        margin: 0
                  fill:
                    type: gradient
                    gradient:
                      shade: light
                      type: horizontal
                      shadeIntensity: 0.3
                      inverseColors: false
                      opacityFrom: 1
                      opacityTo: 1
                      stops:
                        - 0
                        - 50
                        - 55
                        - 90
                  legend:
                    show: false
                  chart:
                    height: 240
              - type: custom:mushroom-entity-card
                entity: sensor.diskstation_temperatur_2
                primary_info: state
                secondary_info: name
                name: Diskstation CPU
                icon_color: deep-orange
                layout: vertical
                card_mod:
                  style: |
                    ha-card {
                      margin-top: -120px;
                      width: 120px;
                      margin-left: auto;
                      margin-right: auto;
                      border-color: transparent;
                    }
          - type: vertical-stack
            cards:
              - type: custom:uptime-card
                entity: binary_sensor.diskstation_1515
                icon: mdi:home
                ko_icon: mdi:home-off
                title_template: Synology DS1515+
                duration:
                  quantity: 1
                  unit: day
                status_adaptive_color: true
                color:
                  ok: steelblue
                  ko: orangered
                alias:
                  ok: Online
                  ko: Offline
                show:
                  icon: true
                  status: true
                  timeline: true
                  average: true
                tooltip:
                  hour24: true
                tap_action: {}
                blink: {}
          - type: custom:vertical-stack-in-card
            title: Synology Diskstation
            cards:
              - type: horizontal-stack
                cards:
                  - type: custom:mini-graph-card
                    entities:
                      - sensor.diskstation_cpu_auslastung_gesamt_2
                    name: CPU
                    line_color: '#2980b9'
                    line_width: 2
                    hours_to_show: 24
                  - type: custom:mini-graph-card
                    entities:
                      - sensor.diskstation_temperatur_2
                    name: Temp
                    line_color: '#2980b9'
                    line_width: 2
                    hours_to_show: 24
              - type: custom:bar-card
                name: HDD
                positions:
                  icon: outside
                  name: inside
                color: '#00ba6a'
                entities:
                  - entity: sensor.diskstation_volume_1_verwendetes_volumen_2
              - type: custom:bar-card
                entity: >-
                  sensor.diskstation_volume_1_durchschnittliche_festplattentemperatur_2
                name: HDD Temps
                positions:
                  icon: outside
                  name: inside
                color: '#FF9800'
              - type: custom:bar-card
                entity: sensor.diskstation_speichernutzung_real_2
                name: RAM
                positions:
                  icon: outside
                  name: inside
              - type: entities
                entities:
                  - entity: sensor.diskstation_volume_1_status_2
                    name: HDD Zustand
                  - entity: update.diskstation_dsm_update_2
                    name: DSM Version
                    icon: mdi:update
                  - entity: button.diskstation_shutdown_2
                  - entity: button.diskstation_reboot_2
          - type: vertical-stack
            cards:
              - type: custom:uptime-card
                entity: binary_sensor.diskstation_120j
                icon: mdi:home
                ko_icon: mdi:home-off
                title_template: DS120J NAS
                duration:
                  quantity: 1
                  unit: week
                status_adaptive_color: true
                color:
                  ok: steelblue
                  ko: orangered
                alias:
                  ok: Online
                  ko: Offline
                show:
                  icon: true
                  status: true
                  timeline: true
                  average: true
                tooltip:
                  hour24: true
                tap_action: {}
                blink: {}
      - type: grid
        cards:
          - type: heading
            heading: AdGuard Home
          - type: custom:stack-in-card
            cards:
              - type: custom:apexcharts-card
                chart_type: radialBar
                series:
                  - entity: sensor.raspi3_adguard_rpi_temp_raspberrypi3
                    color: rgb(255, 87, 34)
                    max: 90
                    show:
                      legend_value: false
                apex_config:
                  plotOptions:
                    radialBar:
                      offsetY: 0
                      startAngle: -108
                      endAngle: 108
                      hollow:
                        size: 70%
                      dataLabels:
                        name:
                          show: false
                        value:
                          show: false
                      track:
                        strokeWidth: 90%
                        margin: 0
                  fill:
                    type: gradient
                    gradient:
                      shade: light
                      type: horizontal
                      shadeIntensity: 0.3
                      inverseColors: false
                      opacityFrom: 1
                      opacityTo: 1
                      stops:
                        - 0
                        - 50
                        - 55
                        - 90
                  legend:
                    show: false
                  chart:
                    height: 240
              - type: custom:mushroom-entity-card
                entity: sensor.raspi3_adguard_rpi_temp_raspberrypi3
                primary_info: state
                secondary_info: name
                name: Raspi 3 CPU
                icon_color: deep-orange
                layout: vertical
                card_mod:
                  style: |
                    ha-card {
                      margin-top: -120px;
                      width: 120px;
                      margin-left: auto;
                      margin-right: auto;
                      border-color: transparent;
                    }
          - type: vertical-stack
            cards:
              - type: custom:uptime-card
                entity: binary_sensor.adguard
                icon: mdi:router-wireless
                ko_icon: mdi:router-wireless-off
                title_template: AdGuard Home
                duration:
                  quantity: 1
                  unit: day
                status_adaptive_color: true
                color:
                  ok: steelblue
                  ko: orangered
                alias:
                  ok: Online
                  ko: Offline
                show:
                  icon: true
                  status: true
                  timeline: true
                  average: true
                tooltip:
                  hour24: true
                tap_action: {}
                blink: {}
          - type: custom:vertical-stack-in-card
            title: AdGuard Home Server
            cards:
              - type: horizontal-stack
                cards:
                  - type: custom:mini-graph-card
                    entities:
                      - sensor.raspi3_adguard_rpi_cpu_use_raspberrypi3
                    name: CPU
                    line_color: '#2980b9'
                    line_width: 2
                    hours_to_show: 24
                  - type: custom:mini-graph-card
                    entities:
                      - sensor.raspi3_adguard_rpi_temp_raspberrypi3
                    name: Temp
                    line_color: '#2980b9'
                    line_width: 2
                    hours_to_show: 24
              - type: custom:bar-card
                entity: sensor.raspi3_adguard_rpi_disk_used_raspberrypi3
                name: HDD
                positions:
                  icon: outside
                  name: inside
                color: '#00ba6a'
              - type: custom:bar-card
                entity: sensor.raspi3_adguard_rpi_mem_used_raspberrypi3
                name: RAM
                positions:
                  icon: outside
                  name: inside
              - type: entities
                entities:
                  - sensor.adguard_home_dns_abfragen
                  - sensor.adguard_home_dns_abfragen_blockiert
                  - sensor.adguard_home_sperrverhaltnis_fur_dns_abfragen
                  - >-
                    sensor.adguard_home_durchschnittliche_verarbeitungsgeschwindigkeit
      - type: grid
        cards:
          - type: heading
            heading: Geräte Status
          - square: false
            type: grid
            columns: 2
            cards:
              - type: custom:vertical-stack-in-card
                cards:
                  - type: custom:mushroom-template-card
                    primary: Router
                    entity: binary_sensor.router
                    secondary: >
                      {% if is_state('binary_sensor.router', 'off') %} Offline
                      {% else %} Online {% endif %} 
                    tap_action:
                      action: more-info
                    icon: >
                      {% if is_state('binary_sensor.router', 'off') %}
                      mdi:router-wireless-off

                      {% else %}

                      mdi:router-wireless

                      {% endif %}
                    icon_color: |
                      {% if is_state('binary_sensor.router', 'off') %}
                        red
                      {% else %}
                        green
                      {% endif %}
                    vertical: true
              - type: custom:vertical-stack-in-card
                cards:
                  - type: custom:mushroom-template-card
                    primary: Büro
                    entity: binary_sensor.repeater_buro
                    secondary: >
                      {% if is_state('binary_sensor.repeater_buro', 'off') %}
                      Offline {% else %} Online {% endif %} 
                    tap_action:
                      action: more-info
                    icon: >
                      {% if is_state('binary_sensor.repeater_buro', 'off') %}
                      mdi:router-wireless

                      {% else %}

                      mdi:router-wireless

                      {% endif %}
                    icon_color: |
                      {% if is_state('binary_sensor.repeater_buro', 'off') %}
                        red
                      {% else %}
                        green
                      {% endif %}
                    vertical: true
              - type: custom:vertical-stack-in-card
                cards:
                  - type: custom:mushroom-template-card
                    primary: Phil
                    entity: binary_sensor.repeater_buro
                    secondary: >
                      {% if is_state('binary_sensor.repeater_zimmer_phil',
                      'off') %} Offline {% else %} Online {% endif %} 
                    tap_action:
                      action: more-info
                    icon: >
                      {% if is_state('binary_sensor.repeater_zimmer_phil',
                      'off') %} mdi:router-wireless

                      {% else %}

                      mdi:router-wireless

                      {% endif %}
                    icon_color: >
                      {% if is_state('binary_sensor.repeater_zimmer_phil',
                      'off') %}
                        red
                      {% else %}
                        green
                      {% endif %}
                    vertical: true
              - type: custom:vertical-stack-in-card
                cards:
                  - type: custom:mushroom-template-card
                    primary: Nick
                    entity: binary_sensor.repeater_buro
                    secondary: >
                      {% if is_state('binary_sensor.repeater_zimmer_nick',
                      'off') %} Offline {% else %} Online {% endif %} 
                    tap_action:
                      action: more-info
                    icon: >
                      {% if is_state('binary_sensor.repeater_zimmer_nick',
                      'off') %} mdi:router-wireless

                      {% else %}

                      mdi:router-wireless

                      {% endif %}
                    icon_color: >
                      {% if is_state('binary_sensor.repeater_zimmer_nick',
                      'off') %}
                        red
                      {% else %}
                        green
                      {% endif %}
                    vertical: true
              - type: custom:mushroom-template-card
                primary: AdGuard
                entity: binary_sensor.router
                secondary: >
                  {% if is_state('binary_sensor.adguard', 'off') %} Offline {%
                  else %} Online {% endif %} 
                tap_action:
                  action: more-info
                icon: >
                  {% if is_state('binary_sensor.adguard', 'off') %}
                  mdi:router-wireless-off

                  {% else %}

                  mdi:security

                  {% endif %}
                icon_color: |
                  {% if is_state('binary_sensor.adguard', 'off') %}
                    red
                  {% else %}
                    green
                  {% endif %}
                vertical: true
          - type: vertical-stack
            cards:
              - type: custom:uptime-card
                entity: binary_sensor.fritz_box_7590_verbindung
                icon: mdi:router-wireless
                ko_icon: mdi:router-wireless-off
                title_template: Router
                duration:
                  quantity: 1
                  unit: day
                status_adaptive_color: true
                color:
                  ok: steelblue
                  ko: orangered
                alias:
                  ok: Online
                  ko: Offline
                show:
                  icon: true
                  status: true
                  timeline: true
                  average: true
                tooltip:
                  hour24: true
                tap_action: {}
                blink: {}
          - type: vertical-stack
            cards:
              - type: custom:mushroom-title-card
                title: ZigBee2MQTT
                subtitle: >-
                  Installed v{{ states('sensor.zigbee2mqtt_version') }} - Latest
                  v{{ states('sensor.zigbee2mqtt_newest_version') }}  
              - type: custom:mushroom-chips-card
                chips:
                  - type: entity
                    entity: binary_sensor.zigbee2mqtt_running
                    icon_color: green
                  - type: entity
                    entity: sensor.zigbee2mqtt_version
                    icon_color: green
                    icon: mdi:package-variant-closed
                  - type: entity
                    entity: sensor.zigbee2mqtt_cpu_percent
                    icon_color: blue
                  - type: entity
                    entity: sensor.zigbee2mqtt_memory_percent
                    icon_color: orange
              - type: custom:mushroom-update-card
                entity: update.zigbee2mqtt_update
                show_buttons_control: true
                icon_type: entity-picture
                layout: horizontal
          - type: vertical-stack
            cards:
              - type: custom:mushroom-title-card
                title: BT Proxy
                subtitle: >-
                  Installed v{{ state_attr('update.m5_stack_flur_firmware',
                  'installed_version') }} - Latest v{{
                  state_attr('update.m5_stack_flur_firmware', 'latest_version')
                  }}}  
              - type: custom:mushroom-update-card
                entity: update.m5_stack_flur_firmware
                name: M5-Flur
                show_buttons_control: true
                icon_type: entity-picture
                layout: horizontal
              - type: custom:mushroom-update-card
                entity: update.m5_stack_wohnzimmer_firmware
                name: M5-Wohnzimmer
                show_buttons_control: true
                icon_type: entity-picture
                layout: horizontal
          - type: vertical-stack
            cards:
              - type: custom:uptime-card
                entity: binary_sensor.m5stack_bt_proxy
                icon: mdi:network
                ko_icon: mdi:network-off
                title_template: M5 BT Stack Proxy
                duration:
                  quantity: 1
                  unit: day
                status_adaptive_color: true
                color:
                  ok: steelblue
                  ko: orangered
                alias:
                  ok: Online
                  ko: Offline
                show:
                  icon: true
                  status: true
                  timeline: true
                  average: true
                tooltip:
                  hour24: true
                tap_action: {}
                blink: {}
          - type: vertical-stack
            cards:
              - type: custom:uptime-card
                entity: binary_sensor.rademacher_hub
                icon: mdi:window-shutter-open
                ko_icon: mdi:window-shutter
                title_template: Rademacher Rolladen Hub
                duration:
                  quantity: 1
                  unit: day
                status_adaptive_color: true
                color:
                  ok: steelblue
                  ko: orangered
                alias:
                  ok: Online
                  ko: Offline
                show:
                  icon: true
                  status: true
                  timeline: true
                  average: true
                tooltip:
                  hour24: true
                tap_action: {}
                blink: {}
          - type: vertical-stack
            cards:
              - type: custom:uptime-card
                entity: binary_sensor.xiaomi_gateway
                icon: mdi:network
                ko_icon: mdi:network-off
                title_template: Xiaomi Gateway Hub
                duration:
                  quantity: 1
                  unit: day
                status_adaptive_color: true
                color:
                  ok: steelblue
                  ko: orangered
                alias:
                  ok: Online
                  ko: Offline
                show:
                  icon: true
                  status: true
                  timeline: true
                  average: true
                tooltip:
                  hour24: true
                tap_action: {}
                blink: {}
          - type: grid
            square: false
            columns: 2
            title: Computer Status
            cards:
              - type: custom:vertical-stack-in-card
                cards:
                  - type: custom:mushroom-template-card
                    primary: PC-Phil
                    entity: binary_sensor.pc_phil
                    secondary: >
                      {% if is_state('binary_sensor.pc_phil', 'off') %} Offline
                      {% else %} Online {% endif %} 
                    tap_action:
                      action: more-info
                    icon: >
                      {% if is_state('binary_sensor.pc_phil', 'off') %}
                      mdi:monitor-off

                      {% else %}

                      mdi:monitor

                      {% endif %}
                    icon_color: |
                      {% if is_state('binary_sensor.pc_phil', 'off') %}
                        red
                      {% else %}
                        green
                      {% endif %}
                    vertical: true
              - type: custom:vertical-stack-in-card
                cards:
                  - type: custom:mushroom-template-card
                    primary: PC-Nick
                    entity: binary_sensor.pc_nick
                    secondary: >
                      {% if is_state('binary_sensor.pc_nick', 'off') %} Offline
                      {% else %} Online {% endif %} 
                    tap_action:
                      action: more-info
                    icon: >
                      {% if is_state('binary_sensor.pc_nick', 'off') %}
                      mdi:monitor-off

                      {% else %}

                      mdi:monitor

                      {% endif %}
                    icon_color: |
                      {% if is_state('binary_sensor.pc_nick', 'off') %}
                        red
                      {% else %}
                        green
                      {% endif %}
                    vertical: true
              - type: custom:vertical-stack-in-card
                cards:
                  - type: custom:mushroom-template-card
                    primary: PC-Daniel
                    entity: binary_sensor.pc_daniel
                    secondary: >
                      {% if is_state('binary_sensor.pc_daniel', 'off') %}
                      Offline {% else %} Online {% endif %} 
                    tap_action:
                      action: more-info
                    icon: >
                      {% if is_state('binary_sensor.pc_daniel', 'off') %}
                      mdi:monitor-off

                      {% else %}

                      mdi:monitor

                      {% endif %}
                    icon_color: |
                      {% if is_state('binary_sensor.pc_daniel', 'off') %}
                        red
                      {% else %}
                        green
                      {% endif %}
                    vertical: true
              - type: custom:vertical-stack-in-card
                cards:
                  - type: custom:mushroom-template-card
                    primary: HomeAssistant
                    entity: binary_sensor.homeassistant
                    secondary: >
                      {% if is_state('binary_sensor.homeassistant', 'off') %}
                      Offline {% else %} Online {% endif %} 
                    tap_action:
                      action: more-info
                    icon: >
                      {% if is_state('binary_sensor.homeassistant', 'off') %}
                      mdi:home-off

                      {% else %}

                      mdi:home

                      {% endif %}
                    icon_color: |
                      {% if is_state('binary_sensor.homeassistant', 'off') %}
                        red
                      {% else %}
                        green
                      {% endif %}
                    vertical: true
              - type: custom:vertical-stack-in-card
                cards:
                  - type: custom:mushroom-template-card
                    primary: DS1515+ NAS
                    entity: binary_sensor.diskstation_1515
                    secondary: >
                      {% if is_state('binary_sensor.diskstation_1515', 'off') %}
                      Offline {% else %} Online {% endif %} 
                    tap_action:
                      action: more-info
                    icon: >
                      {% if is_state('binary_sensor.diskstation_1515', 'off') %}
                      mdi:server-off

                      {% else %}

                      mdi:server

                      {% endif %}
                    icon_color: |
                      {% if is_state('binary_sensor.diskstation_1515', 'off') %}
                        red
                      {% else %}
                        green
                      {% endif %}
                    vertical: true
              - type: custom:vertical-stack-in-card
                cards:
                  - type: custom:mushroom-template-card
                    primary: DS120J NAS
                    entity: binary_sensor.diskstation_120j
                    secondary: >
                      {% if is_state('binary_sensor.diskstation_120j', 'off') %}
                      Offline {% else %} Online {% endif %} 
                    tap_action:
                      action: more-info
                    icon: >
                      {% if is_state('binary_sensor.diskstation_120j', 'off') %}
                      mdi:server-off

                      {% else %}

                      mdi:server

                      {% endif %}
                    icon_color: |
                      {% if is_state('binary_sensor.diskstation_120j', 'off') %}
                        red
                      {% else %}
                        green
                      {% endif %}
                    vertical: true
          - type: vertical-stack
            cards:
              - type: vertical-stack
                cards:
                  - type: picture-elements
                    elements:
                      - type: conditional
                        conditions:
                          - entity: sensor.epson_xp_342_343_345_series
                            state_not: unavailable
                        elements:
                          - type: state-badge
                            entity: sensor.epson_xp_342_343_345_series
                            style:
                              top: 80%
                              left: 89%
                    image: /local/Epson-XP342.png
                  - type: conditional
                    conditions:
                      - entity: sensor.epson_xp_342_343_345_series
                        state_not: unavailable
                    card:
                      direction: up
                      entities:
                        - color: MediumTurquoise
                          entity: sensor.epson_xp_342_343_345_series_cyan_ink
                          name: Cyan
                        - color: MediumOrchid
                          entity: sensor.epson_xp_342_343_345_series_magenta_ink
                          name: Magenta
                        - color: Gold
                          entity: sensor.epson_xp_342_343_345_series_yellow_ink
                          name: Yellow
                        - color: Black
                          entity: sensor.epson_xp_342_343_345_series_black_ink
                          name: Black
                      height: 200px
                      positions:
                        icon: inside
                        title: outside
                        name: outside
                      max: 100
                      min: 0
                      padding: 2px
                      target: '5'
                      type: custom:bar-card
                      unit_of_measurement: '%'
                      stack: horizontal
                      title: EPSON XP-342
                      style: |-
                        bar-card-title {
                          text-shadow: 1px 1px 5px black;
                        }
                        bar-card-value {
                          text-shadow: 1px 1px 5px black;
                        }
                        bar-card-value {
                          color: white;
                        }
    max_columns: 4
  - type: sections
    title: Nutzung
    path: nutzung
    icon: mdi:clock-fast
    sections:
      - type: grid
        cards:
          - type: heading
            heading: Server Status
          - square: false
            type: grid
            columns: 2
            cards:
              - type: custom:vertical-stack-in-card
                cards:
                  - type: custom:mushroom-template-card
                    primary: HomeAssistant
                    entity: binary_sensor.homeassistant
                    secondary: >
                      {% if is_state('binary_sensor.homeassistant', 'off') %}
                      Offline {% else %} Online {% endif %} 
                    tap_action:
                      action: more-info
                    icon: >
                      {% if is_state('binary_sensor.homeassistant', 'off') %}
                      mdi:home-off

                      {% else %}

                      mdi:home

                      {% endif %}
                    icon_color: |
                      {% if is_state('binary_sensor.homeassistant', 'off') %}
                        red
                      {% else %}
                        green
                      {% endif %}
                    vertical: true
              - type: custom:vertical-stack-in-card
                cards:
                  - type: custom:mushroom-template-card
                    primary: AdGuard Home
                    entity: binary_sensor.adguard
                    secondary: >
                      {% if is_state('binary_sensor.adguard', 'off') %} Offline
                      {% else %} Online {% endif %} 
                    tap_action:
                      action: more-info
                    icon: >
                      {% if is_state('binary_sensor.adguard', 'off') %}
                      mdi:shield-off

                      {% else %}

                      mdi:shield

                      {% endif %}
                    icon_color: |
                      {% if is_state('binary_sensor.adguard', 'off') %}
                        red
                      {% else %}
                        green
                      {% endif %}
                    vertical: true
              - type: custom:vertical-stack-in-card
                cards:
                  - type: custom:mushroom-template-card
                    primary: DS1515+ NAS
                    entity: binary_sensor.diskstation_1515
                    secondary: >
                      {% if is_state('binary_sensor.diskstation_1515', 'off') %}
                      Offline {% else %} Online {% endif %} 
                    tap_action:
                      action: more-info
                    icon: >
                      {% if is_state('binary_sensor.diskstation_1515', 'off') %}
                      mdi:server-off {% else %} mdi:server {% endif %}
                    icon_color: |
                      {% if is_state('binary_sensor.diskstation_1515', 'off') %}
                        red
                      {% else %}
                        green
                      {% endif %}
                    vertical: true
              - type: custom:vertical-stack-in-card
                cards:
                  - type: custom:mushroom-template-card
                    primary: DS120J NAS
                    entity: binary_sensor.diskstation_120j
                    secondary: >
                      {% if is_state('binary_sensor.diskstation_120j', 'off') %}
                      Offline {% else %} Online {% endif %} 
                    tap_action:
                      action: more-info
                    icon: >
                      {% if is_state('binary_sensor.diskstation_120j', 'off') %}
                      mdi:server-off {% else %} mdi:server {% endif %}
                    icon_color: |
                      {% if is_state('binary_sensor.diskstation_120j', 'off') %}
                        red
                      {% else %}
                        green
                      {% endif %}
                    vertical: true
            title: Online
          - square: false
            type: grid
            columns: 2
            title: Heruntergefahren
            cards:
              - type: custom:vertical-stack-in-card
                cards:
                  - type: custom:mushroom-template-card
                    primary: HomeAssistant
                    entity: sensor.homeassistant_runtergefahren
                    secondary: >
                      {% if states('sensor.homeassistant_runtergefahren') ==
                      'unknown' %} {{ 'unbekannt'  }} {% else %} {{
                      as_timestamp(states.sensor.homeassistant_runtergefahren.state)
                      |    timestamp_custom(" %d.%m.%Y  %H:%M") }} {% endif %}
                    icon: >
                      {% if is_state('binary_sensor.homeassistant', 'off') %}
                      mdi:home-off

                      {% else %}

                      mdi:home

                      {% endif %}
                    icon_color: |
                      {% if is_state('binary_sensor.homeassistant', 'off') %}
                        red
                      {% else %}
                        green
                      {% endif %}
                    tap_action:
                      action: more-info
              - type: custom:vertical-stack-in-card
                cards:
                  - type: custom:mushroom-template-card
                    primary: AdGuard Home
                    entity: sensor.adguard_runtergefahren
                    secondary: >
                      {% if states('sensor.adguard_runtergefahren') == 'unknown'
                      %} {{ 'unbekannt'  }} {% else %} {{
                      as_timestamp(states.sensor.adguard_runtergefahren.state)
                      |    timestamp_custom(" %d.%m.%Y  %H:%M") }} {% endif %}
                    icon: >
                      {% if is_state('binary_sensor.adguard', 'off') %}
                      mdi:shield-off

                      {% else %}

                      mdi:shield

                      {% endif %}
                    icon_color: |
                      {% if is_state('binary_sensor.adguard', 'off') %}
                        red
                      {% else %}
                        green
                      {% endif %}
                    tap_action:
                      action: more-info
              - type: custom:vertical-stack-in-card
                cards:
                  - type: custom:mushroom-template-card
                    primary: NAS - DS1515+
                    entity: sensor.diskstation_runtergefahren
                    secondary: |
                      {{ states(entity) }}
                    icon: |
                      {% if is_state('binary_sensor.diskstation_1515', 'off') %}
                        mdi:server-off
                      {% else %}
                        mdi:server
                      {% endif %}
                    icon_color: |
                      {% if is_state('binary_sensor.diskstation_1515', 'off') %}
                        red
                      {% else %}
                        green
                      {% endif %}
                    tap_action:
                      action: more-info
              - type: custom:vertical-stack-in-card
                cards:
                  - type: custom:mushroom-template-card
                    primary: NAS - DS120J
                    entity: sensor.ds120j_runtergefahren
                    secondary: |
                      {{ states(entity) }}
                    icon: |
                      {% if is_state('binary_sensor.diskstation_120j', 'off') %}
                        mdi:server-off
                      {% else %}
                        mdi:server
                      {% endif %}
                    icon_color: |
                      {% if is_state('binary_sensor.diskstation_120j', 'off') %}
                        red
                      {% else %}
                        green
                      {% endif %}
                    tap_action:
                      action: more-info
          - type: custom:apexcharts-card
            experimental:
              color_threshold: true
            graph_span: 10d
            span:
              end: day
            show:
              last_updated: true
            header:
              show: true
              title: Nutzungszeit AdGuard Home
              show_states: true
              colorize_states: true
            yaxis:
              - min: 0
                max: ~9
                decimals: 0
                apex_config:
                  tickAmount: 5
            series:
              - entity: sensor.nutzungszeit_adguard
                show:
                  header_color_threshold: true
                  extremas: true
                  as_duration: hour
                type: column
                name: Dauer
                group_by:
                  func: last
                  duration: 1d
          - type: custom:apexcharts-card
            experimental:
              color_threshold: true
            graph_span: 10d
            span:
              end: day
            show:
              last_updated: true
            header:
              show: true
              title: Nutzungszeit Diskstation
              show_states: true
              colorize_states: true
            yaxis:
              - min: 0
                max: ~9
                decimals: 0
                apex_config:
                  tickAmount: 5
            series:
              - entity: sensor.nutzungszeit_ds1515
                show:
                  header_color_threshold: true
                  extremas: true
                  as_duration: hour
                type: column
                name: Dauer
                group_by:
                  func: last
                  duration: 1d
      - type: grid
        cards:
          - type: heading
            heading: Computer & Konsolen Status
          - square: false
            type: grid
            columns: 2
            cards:
              - type: custom:vertical-stack-in-card
                cards:
                  - type: custom:mushroom-template-card
                    primary: PC-Phil
                    entity: binary_sensor.pc_phil
                    secondary: >
                      {% if is_state('binary_sensor.pc_phil', 'off') %} Offline
                      {% else %} Online {% endif %} 
                    tap_action:
                      action: more-info
                    icon: >
                      {% if is_state('binary_sensor.pc_phil', 'off') %}
                      mdi:monitor-off

                      {% else %}

                      mdi:monitor

                      {% endif %}
                    icon_color: |
                      {% if is_state('binary_sensor.pc_phil', 'off') %}
                        red
                      {% else %}
                        green
                      {% endif %}
                    vertical: true
              - type: custom:vertical-stack-in-card
                cards:
                  - type: custom:mushroom-template-card
                    primary: PC-Nick
                    entity: binary_sensor.pc_nick
                    secondary: >
                      {% if is_state('binary_sensor.pc_nick', 'off') %} Offline
                      {% else %} Online {% endif %} 
                    tap_action:
                      action: more-info
                    icon: >
                      {% if is_state('binary_sensor.pc_nick', 'off') %}
                      mdi:monitor-off

                      {% else %}

                      mdi:monitor

                      {% endif %}
                    icon_color: |
                      {% if is_state('binary_sensor.pc_nick', 'off') %}
                        red
                      {% else %}
                        green
                      {% endif %}
                    vertical: true
              - type: custom:vertical-stack-in-card
                cards:
                  - type: custom:mushroom-template-card
                    primary: PC-Daniel
                    entity: binary_sensor.pc_daniel
                    secondary: >
                      {% if is_state('binary_sensor.pc_daniel', 'off') %}
                      Offline {% else %} Online {% endif %} 
                    tap_action:
                      action: more-info
                    icon: >
                      {% if is_state('binary_sensor.pc_daniel', 'off') %}
                      mdi:monitor-off

                      {% else %}

                      mdi:monitor

                      {% endif %}
                    icon_color: |
                      {% if is_state('binary_sensor.pc_daniel', 'off') %}
                        red
                      {% else %}
                        green
                      {% endif %}
                    vertical: true
              - type: custom:vertical-stack-in-card
                cards:
                  - type: custom:mushroom-template-card
                    primary: Nintendo Switch
                    entity: binary_sensor.nintendo_switch_nick
                    secondary: >
                      {% if is_state('binary_sensor.nintendo_switch_nick',
                      'off') %} Offline {% else %} Online {% endif %} 
                    tap_action:
                      action: more-info
                    icon: >
                      {% if is_state('binary_sensor.nintendo_switch_nick',
                      'off') %} mdi:nintendo-switch {% else %}
                      mdi:nintendo-switch {% endif %}
                    icon_color: >
                      {% if is_state('binary_sensor.nintendo_switch_nick',
                      'off') %}
                        red
                      {% else %}
                        green
                      {% endif %}
                    vertical: true
            title: Online
          - square: false
            type: grid
            columns: 2
            title: Heruntergefahren
            cards:
              - type: custom:vertical-stack-in-card
                cards:
                  - type: custom:mushroom-template-card
                    primary: PC-Phil
                    entity: sensor.pc_phil_runtergefahren
                    secondary: |
                      {{ states(entity) }}
                    icon: >
                      {% if is_state('binary_sensor.pc_phil', 'off') %}
                      mdi:monitor-off

                      {% else %}

                      mdi:monitor

                      {% endif %}
                    icon_color: |
                      {% if is_state('binary_sensor.pc_phil', 'off') %}
                        red
                      {% else %}
                        green
                      {% endif %}
                    tap_action:
                      action: more-info
              - type: custom:vertical-stack-in-card
                cards:
                  - type: custom:mushroom-template-card
                    primary: PC-Nick
                    entity: sensor.pc_nick_runtergefahren
                    secondary: |
                      {{ states(entity) }}
                    icon: >
                      {% if is_state('binary_sensor.pc_nick', 'off') %}
                      mdi:monitor-off

                      {% else %}

                      mdi:monitor

                      {% endif %}
                    icon_color: |
                      {% if is_state('binary_sensor.pc_nick', 'off') %}
                        red
                      {% else %}
                        green
                      {% endif %}
                    tap_action:
                      action: more-info
              - type: custom:vertical-stack-in-card
                cards:
                  - type: custom:mushroom-template-card
                    primary: PC-Daniel
                    entity: sensor.pc_daniel_runtergefahren
                    secondary: |
                      {{ states(entity) }}
                    icon: >
                      {% if is_state('binary_sensor.pc_daniel', 'off') %}
                      mdi:monitor-off

                      {% else %}

                      mdi:monitor

                      {% endif %}
                    icon_color: |
                      {% if is_state('binary_sensor.pc_daniel', 'off') %}
                        red
                      {% else %}
                        green
                      {% endif %}
                    tap_action:
                      action: more-info
              - type: custom:vertical-stack-in-card
                cards:
                  - type: custom:mushroom-template-card
                    primary: Nintendo Switch Nick
                    entity: sensor.nintendo_switch_ausgeschaltet
                    secondary: |
                      {{ states(entity) }}
                    icon: >
                      {% if is_state('binary_sensor.nintendo_switch_nick',
                      'off') %} mdi:nintendo-switch

                      {% else %}

                      mdi:nintendo-switch

                      {% endif %}
                    icon_color: >
                      {% if is_state('binary_sensor.nintendo_switch_nick',
                      'off') %}
                        red
                      {% else %}
                        green
                      {% endif %}
                    tap_action:
                      action: more-info
          - type: custom:apexcharts-card
            experimental:
              color_threshold: true
            graph_span: 10d
            span:
              end: day
            show:
              last_updated: true
            header:
              show: true
              title: Nutzungszeit PC-Phil
              show_states: true
              colorize_states: true
            yaxis:
              - min: 0
                max: ~9
                decimals: 0
                apex_config:
                  tickAmount: 5
            series:
              - entity: sensor.nutzungszeit_pc_phil
                show:
                  header_color_threshold: true
                  extremas: true
                  as_duration: hour
                type: column
                name: Dauer
                group_by:
                  func: last
                  duration: 1d
                color_threshold:
                  - value: 1
                    color: dodgerblue
                  - value: 2
                    color: darkcyan
                  - value: 4
                    color: orange
                  - value: 7
                    color: orangered
                  - value: 10
                    color: darkred
          - type: custom:apexcharts-card
            experimental:
              color_threshold: true
            graph_span: 10d
            span:
              end: day
            show:
              last_updated: true
            header:
              show: true
              title: Nutzungszeit PC-Nick
              show_states: true
              colorize_states: true
            yaxis:
              - min: 0
                max: ~9
                decimals: 0
                apex_config:
                  tickAmount: 5
            series:
              - entity: sensor.nutzungszeit_pc_nick
                show:
                  header_color_threshold: true
                  extremas: true
                  as_duration: hour
                type: column
                name: Dauer
                group_by:
                  func: last
                  duration: 1d
                color_threshold:
                  - value: 1
                    color: dodgerblue
                  - value: 2
                    color: darkcyan
                  - value: 4
                    color: orange
                  - value: 7
                    color: orangered
                  - value: 10
                    color: darkred
          - type: custom:apexcharts-card
            experimental:
              color_threshold: true
            graph_span: 7d
            span:
              end: day
            show:
              last_updated: true
            header:
              show: true
              title: Nutzungszeit Nintendo Switch Nick
              show_states: true
              colorize_states: true
            yaxis:
              - min: 0
                max: ~9
                decimals: 0
                apex_config:
                  tickAmount: 5
            series:
              - entity: sensor.nutzungszeit_nintendo_switch
                show:
                  header_color_threshold: true
                  extremas: true
                  as_duration: hour
                type: column
                name: Dauer
                group_by:
                  func: last
                  duration: 1d
                color_threshold:
                  - value: 1
                    color: dodgerblue
                  - value: 2
                    color: darkcyan
                  - value: 4
                    color: orange
                  - value: 7
                    color: orangered
                  - value: 10
                    color: darkred
          - type: custom:apexcharts-card
            experimental:
              color_threshold: true
            graph_span: 7d
            span:
              end: day
            show:
              last_updated: true
            header:
              show: true
              title: Nutzungszeit PC-Daniel
              show_states: true
              colorize_states: true
            yaxis:
              - min: 0
                max: ~16
                decimals: 0
                apex_config:
                  tickAmount: 5
            series:
              - entity: sensor.nutzungszeit_pc_daniel
                show:
                  header_color_threshold: true
                  extremas: true
                  as_duration: hour
                type: column
                name: Dauer
                group_by:
                  func: last
                  duration: 1d
      - type: grid
        cards:
          - type: heading
            heading: TV Geräte
          - square: false
            type: grid
            columns: 2
            cards:
              - type: custom:vertical-stack-in-card
                cards:
                  - type: custom:mushroom-template-card
                    primary: TV-Phil
                    entity: input_boolean.tv_phil_an
                    secondary: >
                      {% if is_state('input_boolean.tv_phil_an', 'off') %} aus
                      {% else %} an {% endif %} 
                    tap_action:
                      action: more-info
                    icon: >
                      {% if is_state('input_boolean.tv_phil_an', 'off') %}
                      mdi:television-off

                      {% else %}

                      mdi:television

                      {% endif %}
                    icon_color: |
                      {% if is_state('input_boolean.tv_phil_an', 'off') %}
                        red
                      {% else %}
                        green
                      {% endif %}
                    vertical: true
              - type: custom:vertical-stack-in-card
                cards:
                  - type: custom:mushroom-template-card
                    primary: TV-Nick
                    entity: input_boolean.tv_nick_an
                    secondary: >
                      {% if is_state('input_boolean.tv_nick_an', 'off') %} aus
                      {% else %} an {% endif %} 
                    tap_action:
                      action: more-info
                    icon: >
                      {% if is_state('input_boolean.tv_nick_an', 'off') %}
                      mdi:television-off

                      {% else %}

                      mdi:television

                      {% endif %}
                    icon_color: |
                      {% if is_state('input_boolean.tv_nick_an', 'off') %}
                        red
                      {% else %}
                        green
                      {% endif %}
                    vertical: true
              - type: custom:vertical-stack-in-card
                cards:
                  - type: custom:mushroom-template-card
                    primary: TV-Wohnzimmer
                    entity: input_boolean.tv_wohnzimmer_an
                    secondary: >
                      {% if is_state('input_boolean.tv_wohnzimmer_an', 'off') %}
                      aus {% else %} an {% endif %} 
                    tap_action:
                      action: more-info
                    icon: >
                      {% if is_state('input_boolean.tv_wohnzimmer_an', 'off') %}
                      mdi:television-off

                      {% else %}

                      mdi:television

                      {% endif %}
                    icon_color: |
                      {% if is_state('input_boolean.tv_wohnzimmer_an', 'off') %}
                        red
                      {% else %}
                        green
                      {% endif %}
                    vertical: true
              - type: custom:vertical-stack-in-card
                cards:
                  - type: custom:mushroom-template-card
                    primary: TV-Schlafzimmer
                    entity: input_boolean.tv_schlafzimmer_an
                    secondary: >
                      {% if is_state('input_boolean.tv_schlafzimmer_an', 'off')
                      %} aus {% else %} an {% endif %} 
                    tap_action:
                      action: more-info
                    icon: >
                      {% if is_state('input_boolean.tv_schlafzimmer_an', 'off')
                      %} mdi:television-off {% else %} mdi:television {% endif
                      %}
                    icon_color: >
                      {% if is_state('input_boolean.tv_schlafzimmer_an', 'off')
                      %}
                        red
                      {% else %}
                        green
                      {% endif %}
                    vertical: true
            title: Online
          - square: false
            type: grid
            columns: 2
            title: Ausgeschaltet
            cards:
              - type: custom:vertical-stack-in-card
                cards:
                  - type: custom:mushroom-template-card
                    primary: TV-Phil
                    entity: sensor.tv_phil_ausgeschaltet
                    secondary: |
                      {{ states(entity) }}
                    icon: >
                      {% if is_state('input_boolean.tv_phil_an', 'an') %}
                      mdi:television

                      {% else %}

                      mdi:television-off

                      {% endif %}
                    icon_color: |
                      {% if is_state('input_boolean.tv_phil_an', 'on') %}
                        green
                      {% else %}
                        red
                      {% endif %}
                    tap_action:
                      action: more-info
              - type: custom:vertical-stack-in-card
                cards:
                  - type: custom:mushroom-template-card
                    primary: TV-Nick
                    entity: sensor.tv_nick_ausgeschaltet
                    secondary: |
                      {{ states(entity) }}
                    icon: >
                      {% if is_state('input_boolean.tv_nick_an', 'an') %}
                      mdi:television

                      {% else %}

                      mdi:television-off

                      {% endif %}
                    icon_color: |
                      {% if is_state('input_boolean.tv_nick_an', 'on') %}
                        green
                      {% else %}
                        red
                      {% endif %}
                    tap_action:
                      action: more-info
              - type: custom:vertical-stack-in-card
                cards:
                  - type: custom:mushroom-template-card
                    primary: TV-Wohnzimmer
                    entity: sensor.tv_wohnzimmer_ausgeschaltet
                    secondary: |
                      {{ states(entity) }}
                    icon: >
                      {% if is_state('input_boolean.tv_wohnzimmer_an', 'on') %}
                      mdi:television {% else %} mdi:television-off {% endif %}
                    icon_color: |
                      {% if is_state('input_boolean.tv_wohnzimmer_an', 'on') %}
                        green
                      {% else %}
                        red
                      {% endif %}
                    tap_action:
                      action: more-info
              - type: custom:vertical-stack-in-card
                cards:
                  - type: custom:mushroom-template-card
                    primary: TV-Schlafzimmer
                    entity: sensor.tv_schlafzimmer_ausgeschaltet
                    secondary: |
                      {{ states(entity) }}
                    icon: >
                      {% if is_state('input_boolean.tv_schlafzimmer_an', 'on')
                      %} mdi:television {% else %} mdi:television-off {% endif
                      %}
                    icon_color: >
                      {% if is_state('input_boolean.tv_schlafzimmer_an', 'on')
                      %}
                        green
                      {% else %}
                        red
                      {% endif %}
                    tap_action:
                      action: more-info
          - type: custom:apexcharts-card
            experimental:
              color_threshold: true
            graph_span: 10d
            span:
              end: day
            show:
              last_updated: true
            header:
              show: true
              title: Nutzungszeit TV-Nick
              show_states: true
              colorize_states: true
            yaxis:
              - min: 0
                max: ~6
                decimals: 0
                apex_config:
                  tickAmount: 5
            series:
              - entity: sensor.nutzungszeit_tv_nick
                show:
                  header_color_threshold: true
                  extremas: true
                  as_duration: hour
                type: column
                name: Dauer
                group_by:
                  func: last
                  duration: 1d
                color_threshold:
                  - value: 1
                    color: dodgerblue
                  - value: 2
                    color: darkcyan
                  - value: 4
                    color: orange
                  - value: 7
                    color: orangered
                  - value: 10
                    color: darkred
          - type: custom:apexcharts-card
            experimental:
              color_threshold: true
            graph_span: 10d
            span:
              end: day
            show:
              last_updated: true
            header:
              show: true
              title: Nutzungszeit TV-Phil
              show_states: true
              colorize_states: true
            yaxis:
              - min: 0
                max: ~6
                decimals: 0
                apex_config:
                  tickAmount: 5
            series:
              - entity: sensor.nutzungszeit_tv_phil
                show:
                  header_color_threshold: true
                  extremas: true
                  as_duration: hour
                type: column
                name: Dauer
                group_by:
                  func: last
                  duration: 1d
                color_threshold:
                  - value: 1
                    color: dodgerblue
                  - value: 2
                    color: darkcyan
                  - value: 4
                    color: orange
                  - value: 7
                    color: orangered
                  - value: 10
                    color: darkred
          - type: custom:apexcharts-card
            experimental:
              color_threshold: true
            graph_span: 10d
            span:
              end: day
            show:
              last_updated: true
            header:
              show: true
              title: Nutzungszeit TV-Wohnzimmer
              show_states: true
              colorize_states: true
            yaxis:
              - min: 0
                max: ~6
                decimals: 0
                apex_config:
                  tickAmount: 5
            series:
              - entity: sensor.nutzungszeit_tv_wohnzimmer
                show:
                  header_color_threshold: true
                  extremas: true
                  as_duration: hour
                type: column
                name: Dauer
                group_by:
                  func: last
                  duration: 1d
                color_threshold:
                  - value: 1
                    color: dodgerblue
                  - value: 2
                    color: darkcyan
                  - value: 4
                    color: orange
                  - value: 7
                    color: orangered
                  - value: 10
                    color: darkred
          - type: custom:apexcharts-card
            experimental:
              color_threshold: true
            graph_span: 10d
            span:
              end: day
            show:
              last_updated: true
            header:
              show: true
              title: Nutzungszeit TV-Schlafzimmer
              show_states: true
              colorize_states: true
            yaxis:
              - min: 0
                max: ~6
                decimals: 0
                apex_config:
                  tickAmount: 5
            series:
              - entity: sensor.nutzungszeit_tv_schlafzimmer
                show:
                  header_color_threshold: true
                  extremas: true
                  as_duration: hour
                type: column
                name: Dauer
                group_by:
                  func: last
                  duration: 1d
                color_threshold:
                  - value: 1
                    color: dodgerblue
                  - value: 2
                    color: darkcyan
                  - value: 4
                    color: orange
                  - value: 7
                    color: orangered
                  - value: 10
                    color: darkred
    max_columns: 4
    cards: []
  - title: Jalousien
    path: jalousien
    icon: mdi:window-shutter-open
    type: custom:horizontal-layout
    badges: []
    cards:
      - type: vertical-stack
        cards:
          - type: custom:mushroom-title-card
            title: Sonnenschutz
          - type: horizontal-stack
            cards:
              - type: custom:mushroom-cover-card
                entity: cover.kuche
                name: Küche
                layout: vertical
                fill_container: false
                show_position_control: false
                show_buttons_control: true
                tap_action:
                  action: call-service
                  service: cover.set_cover_position
                  target:
                    entity_id: cover.kuche
                  data:
                    position: 30
              - type: custom:mushroom-cover-card
                entity: cover.esszimmer
                layout: vertical
                name: Esszimmer
                show_position_control: false
                tap_action:
                  action: call-service
                  service: cover.set_cover_position
                  target:
                    entity_id: cover.esszimmer
                  data:
                    position: 35
                show_buttons_control: true
          - type: horizontal-stack
            cards:
              - type: custom:mushroom-cover-card
                entity: cover.wohnzimmer
                name: Wohnzimmer
                layout: vertical
                fill_container: false
                show_position_control: false
                show_buttons_control: true
                tap_action:
                  action: call-service
                  service: cover.set_cover_position
                  target:
                    entity_id: cover.wohnzimmer
                  data:
                    position: 55
              - type: custom:mushroom-cover-card
                entity: cover.terasse
                layout: vertical
                name: Terrasse
                show_position_control: false
                tap_action:
                  action: call-service
                  service: cover.set_cover_position
                  target:
                    entity_id: cover.terasse
                  data:
                    position: 55
                show_buttons_control: true
      - type: custom:mushroom-title-card
        title: Rolladensteuerung
      - type: entities
        entities:
          - entity: automation.sonnenschutz_rollade_esszimmer
            name: Esszimmer
            secondary_info: last-triggered
          - entity: automation.sonnenschutz_rollade_kuche
            name: Küche
            secondary_info: last-triggered
          - entity: automation.sonnenschutz_rollade_wohnzimmer
            secondary_info: last-triggered
            name: Wohnzimmer
        title: Sonnenschutz Automation
        state_color: true
      - type: custom:shutter-row
        entity: cover.jalousien_wohnzimmer
        name: Wohnzimmer
        invert_position: true
        state_color: true
        preset_buttons:
          - name: Öffnen
            icon: mdi:window-shutter-open
            tap_action:
              action: call-service
              service: cover.set_cover_position
              data:
                entity_id: cover.wohnzimmer
                position: 100
          - name: 50%
            icon: mdi:fraction-one-half
            tap_action:
              action: call-service
              service: cover.set_cover_position
              data:
                entity_id: cover.wohnzimmer
                position: 65
          - name: Schließen
            icon: mdi:window-shutter
            tap_action:
              action: call-service
              service: cover.set_cover_position
              data:
                entity_id: cover.wohnzimmer
                position: 0
        move_down_button: {}
        disable_position: false
        rtl_position: false
        invert_position_label: false
        group: true
      - type: custom:shutter-row
        entity: cover.jalousien_alle
        name: Alle Jalousien
        invert_position: true
        state_color: true
        preset_buttons:
          - name: Öffnen
            icon: mdi:window-shutter-open
            tap_action:
              action: call-service
              service: cover.set_cover_position
              data:
                entity_id: cover.wohnzimmer
                position: 100
          - name: 50%
            icon: mdi:fraction-one-half
            tap_action:
              action: call-service
              service: cover.set_cover_position
              data:
                entity_id: cover.wohnzimmer
                position: 65
          - name: Schließen
            icon: mdi:window-shutter
            tap_action:
              action: call-service
              service: cover.set_cover_position
              data:
                entity_id: cover.wohnzimmer
                position: 0
        move_down_button: {}
        move_up_button: {}
        move_stop_button: {}
      - type: custom:shutter-row
        entity: cover.wohnzimmer
        name: Wohnzimmerfenster
        invert_position: true
        state_color: true
        preset_buttons:
          - name: Öffnen
            icon: mdi:window-shutter-open
            tap_action:
              action: call-service
              service: cover.set_cover_position
              data:
                entity_id: cover.wohnzimmer
                position: 100
          - name: 50%
            icon: mdi:fraction-one-half
            tap_action:
              action: call-service
              service: cover.set_cover_position
              data:
                entity_id: cover.wohnzimmer
                position: 65
          - name: Schließen
            icon: mdi:window-shutter
            tap_action:
              action: call-service
              service: cover.set_cover_position
              data:
                entity_id: cover.wohnzimmer
                position: 0
        move_down_button: {}
      - type: custom:shutter-row
        name: Terasse
        invert_position: true
        state_color: true
        preset_buttons:
          - name: Öffnen
            icon: mdi:window-shutter-open
            tap_action:
              action: call-service
              service: cover.set_cover_position
              data:
                entity_id: cover.terasse
                position: 100
          - name: 50%
            icon: mdi:fraction-one-half
            tap_action:
              action: call-service
              service: cover.set_cover_position
              data:
                entity_id: cover.terasse
                position: 65
          - name: Schließen
            icon: mdi:window-shutter
            tap_action:
              action: call-service
              service: cover.set_cover_position
              data:
                entity_id: cover.terasse
                position: 0
        move_down_button: {}
        disable_position: false
        rtl_position: false
        invert_position_label: false
        group: false
        entity: cover.terasse
      - type: custom:shutter-row
        entity: cover.jalousien_kuche
        name: Küche
        invert_position: true
        state_color: true
        preset_buttons:
          - name: Öffnen
            icon: mdi:window-shutter-open
            tap_action:
              action: call-service
              service: cover.set_cover_position
              data:
                entity_id: cover.wohnzimmer
                position: 100
          - name: 50%
            icon: mdi:fraction-one-half
            tap_action:
              action: call-service
              service: cover.set_cover_position
              data:
                entity_id: cover.wohnzimmer
                position: 50
          - name: Schließen
            icon: mdi:window-shutter
            tap_action:
              action: call-service
              service: cover.set_cover_position
              data:
                entity_id: cover.wohnzimmer
                position: 0
        move_down_button: {}
        disable_position: false
        rtl_position: false
        invert_position_label: false
        group: true
      - type: custom:shutter-row
        entity: cover.kuche
        name: Küchenfenster
        invert_position: true
        state_color: true
        preset_buttons:
          - name: Öffnen
            icon: mdi:window-shutter-open
            tap_action:
              action: call-service
              service: cover.set_cover_position
              data:
                entity_id: cover.kuche
                position: 100
          - name: 50%
            icon: mdi:fraction-one-half
            tap_action:
              action: call-service
              service: cover.set_cover_position
              data:
                entity_id: cover.kuche
                position: 45
          - name: Schließen
            icon: mdi:window-shutter
            tap_action:
              action: call-service
              service: cover.set_cover_position
              data:
                entity_id: cover.kuche
                position: 0
        move_down_button: {}
        disable_position: false
        rtl_position: false
        invert_position_label: false
        group: false
      - type: custom:shutter-row
        entity: cover.esszimmer
        invert_position: true
        state_color: true
        preset_buttons:
          - name: Öffnen
            icon: mdi:window-shutter-open
            tap_action:
              action: call-service
              service: cover.set_cover_position
              data:
                entity_id: cover.esszimmer
                position: 100
          - name: 50%
            icon: mdi:fraction-one-half
            tap_action:
              action: call-service
              service: cover.set_cover_position
              data:
                entity_id: cover.esszimmer
                position: 65
          - name: Schließen
            icon: mdi:window-shutter
            tap_action:
              action: call-service
              service: cover.set_cover_position
              data:
                entity_id: cover.esszimmer
                position: 0
        move_down_button: {}
        disable_position: false
        rtl_position: false
        invert_position_label: false
        group: false
        name: Esszimmer
      - type: custom:shutter-card
        title: Rolladen
        entities:
          - entity: cover.terasse
            name: Terasse
            buttons_position: left
            title_position: bottom
          - entity: cover.wohnzimmer
            name: Wohnzimmer
            buttons_position: left
            title_position: bottom
          - entity: cover.kuche
            name: Küche
            buttons_position: left
            title_position: bottom
          - entity: cover.esszimmer
            name: Esszimmer
            buttons_position: left
            title_position: bottom
  - title: Wohnzimmer
    path: wohnzimmer
    icon: mdi:sofa
    type: custom:horizontal-layout
    badges: []
    cards:
      - type: vertical-stack
        cards:
          - type: custom:mushroom-title-card
            title: Wohnzimmer
            alignment: justify
          - type: custom:mushroom-chips-card
            chips:
              - type: entity
                entity: sensor.sensor_wohnzimmer_temperature
                card_mod:
                  style: |
                    ha-card {
                      {% if states('sensor.sensor_wohnzimmer_temperature') > '30.0' %}
                        --card-mod-icon-color: orange;
                      {% elif states('sensor.sensor_wohnzimmer_temperature') < '26.0' %}
                        --card-mod-icon-color: lime;
                      {% elif states('sensor.sensor_wohnzimmer_temperature') < '23.0' %}
                        --card-mod-icon-color: light-green;            
                      {% elif states('sensor.sensor_wohnzimmer_temperature') < '20.0' %}
                        --card-mod-icon-color: green;
                      {% elif states('sensor.sensor_wohnzimmer_temperature') < '15.0' %}
                        --card-mod-icon-color: light-blue;
                      {% elif states('sensor.sensor_wohnzimmer_temperature') <= '0.0' %}
                        --card-mod-icon-color: indigo;         
                      {% endif %}
                    }
              - type: entity
                entity: sensor.sensor_wohnzimmer_humidity
                icon_color: indigo
              - type: template
                content: >-
                  {% set total = 0 %}

                  {% if is_state('light.lampe_kommode_wz', 'on') %}
                    {% set total = total + 1 %}
                  {% endif %}

                  {% if is_state('light.wohnzimmer_lampe_links_outlet', 'on') %}
                    {% set total = total + 1 %}
                  {% endif %}

                  {% if is_state('light.wohnzimmer_lampe_rechts_outlet', 'on')
                  %}
                    {% set total = total + 1 %}
                  {% endif %}

                  {% if is_state('light.wohnzimmer_beleuchtung_tv_outlet', 'on')
                  %}
                    {% set total = total + 1 %}
                  {% endif %}

                  {% if is_state('light.yeelight_wohnzimmer', 'on') %}
                    {% set total = total + 1 %}
                  {% endif %}

                  {% if is_state('light.deckenleuchte_wohnzimmer', 'on') %}
                    {% set total = total + 1 %}
                  {% endif %}                

                  ({{total}}) Licht
                icon: mdi:lightbulb-group
                icon_color: |-
                  {% if is_state('light.wohnzimmer_beleuchtung', 'on') %}
                    orange
                  {% elif is_state("light.yeelight_wohnzimmer_2", "on") %}
                    orange
                  {% else %}
                    grey
                  {% endif %}
                tap_action:
                  action: more-info
                entity: light.wohnzimmer_alle
              - type: template
                icon: >-
                  {% if
                  is_state('binary_sensor.terrassentur_window_and_door_sensor_5',
                  'off') %}
                    mdi:door-closed
                  {% else %}
                    mdi:door-open
                  {% endif %}
                content: >-
                  {% if
                  is_state('binary_sensor.terrassentur_window_and_door_sensor_5',
                  'off') %}
                    Zu
                  {% else %}
                    Offen
                  {% endif %}
                icon_color: >-
                  {% if
                  is_state('binary_sensor.terrassentur_window_and_door_sensor_5',
                  'off') %}
                    green
                  {% else %}
                    red
                  {% endif %}
                tap_action:
                  action: more-info
                entity: binary_sensor.terrassentur_window_and_door_sensor_5
            alignment: start
      - show_name: true
        show_icon: true
        type: button
        tap_action:
          action: toggle
        entity: light.wohnzimmer_beleuchtung
        show_state: false
      - type: custom:shutter-row
        name: Terasse
        invert_position: true
        state_color: true
        preset_buttons:
          - name: Öffnen
            icon: mdi:window-shutter-open
            tap_action:
              action: call-service
              service: cover.set_cover_position
              data:
                entity_id: cover.terasse
                position: 100
          - name: 50%
            icon: mdi:fraction-one-half
            tap_action:
              action: call-service
              service: cover.set_cover_position
              data:
                entity_id: cover.terasse
                position: 65
          - name: Schließen
            icon: mdi:window-shutter
            tap_action:
              action: call-service
              service: cover.set_cover_position
              data:
                entity_id: cover.terasse
                position: 0
        move_down_button: {}
        disable_position: false
        rtl_position: false
        invert_position_label: false
        group: false
        entity: cover.terasse
      - type: custom:shutter-row
        entity: cover.wohnzimmer
        name: Wohnzimmerfenster
        invert_position: true
        state_color: true
        preset_buttons:
          - name: Öffnen
            icon: mdi:window-shutter-open
            tap_action:
              action: call-service
              service: cover.set_cover_position
              data:
                entity_id: cover.wohnzimmer
                position: 100
          - name: 50%
            icon: mdi:fraction-one-half
            tap_action:
              action: call-service
              service: cover.set_cover_position
              data:
                entity_id: cover.wohnzimmer
                position: 50
          - name: Schließen
            icon: mdi:window-shutter
            tap_action:
              action: call-service
              service: cover.set_cover_position
              data:
                entity_id: cover.wohnzimmer
                position: 0
        move_down_button: {}
      - type: entities
        entities:
          - entity: light.wohnzimmer_beleuchtung_tv_outlet
          - entity: light.wohnzimmer_lampe_links_outlet
          - entity: light.wohnzimmer_lampe_rechts_outlet
          - entity: light.yl_wohnzimmer
          - entity: light.wohnzimmer_led_stripe
            name: Wohnzimmer LED-Stripe
        title: Licht Wohnzimmer
        state_color: true
      - type: custom:mushroom-light-card
        use_light_color: true
        show_brightness_control: true
        show_color_temp_control: true
        show_color_control: true
        collapsible_controls: false
        entity: light.yl_wohnzimmer
      - type: custom:mushroom-light-card
        use_light_color: true
        show_brightness_control: true
        show_color_temp_control: true
        show_color_control: true
        collapsible_controls: false
        entity: light.wohnzimmer_led_stripe
        name: Wohnzimmer LED-Stripe
      - type: custom:vacuum-card
        entity: vacuum.captain_robi
        image: default
        compact_view: false
        show_toolbar: true
  - title: Auto
    path: auto
    icon: mdi:car
    badges: []
    cards:
      - type: gauge
        entity: sensor.ceed_ev_battery_level
        name: Kia Ceed SW Akkustand
        needle: false
        severity:
          green: 70
          yellow: 30
          red: 15
      - type: entities
        title: Laufzeiten
        entities:
          - entity: input_datetime.autoladegerat_startzeit
            type: simple-entity
            name: Startzeit
          - entity: input_datetime.autoladegerat_endzeit
            type: simple-entity
            name: Endzeit
          - entity: sensor.autoladegerat_stoppuhr
            name: Dauer
          - entity: sensor.autoladegerat_leistung
            name: Stromverbrauch
      - type: picture-elements
        image: local/kia-ceed-transp.png
        elements:
          - type: state-icon
            entity: sensor.ceed_last_updated_at
            style:
              right: 0
              bottom: 0px
              margin-bottom: 0px
              transform: initial
              font-size: 1em
              line-height: 2em
              '--paper-item-icon-color': black
          - type: state-label
            entity: sensor.ceed_last_updated_at
            style:
              transform: initial
              font-size: 1em
              line-height: 2em
              bottom: 0px
              right: 30px
              margin-bottom: 0px
          - type: state-icon
            entity: device_tracker.ceed_location
            style:
              right: 0
              bottom: 0px
              margin-bottom: 48px
              transform: initial
              font-size: 1em
              line-height: 2em
              '--paper-item-icon-color': black
          - type: state-label
            entity: device_tracker.ceed_location
            style:
              transform: initial
              font-size: 1em
              line-height: 2em
              bottom: 0px
              right: 30px
              margin-bottom: 48px
          - type: state-icon
            entity: sensor.ceed_odometer
            style:
              right: 0
              bottom: 0px
              margin-bottom: 24px
              transform: initial
              font-size: 1em
              line-height: 2em
              '--paper-item-icon-color': black
          - type: state-label
            entity: sensor.ceed_odometer
            style:
              transform: initial
              font-size: 1em
              line-height: 2em
              bottom: 0px
              right: 30px
              margin-bottom: 24px
          - type: state-icon
            entity: lock.ceed_door_lock
            style:
              left: 0
              top: 0px
              margin-top: 0px
              transform: initial
              font-size: 1em
              line-height: 2em
              '--paper-item-icon-color': black
          - type: state-label
            entity: lock.ceed_door_lock
            title: lock.ceed_door_lock
            style:
              transform: initial
              font-size: 1em
              line-height: 2em
              top: 0px
              left: 30px
              margin-top: 0px
          - type: state-icon
            entity: binary_sensor.ceed_front_left_door
            style:
              left: 0
              top: 0px
              margin-top: 24px
              transform: initial
              font-size: 1em
              line-height: 2em
              '--paper-item-icon-color': black
          - type: state-label
            entity: binary_sensor.ceed_front_left_door
            title: binary_sensor.ceed_front_left_door
            style:
              transform: initial
              font-size: 1em
              line-height: 2em
              top: 0px
              left: 30px
              margin-top: 24px
          - type: state-icon
            entity: sensor.ceed_ev_battery_level
            style:
              left: 0
              bottom: 0px
              margin-bottom: 50px
              transform: initial
              font-size: 1em
              line-height: 2em
              '--paper-item-icon-color': black
          - type: state-label
            entity: sensor.ceed_ev_battery_level
            title: sensor.ceed_ev_battery_level
            prefix: 'Batterie: '
            style:
              transform: initial
              font-size: 1em
              line-height: 2em
              bottom: 0px
              left: 30px
              margin-bottom: 50px
          - type: state-icon
            entity: sensor.ceed_total_driving_range
            style:
              left: 0
              bottom: 0px
              margin-bottom: 0px
              transform: initial
              font-size: 1em
              line-height: 2em
              '--paper-item-icon-color': black
          - type: state-label
            entity: sensor.ceed_total_driving_range
            title: sensor.ceed_total_driving_range
            prefix: 'Total: '
            style:
              transform: initial
              font-size: 1em
              line-height: 2em
              bottom: 0px
              left: 30px
              margin-bottom: 0px
          - type: state-icon
            entity: sensor.ceed_ev_range
            style:
              left: 0
              bottom: 0px
              margin-bottom: 24px
              transform: initial
              font-size: 1em
              line-height: 2em
              '--paper-item-icon-color': black
          - type: state-label
            entity: sensor.ceed_ev_range
            title: sensor.ceed_ev_range
            prefix: 'Total EV: '
            style:
              transform: initial
              font-size: 1em
              line-height: 2em
              bottom: 0px
              left: 30px
              margin-bottom: 24px
          - type: state-icon
            entity: binary_sensor.ceed_ev_battery_charge
            style:
              right: 0
              top: 0px
              margin-top: 0px
              transform: initial
              font-size: 1em
              line-height: 2em
              '--paper-item-icon-color': black
          - type: state-label
            entity: binary_sensor.ceed_ev_battery_charge
            style:
              transform: initial
              font-size: 1em
              line-height: 2em
              top: 0px
              right: 30px
              margin-top: 0px
          - type: state-icon
            entity: binary_sensor.ceed_ev_battery_plug
            style:
              right: 0
              top: 0px
              margin-top: 24px
              transform: initial
              font-size: 1em
              line-height: 2em
              '--paper-item-icon-color': black
          - type: state-label
            entity: binary_sensor.ceed_ev_battery_plug
            style:
              transform: initial
              font-size: 1em
              line-height: 2em
              top: 0px
              right: 30px
              margin-top: 24px
          - type: state-label
            entity: sensor.ceed_set_temperature
            style:
              transform: initial
              font-size: 1em
              line-height: 2em
              top: 0px
              left: 30px
              margin-top: 50px
          - type: state-icon
            entity: sensor.ceed_set_temperature
            style:
              left: 0
              top: 0px
              margin-top: 50px
              transform: initial
              font-size: 1em
              line-height: 2em
              '--paper-item-icon-color': black
          - type: state-label
            entity: sensor.ceed_estimated_charge_duration
            style:
              transform: initial
              font-size: 1em
              line-height: 2em
              top: 0px
              right: 30px
              margin-top: 50px
          - type: state-icon
            entity: sensor.ceed_estimated_charge_duration
            style:
              right: 0
              top: 0px
              margin-top: 50px
              transform: initial
              font-size: 1em
              line-height: 2em
              '--paper-item-icon-color': black
      - type: custom:mini-graph-card
        entities:
          - entity: sensor.autoladegerat_leistung
          - entity: sensor.kia_ceed_sw_stromverbrauch_taglich
            show_state: true
            show_graph: false
        icon: mdi:car-electric
        show:
          extrema: true
          legend: false
          average: true
          fill: fade
        name: Autoladegerät
        line_width: 2
        lower_bound: 0
        min_bound_range: 100
        points_per_hour: 10
      - type: entities
        entities:
          - entity: lock.ceed_door_lock
            name: Tür Status
          - entity: binary_sensor.ceed_trunk
            name: Kofferaum
          - entity: binary_sensor.ceed_engine
            name: Motor
          - entity: sensor.ceed_ev_battery_level
            name: Batteristand
          - entity: binary_sensor.ceed_ev_battery_plug
            name: Ladekabel
          - entity: binary_sensor.ceed_ev_battery_charge
            name: Ladezustand
          - entity: sensor.ceed_total_driving_range
            name: Reichweite Total
          - entity: sensor.ceed_fuel_driving_range
            name: Reichweite Benzin
          - entity: sensor.ceed_ev_range
            name: Reichweite EV
          - entity: sensor.ceed_set_temperature
            name: Temperatur
          - entity: binary_sensor.ceed_washer_fluid_warning
            name: Scheibenwaschanlage
          - entity: binary_sensor.ceed_tire_pressure_all
            name: Reifendruck (Alle)
          - entity: sensor.ceed_odometer
            name: Kilometerstand
          - entity: sensor.ceed_data
          - entity: sensor.ceed_last_updated_at
            name: Letztes Datenupdate
      - type: entities
        entities:
          - entity: sensor.kia_ceed_sw_stromverbrauch_taglich
            icon: mdi:ev-plug-type2
            name: Täglich
          - entity: sensor.kia_ceed_sw_stromverbrauch_wochentlich
            name: Wöchentlich
            icon: mdi:ev-plug-type2
          - entity: sensor.kia_ceed_sw_stromverbrauch_monatlich
            name: Monatlich
            icon: mdi:ev-plug-type2
          - entity: sensor.kia_ceed_sw_stromverbrauch_jahrlich
            name: Jährlich
            icon: mdi:ev-plug-type2
        title: Kia Ceed SW Stromverbauch
      - type: map
        entities:
          - entity: device_tracker.ceed_location
        dark_mode: false
        title: 'Standort '
      - type: custom:auto-entities
        card:
          type: entities
          title: Benzinpreise E10
          state_color: false
        filter:
          include:
            - integration: tankerkoenig
              entity_id: '*super_e10'
          exclude: []
        sort:
          method: state
          numeric: true
          reverse: false
          ip: false
        show_empty: true
  - icon: mdi:router-wireless
    title: Netzwerk
    path: netzwerk
    badges: []
    cards:
      - type: grid
        square: false
        columns: 2
        title: Netzwerk Status
        cards:
          - type: custom:vertical-stack-in-card
            cards:
              - type: custom:mushroom-template-card
                primary: Router
                entity: binary_sensor.fritz_box_7590_verbindung
                secondary: >
                  {% if is_state('binary_sensor.fritz_box_7590_verbindung',
                  'off') %} Offline {% else %} Online {% endif %} 
                tap_action:
                  action: more-info
                icon: >
                  {% if is_state('binary_sensor.fritz_box_7590_verbindung',
                  'off') %} mdi:router-wireless-off

                  {% else %}

                  mdi:router-wireless

                  {% endif %}
                icon_color: >
                  {% if is_state('binary_sensor.fritz_box_7590_verbindung',
                  'off') %}
                    red
                  {% else %}
                    green
                  {% endif %}
                vertical: true
          - type: custom:vertical-stack-in-card
            cards:
              - type: custom:mushroom-template-card
                primary: Büro
                entity: binary_sensor.repeater_buro
                secondary: >
                  {% if is_state('binary_sensor.repeater_buro', 'off') %}
                  Offline {% else %} Online {% endif %} 
                tap_action:
                  action: more-info
                icon: >
                  {% if is_state('binary_sensor.repeater_buro', 'off') %}
                  mdi:router-wireless

                  {% else %}

                  mdi:router-wireless

                  {% endif %}
                icon_color: |
                  {% if is_state('binary_sensor.repeater_buro', 'off') %}
                    red
                  {% else %}
                    green
                  {% endif %}
                vertical: true
          - type: custom:vertical-stack-in-card
            cards:
              - type: custom:mushroom-template-card
                primary: Phil
                entity: binary_sensor.repeater_buro
                secondary: >
                  {% if is_state('binary_sensor.repeater_zimmer_phil', 'off') %}
                  Offline {% else %} Online {% endif %} 
                tap_action:
                  action: more-info
                icon: >
                  {% if is_state('binary_sensor.repeater_zimmer_phil', 'off') %}
                  mdi:router-wireless

                  {% else %}

                  mdi:router-wireless

                  {% endif %}
                icon_color: |
                  {% if is_state('binary_sensor.repeater_zimmer_phil', 'off') %}
                    red
                  {% else %}
                    green
                  {% endif %}
                vertical: true
          - type: custom:vertical-stack-in-card
            cards:
              - type: custom:mushroom-template-card
                primary: Nick
                entity: binary_sensor.repeater_buro
                secondary: >
                  {% if is_state('binary_sensor.repeater_zimmer_nick', 'off') %}
                  Offline {% else %} Online {% endif %} 
                tap_action:
                  action: more-info
                icon: >
                  {% if is_state('binary_sensor.repeater_zimmer_nick', 'off') %}
                  mdi:router-wireless

                  {% else %}

                  mdi:router-wireless

                  {% endif %}
                icon_color: |
                  {% if is_state('binary_sensor.repeater_zimmer_nick', 'off') %}
                    red
                  {% else %}
                    green
                  {% endif %}
                vertical: true
      - type: custom:mini-graph-card
        name: Speedtest
        align_state: center
        icon: mdi:speedometer
        show:
          extrema: true
          labels: true
          points: true
        entities:
          - entity: sensor.speedtest_download
            name: Download
            color: green
          - entity: sensor.speedtest_upload
            name: Upload
            color: red
  - title: Multimedia
    path: multimedia
    icon: mdi:multimedia
    cards: []
    type: sections
    sections:
      - type: grid
        cards:
          - type: heading
            heading: Audio-Geräte
          - type: vertical-stack
            cards:
              - type: entities
                entities:
                  - entity: media_player.spotify
                    type: custom:mini-media-player
                    artwork: material
                    group: true
                  - entity: media_player.teufel_one
                    type: custom:mini-media-player
                    hide_controls: true
                    artwork: material
                    group: true
                  - entity: media_player.buro
                    type: custom:mini-media-player
                    hide_controls: true
                    artwork: material
                    group: true
                  - entity: media_player.nicks_echo_show
                    type: custom:mini-media-player
                    hide_controls: true
                    artwork: material
                    group: true
                  - entity: media_player.audiocast_phil
                    type: custom:mini-media-player
                    hide_controls: true
                    artwork: material
                    group: true
                  - entity: media_player.eikelmann_s_firetablet
                    type: custom:mini-media-player
                    hide_controls: true
                    artwork: material
                    group: true
                  - entity: media_player.echo_dot_badezimmer
                    type: custom:mini-media-player
                    hide_controls: true
                    artwork: material
                    group: true
                  - entity: media_player.echo_dot_wohnzimmer
                    type: custom:mini-media-player
                    hide_controls: true
                    artwork: material
                    group: true
      - type: grid
        cards:
          - type: heading
            heading: TV-Geräte
          - type: vertical-stack
            cards:
              - type: entities
                entities:
                  - entity: media_player.nick_tv
                    type: custom:mini-media-player
                    artwork: material
                    group: true
                  - entity: media_player.tv_phil
                    type: custom:mini-media-player
                    artwork: material
                    group: true
                  - entity: media_player.mibox4_schlafzimmer
                    type: custom:mini-media-player
                    artwork: material
                    group: true
                  - entity: media_player.sharp_wohnzimmer
                    type: custom:mini-media-player
                    artwork: material
                    group: true
  - type: sections
    max_columns: 4
    title: Kalender
    path: kalender
    icon: mdi:calendar
    sections:
      - type: grid
        cards:
          - initial_view: listWeek
            type: calendar
            entities:
              - calendar.famillienkalender
              - calendar.borussia_dortmund
              - calendar.deutschland_ni
              - calendar.feiertage_in_deutschland
              - calendar.daniel_s_kalender
              - calendar.ferien_niedersachsen
            title: Privat
      - type: grid
        cards:
          - initial_view: listWeek
            type: calendar
            entities:
              - calendar.serviceerp
            title: ServiceERP Arbeit
      - type: grid
        cards:
          - type: heading
            heading: Neuer Abschnitt
  - type: sections
    max_columns: 4
    title: Backup
    path: backup
    sections:
      - type: grid
        cards:
          - type: custom:mushroom-chips-card
            alignment: center
            chips:
              - type: template
                entity: input_boolean.waschmaschine_lauft
                icon_color: '{{ ''orange'' if is_state(entity, ''on'') else ''grey'' }}'
                icon: >-
                  {{ 'mdi:washing-machine-alert' if is_state(entity, 'on') else
                  'mdi:washing-machine-off' }}
                tap_action:
                  action: fire-dom-event
                  browser_mod:
                    service: browser_mod.popup
                    data:
                      title: Waschmaschine
                      size: normal
                      content:
                        type: vertical-stack
                        cards:
                          - type: custom:button-card
                            entity: sensor.waschmaschine_status
                            name: Waschmaschine
                            icon: mdi:washing-machine
                            show_state: false
                            show_label: false
                            layout: vertical
                            custom_fields:
                              status: |
                                [[[
                                  const laufend = states['input_boolean.waschmaschine_lauft']?.state === 'on';
                                  const fertig = states['input_boolean.waschmaschine_fertig']?.state === 'on';
                                  if (laufend) return '🌀 Läuft';
                                  if (fertig) return '✅ Fertig';
                                  return '🛑 Aus';
                                ]]]
                              info: |
                                [[[
                                  const power = states['sensor.waschmaschine_power']?.state || '0';
                                  return `⚡ ${power} W`;
                                ]]]
                              progress: |
                                [[[
                                  const laufend = states['input_boolean.waschmaschine_lauft']?.state === 'on';
                                  if (!laufend) return '';
                                  const fortschritt = states['sensor.waschmaschine_fortschritt']?.state || '0';
                                  return `<div style='background: rgba(255,255,255,0.25); height: 8px; border-radius: 4px; overflow: hidden; margin-top: 12px;'><div style='width: ${fortschritt}%; background: #2196f3; height: 100%; transition: width 0.4s ease-in-out;'></div></div>`;
                                ]]]
                              zaehler: |
                                [[[
                                  const starts = states['sensor.tageszahler_waschmaschine']?.state || '0';
                                  const tag = states['sensor.waschmaschine_taglich']?.state || '–';
                                  const monat = states['sensor.waschmaschine_monatlich']?.state || '–';
                                  return `🔁 ${starts} · ${tag} kWh · ${monat} kWh`;
                                ]]]
                            styles:
                              card:
                                - height: 270px
                                - border-radius: 18px
                                - padding: 14px
                                - background: |
                                    [[[
                                      if (states['input_boolean.waschmaschine_lauft']?.state === 'on')
                                        return "linear-gradient(145deg, #2196f3, #1976d2)";
                                      if (states['input_boolean.waschmaschine_fertig']?.state === 'on')
                                        return "linear-gradient(145deg, #4caf50, #2e7d32)";
                                      return "var(--card-background-color)";
                                    ]]]
                                - color: |
                                    [[[
                                      if (states['input_boolean.waschmaschine_lauft']?.state === 'on' ||
                                          states['input_boolean.waschmaschine_fertig']?.state === 'on')
                                        return "white";
                                      return "var(--primary-text-color)";
                                    ]]]
                                - box-shadow: 0 6px 14px rgba(0, 0, 0, 0.15)
                                - transition: all 0.3s ease
                              grid:
                                - grid-template-areas: |
                                    "i"
                                    "n"
                                    "status"
                                    "info"
                                    "progress"
                                    "zaehler"
                                - grid-template-rows: 1fr auto auto auto auto auto
                                - grid-template-columns: 1fr
                              name:
                                - font-weight: 600
                                - font-size: 1.3em
                                - letter-spacing: 0.3px
                                - justify-self: center
                              icon:
                                - width: 110px
                                - height: 110px
                                - justify-self: center
                                - margin-bottom: 8px
                              custom_fields:
                                status:
                                  - text-align: center
                                  - font-size: 1.1em
                                  - font-weight: 500
                                  - opacity: 0.95
                                  - padding-top: 4px
                                info:
                                  - text-align: center
                                  - font-size: 1em
                                  - font-weight: 500
                                  - opacity: 0.85
                                progress:
                                  - width: 100%
                                zaehler:
                                  - text-align: center
                                  - font-size: 0.95em
                                  - padding-top: 12px
                                  - opacity: 0.75
                          - type: entities
                            entities:
                              - entity: input_boolean.waschmaschine_lauft
                                name: Status
                                state_color: true
                                type: simple-entity
                              - entity: sensor.waschmaschine_power
                                name: Verbrauch
                              - entity: input_datetime.waschmaschine_startzeit
                                type: simple-entity
                                name: Startzeit
                                format: relative
                                show_age: true
                              - entity: sensor.waschmaschine_laufzeit
                                name: Laufzeit
                                state_color: true
                              - entity: input_datetime.waschmaschine_fertig
                                type: simple-entity
                                name: Endzeit
                                format: relative
                                show_age: true
                              - entity: sensor.waschmaschine_stoppuhr
                                name: Dauer
                                state_color: true
                              - entity: sensor.tageszahler_waschmaschine
                                name: Tageszähler
                              - entity: sensor.monatszahler_waschmaschine
                                name: Monatszähler
                              - entity: sensor.waschmaschine_taglich
                                name: Stromverbrauch Tag
                              - entity: sensor.stromkosten_waschmaschine_tag
                                name: Stromkosten Tag
                              - entity: sensor.waschmaschine_wochentlich
                                name: Stromverbrauch Wöchentlich
                              - entity: sensor.stromkosten_waschmaschine_woche
                                name: Stromkosten Woche
                              - entity: sensor.waschmaschine_monatlich
                                name: Stromverbrauch Monatlich
                              - entity: sensor.stromkosten_waschmaschine_monat
                                name: Stromkosten Monat
                              - entity: sensor.waschmaschine_jahr
                                name: Stromverbrauch Jährlich
                              - entity: sensor.stromkosten_waschmaschine_jahr
                                name: Stromkosten Jahr
              - type: template
                entity: input_boolean.trockner_lauft
                icon_color: '{{ ''orange'' if is_state(entity, ''on'') else ''grey'' }}'
                icon: >-
                  {{ 'mdi:tumble-dryer-alert' if is_state(entity, 'on') else
                  'mdi:tumble-dryer-off' }}
                tap_action:
                  action: fire-dom-event
                  browser_mod:
                    service: browser_mod.popup
                    data:
                      title: Trockner
                      size: normal
                      content:
                        type: vertical-stack
                        cards:
                          - type: custom:button-card
                            entity: sensor.trockner_status
                            name: Trockner
                            icon: mdi:tumble-dryer
                            show_state: false
                            show_label: false
                            layout: vertical
                            custom_fields:
                              status: |
                                [[[
                                  const laufend = states['input_boolean.trockner_lauft']?.state === 'on';
                                  const fertig = states['input_boolean.trockner_fertig']?.state === 'on';
                                  if (laufend) return '🌀 Läuft';
                                  if (fertig) return '✅ Fertig';
                                  return '🛑 Aus';
                                ]]]
                              info: |
                                [[[
                                  const power = states['sensor.trockner_power']?.state || '0';
                                  return `⚡ ${power} W`;
                                ]]]
                              progress: |
                                [[[
                                  const laufend = states['input_boolean.trockner_lauft']?.state === 'on';
                                  if (!laufend) return '';
                                  const fortschritt = states['sensor.trockner_fortschritt']?.state || '0';
                                  return `<div style='background: rgba(255,255,255,0.25); height: 8px; border-radius: 4px; overflow: hidden; margin-top: 12px;'><div style='width: ${fortschritt}%; background: #ff9800; height: 100%; transition: width 0.4s ease-in-out;'></div></div>`;
                                ]]]
                              zaehler: |
                                [[[
                                  const starts = states['sensor.tageszahler_trockner']?.state || '0';
                                  const tag = states['sensor.trockner_taglich']?.state || '–';
                                  const monat = states['sensor.trockner_monatlich']?.state || '–';
                                  return `🔁 ${starts} · ${tag} kWh · ${monat} kWh`;
                                ]]]
                            styles:
                              card:
                                - height: 270px
                                - border-radius: 18px
                                - padding: 14px
                                - background: |
                                    [[[
                                      if (states['input_boolean.trockner_lauft']?.state === 'on')
                                        return "linear-gradient(145deg, #ff9800, #f57c00)";
                                      if (states['input_boolean.trockner_fertig']?.state === 'on')
                                        return "linear-gradient(145deg, #4caf50, #2e7d32)";
                                      return "var(--card-background-color)";
                                    ]]]
                                - color: |
                                    [[[
                                      if (states['input_boolean.trockner_lauft']?.state === 'on' ||
                                          states['input_boolean.trockner_fertig']?.state === 'on')
                                        return "white";
                                      return "var(--primary-text-color)";
                                    ]]]
                                - box-shadow: 0 6px 14px rgba(0, 0, 0, 0.15)
                                - transition: all 0.3s ease
                              grid:
                                - grid-template-areas: |
                                    "i"
                                    "n"
                                    "status"
                                    "info"
                                    "progress"
                                    "zaehler"
                                - grid-template-rows: 1fr auto auto auto auto auto
                                - grid-template-columns: 1fr
                              name:
                                - font-weight: 600
                                - font-size: 1.3em
                                - letter-spacing: 0.3px
                                - justify-self: center
                              icon:
                                - width: 80px
                                - height: 110px
                                - justify-self: center
                                - margin-bottom: 8px
                              custom_fields:
                                status:
                                  - text-align: center
                                  - font-size: 1.1em
                                  - font-weight: 500
                                  - opacity: 0.95
                                  - padding-top: 4px
                                info:
                                  - text-align: center
                                  - font-size: 1em
                                  - font-weight: 500
                                  - opacity: 0.85
                                progress:
                                  - width: 100%
                                zaehler:
                                  - text-align: center
                                  - font-size: 0.95em
                                  - padding-top: 12px
                                  - opacity: 0.75
                          - type: entities
                            entities:
                              - entity: input_boolean.trockner_lauft
                                name: Status
                                state_color: true
                              - entity: sensor.trockner_power
                                name: Verbrauch
                              - entity: input_datetime.trockner_startzeit
                                name: Startzeit
                                type: simple-entity
                                format: relative
                                show_age: true
                              - entity: sensor.trockner_laufzeit
                                name: Laufzeit
                                state_color: true
                              - entity: input_datetime.trockner_fertig
                                name: Endzeit
                                type: simple-entity
                                format: relative
                                show_age: true
                              - entity: sensor.trockner_stoppuhr
                                name: Dauer
                                state_color: true
                              - entity: sensor.tageszahler_trockner
                                name: Tageszähler
                              - entity: sensor.monatszahler_trockner
                                name: Monatszähler
                              - entity: sensor.trockner_taglich
                                name: Stromverbrauch Tag
                              - entity: sensor.stromkosten_trockner_tag
                                name: Stromkosten Tag
                              - entity: sensor.trockner_wochentlich
                                name: Stromverbrauch Wöchentlich
                              - entity: sensor.stromkosten_trockner_woche
                                name: Stromkosten Woche
                              - entity: sensor.trockner_monatlich
                                name: Stromverbrauch Monatlich
                              - entity: sensor.stromkosten_trockner_monat
                                name: Stromkosten Monat
                              - entity: sensor.trockner_jahrlich
                                name: Stromverbrauch Jährlich
                              - entity: sensor.stromkosten_trockner_jahr
                                name: Stromkosten Jahr
              - type: template
                entity: input_boolean.spulmaschine_lauft
                icon_color: '{{ ''orange'' if is_state(entity, ''on'') else ''grey'' }}'
                icon: >-
                  {{ 'mdi:dishwasher-alert' if is_state(entity, 'on') else
                  'mdi:dishwasher-off' }}
                tap_action:
                  action: fire-dom-event
                  browser_mod:
                    service: browser_mod.popup
                    data:
                      title: Spülmaschine
                      size: normal
                      content:
                        type: vertical-stack
                        cards:
                          - type: custom:button-card
                            entity: sensor.spulmaschine_status
                            name: Spülmaschine
                            icon: mdi:dishwasher
                            show_state: false
                            show_label: false
                            layout: vertical
                            custom_fields:
                              status: |
                                [[[
                                  const laufend = states['input_boolean.spulmaschine_lauft']?.state === 'on';
                                  const fertig = states['input_boolean.spulmaschine_fertig']?.state === 'on';
                                  const getDuration = (datetimeEntityId) => {
                                    const dateStr = states[datetimeEntityId]?.state;
                                    if (!dateStr) return null;
                                    const startTime = new Date(dateStr);
                                    const now = new Date();
                                    const diffMs = now - startTime;
                                    const totalMin = Math.floor(diffMs / 60000);
                                    const hours = Math.floor(totalMin / 60);
                                    const minutes = totalMin % 60;
                                    let result = '';
                                    if (hours > 0) result += `${hours} Std. `;
                                    if (minutes > 0 || hours === 0) result += `${minutes} Min`;
                                    return result.trim();
                                  };
                                  if (laufend) {
                                    const seit = getDuration('input_datetime.spulmaschine_startzeit');
                                    return `🌀 Läuft${seit ? ' seit ' + seit : ''}`;
                                  }
                                  if (fertig) {
                                    const seit = getDuration('input_datetime.spulmaschine_fertig');
                                    return `✅ Fertig${seit ? ' seit ' + seit : ''}`;
                                  }
                                  return '🛑 Aus';
                                ]]]
                              info: |
                                [[[
                                  const laufend = states['input_boolean.spulmaschine_lauft']?.state === 'on';
                                  const fertig = states['input_boolean.spulmaschine_fertig']?.state === 'on';
                                  const powerRaw = parseFloat(states['sensor.spulmaschine_power']?.state || '0');
                                  const power = powerRaw > 0 ? ` · ⚡ ${powerRaw} W` : '';
                                  if (laufend) {
                                    const fortschritt = states['sensor.spulmaschine_fortschritt']?.state || '–';
                                    const verbleibend = states['sensor.spulmaschine_verbleibend']?.state || '–';
                                    return `<div style="margin-top: 10px;">${fortschritt}% · ⏳ ${verbleibend} Min${power}</div>`;
                                  }
                                  if (fertig) return `<div style="margin-top: 10px;">🍽️ Sauber${power}</div>`;
                                  return `<div style="margin-top: 10px;">☑️ Bereit${power}</div>`;
                                ]]]
                              progress: |
                                [[[
                                  const laufend = states['input_boolean.spulmaschine_lauft']?.state === 'on';
                                  if (!laufend) return '';
                                  const fortschritt = parseInt(states['sensor.spulmaschine_fortschritt']?.state || 0);
                                  return `<div style="background: rgba(255,255,255,0.25); height: 8px; border-radius: 4px; overflow: hidden; margin-top: 12px;"><div style="width: ${fortschritt}%; background: #00bcd4; height: 100%; transition: width 0.4s ease-in-out;"></div></div>`;
                                ]]]
                              zaehler: |
                                [[[
                                  const starts = states['sensor.tageszahler_spulmaschine']?.state || '0';
                                  const tag = states['sensor.spulmaschine_taglich']?.state || '–';
                                  const monat = states['sensor.spulmaschine_monatlich']?.state || '–';
                                  return `🔁 ${starts} · ${tag} kWh · ${monat} kWh`;
                                ]]]
                            styles:
                              card:
                                - height: 300px
                                - border-radius: 18px
                                - padding: 14px
                                - background: |
                                    [[[
                                      if (states['input_boolean.spulmaschine_lauft']?.state === 'on')
                                        return "linear-gradient(145deg, #00bcd4, #0097a7)";
                                      if (states['input_boolean.spulmaschine_fertig']?.state === 'on')
                                        return "linear-gradient(145deg, #4caf50, #2e7d32)";
                                      return "var(--card-background-color)";
                                    ]]]
                                - color: |
                                    [[[
                                      if (
                                        states['input_boolean.spulmaschine_lauft']?.state === 'on' ||
                                        states['input_boolean.spulmaschine_fertig']?.state === 'on'
                                      ) return "white";
                                      return "var(--primary-text-color)";
                                    ]]]
                                - box-shadow: 0 6px 14px rgba(0, 0, 0, 0.15)
                                - transition: all 0.3s ease
                              grid:
                                - grid-template-areas: |
                                    "i"
                                    "n"
                                    "status"
                                    "info"
                                    "progress"
                                    "zaehler"
                                - grid-template-rows: 1fr auto auto auto auto auto
                                - grid-template-columns: 1fr
                              name:
                                - font-weight: 600
                                - font-size: 1.3em
                                - letter-spacing: 0.3px
                                - justify-self: center
                              icon:
                                - width: 80px
                                - height: 110px
                                - justify-self: center
                                - margin-bottom: 8px
                              custom_fields:
                                status:
                                  - text-align: center
                                  - font-size: 1.1em
                                  - font-weight: 500
                                  - opacity: 0.95
                                  - padding-top: 4px
                                info:
                                  - text-align: center
                                  - font-size: 1em
                                  - font-weight: 500
                                  - opacity: 0.85
                                progress:
                                  - width: 100%
                                zaehler:
                                  - text-align: center
                                  - font-size: 0.95em
                                  - padding-top: 12px
                                  - opacity: 0.75
                          - type: entities
                            entities:
                              - entity: input_boolean.spulmaschine_lauft
                                name: Status
                                state_color: true
                                type: simple-entity
                              - entity: sensor.spulmaschine_power
                                name: Verbrauch
                              - entity: input_datetime.spulmaschine_startzeit
                                name: Startzeit
                                type: simple-entity
                                format: relative
                                show_age: true
                              - entity: sensor.spulmaschine_laufzeit
                                name: Laufzeit
                                state_color: true
                              - entity: input_datetime.spulmaschine_fertig
                                name: Endzeit
                                type: simple-entity
                                format: relative
                                show_age: true
                              - entity: sensor.spulmaschine_stoppuhr
                                name: Dauer
                                state_color: true
                              - entity: sensor.tageszahler_spulmaschine
                                name: Tageszähler
                              - entity: sensor.monatszahler_spulmaschine
                                name: Monatszähler
                              - entity: sensor.spulmaschine_taglich
                                name: Stromverbrauch Tag
                              - entity: sensor.stromkosten_spulmaschine_tag
                                name: Stromkosten Tag
                              - entity: sensor.spulmaschine_wochentlich
                                name: Stromverbrauch Wöchentlich
                              - entity: sensor.stromkosten_spulmaschine_woche
                                name: Stromkosten Woche
                              - entity: sensor.spulmaschine_monatlich
                                name: Stromverbrauch Monatlich
                              - entity: sensor.stromkosten_spulmaschine_monat
                                name: Stromkosten Monat
                              - entity: sensor.spulmaschine_jahrlich
                                name: Stromverbrauch Jährlich
                              - entity: sensor.stromkosten_spulmaschine_jahr
                                name: Stromkosten Jahr
                          - type: conditional
                            conditions:
                              - entity: input_boolean.spulmaschine_fertig
                                state: 'on'
                            card:
                              type: horizontal-stack
                              cards:
                                - type: custom:button-card
                                  name: ❌ Abbrechen
                                  icon: mdi:close
                                  tap_action:
                                    action: fire-dom-event
                                    browser_mod:
                                      service: browser_mod.close_popup
                                  styles:
                                    card:
                                      - border-radius: 12px
                                      - background: rgba(255, 255, 255, 0.1)
                                      - color: var(--primary-text-color)
                                      - box-shadow: none
                                      - padding: 12px
                                      - height: 50px
                                - type: custom:button-card
                                  name: ✅ Zurücksetzen
                                  icon: mdi:restart
                                  tap_action:
                                    action: fire-dom-event
                                    browser_mod:
                                      service: browser_mod.sequence
                                      data:
                                        sequence:
                                          - service: input_boolean.turn_off
                                            data:
                                              entity_id: input_boolean.spulmaschine_fertig
                                          - service: browser_mod.close_popup
                                  styles:
                                    card:
                                      - border-radius: 12px
                                      - background: linear-gradient(145deg,
                                      - color: white
                                      - box-shadow: 0 4px 10px rgba(0,0,0,0.2)
                                      - padding: 12px
                                      - height: 50px
              - type: template
                entity: input_boolean.backofen_lauft
                icon_color: '{{ ''deep-orange'' if is_state(entity, ''on'') else ''grey'' }}'
                icon: '{{ ''mdi:stove'' if is_state(entity, ''on'') else ''mdi:stove'' }}'
                tap_action:
                  action: fire-dom-event
                  browser_mod:
                    service: browser_mod.popup
                    data:
                      title: Backofen
                      size: normal
                      content:
                        type: vertical-stack
                        cards:
                          - type: custom:button-card
                            entity: input_boolean.backofen_lauft
                            name: Backofen
                            icon: mdi:stove
                            show_state: false
                            show_label: false
                            layout: vertical
                            custom_fields:
                              status: |
                                [[[
                                  const laufend = entity.state === 'on';
                                  const stoppuhr = states['sensor.backofen_stoppuhr']?.state || '–';
                                  if (laufend && stoppuhr !== '–') return `🔥 Läuft seit ${stoppuhr}`;
                                  return '🛑 Aus';
                                ]]]
                              info: |
                                [[[
                                  const laufend = entity.state === 'on';
                                  const laufzeit = states['sensor.backofen_stoppuhr']?.state || '–';
                                  const power = parseFloat(states['sensor.backofen_power']?.state || '0');
                                  if (laufend && power > 0) return `<div style="margin-top: 10px;">⏱ ${laufzeit} · ⚡ ${power} W</div>`;
                                  if (laufend) return `<div style="margin-top: 10px;">⏱ ${laufzeit}</div>`;
                                  if (power > 0) return `<div style="margin-top: 10px;">⚡ ${power} W</div>`;
                                  return "";
                                ]]]
                              zaehler: |
                                [[[
                                  const starts = states['sensor.tageszahler_backofen']?.state || '0';
                                  const tag = states['sensor.backofen_taglich']?.state || '–';
                                  const monat = states['sensor.backofen_monatlich']?.state || '–';
                                  return `🔁 ${starts} · ${tag} kWh · ${monat} kWh`;
                                ]]]
                            styles:
                              card:
                                - height: 300px
                                - border-radius: 18px
                                - padding: 14px
                                - background: |
                                    [[[
                                      if (entity.state === 'on')
                                        return "linear-gradient(145deg, #ff5722, #e64a19)";
                                      return "var(--card-background-color)";
                                    ]]]
                                - color: |
                                    [[[
                                      if (entity.state === 'on')
                                        return "white";
                                      return "var(--primary-text-color)";
                                    ]]]
                                - box-shadow: 0 6px 14px rgba(0, 0, 0, 0.15)
                                - transition: all 0.3s ease
                              grid:
                                - grid-template-areas: |
                                    "i"
                                    "n"
                                    "status"
                                    "info"
                                    "zaehler"
                                - grid-template-rows: 1fr auto auto auto auto
                                - grid-template-columns: 1fr
                              name:
                                - font-weight: 600
                                - font-size: 1.3em
                                - letter-spacing: 0.3px
                                - justify-self: center
                              icon:
                                - animation: |
                                    [[[
                                      return entity.state === 'on' ? "pulse 2s infinite ease-in-out" : "none";
                                    ]]]
                                - width: 80px
                                - height: 110px
                                - justify-self: center
                                - margin-bottom: 8px
                              custom_fields:
                                status:
                                  - text-align: center
                                  - font-size: 1em
                                  - font-weight: 500
                                  - opacity: 0.9
                                  - padding-top: 4px
                                info:
                                  - text-align: center
                                  - font-size: 1em
                                  - font-weight: 500
                                  - opacity: 0.85
                                zaehler:
                                  - text-align: center
                                  - font-size: 0.95em
                                  - padding-top: 12px
                                  - opacity: 0.75
                            extra_styles: |
                              @keyframes pulse {
                                0% { transform: scale(1); }
                                50% { transform: scale(1.1); }
                                100% { transform: scale(1); }
                              }
                          - type: entities
                            entities:
                              - entity: input_boolean.backofen_lauft
                                name: Status
                                state_color: true
                                type: simple-entity
                              - entity: sensor.backofen_power
                                name: Verbrauch
                              - entity: input_datetime.backofen_startzeit
                                name: Startzeit
                                type: simple-entity
                                format: relative
                                show_age: true
                              - entity: sensor.backofen_laufzeit
                                name: Laufzeit
                                state_color: true
                              - entity: input_datetime.backofen_endzeit
                                name: Endzeit
                                type: simple-entity
                                format: relative
                                show_age: true
                              - entity: sensor.backofen_stoppuhr
                                name: Dauer
                                state_color: true
                              - entity: sensor.tageszahler_backofen
                                name: Tageszähler
                              - entity: sensor.monatszahler_backofen
                                name: Monatszähler
                              - entity: sensor.backofen_taglich
                                name: Stromverbrauch Tag
                              - entity: sensor.stromkosten_backofen_tag
                                name: Stromkosten Tag
                              - entity: sensor.backofen_wochentlich
                                name: Stromverbrauch Wöchentlich
                              - entity: sensor.stromkosten_backofen_woche
                                name: Stromkosten Woche
                              - entity: sensor.backofen_monatlich
                                name: Stromverbrauch Monatlich
                              - entity: sensor.stromkosten_backofen_monat
                                name: Stromkosten Monat
                              - entity: sensor.backofen_jahrlich
                                name: Stromverbrauch Jährlich
                              - entity: sensor.stromkosten_backofen_jahr
                                name: Stromkosten Jahr
              - type: template
                entity: input_boolean.kaffeevollautomat_eingeschaltet
                icon_color: '{{ ''orange'' if is_state(entity, ''on'') else ''grey'' }}'
                icon: >-
                  {{ 'mdi:coffee-maker' if is_state(entity, 'on') else
                  'mdi:coffee-maker' }}
                tap_action:
                  action: fire-dom-event
                  browser_mod:
                    service: browser_mod.popup
                    data:
                      title: Kaffeevollautomat
                      size: normal
                      content:
                        type: vertical-stack
                        cards:
                          - type: custom:button-card
                            entity: input_boolean.kaffeevollautomat_eingeschaltet
                            name: Kaffeevollautomat
                            icon: mdi:coffee-maker-outline
                            show_state: false
                            show_label: false
                            custom_fields:
                              status: |
                                [[[
                                  const laufend = entity.state === 'on';
                                  const stoppuhr = states['sensor.kaffeevollautomat_stoppuhr']?.state || '–';
                                  if (laufend && stoppuhr !== '–') return `☕ Läuft seit ${stoppuhr}`;
                                  return '🛑 Aus';
                                ]]]
                              info: |
                                [[[
                                  const laufend = entity.state === 'on';
                                  const laufzeit = states['sensor.kaffeevollautomat_stoppuhr']?.state || '–';
                                  const power = parseFloat(states['sensor.kaffeevollautomat_power']?.state || 0);

                                  if (laufend && power > 0) return `<div style="margin-top: 10px;">⏱ ${laufzeit} · ⚡ ${power} W</div>`;
                                  if (laufend) return `<div style="margin-top: 10px;">⏱ ${laufzeit}</div>`;
                                  if (power > 0) return `<div style="margin-top: 10px;">⚡ ${power} W</div>`;
                                  return "";
                                ]]]
                              zaehler: |
                                [[[
                                  const starts = states['sensor.tageszahler_kaffeevollautomat']?.state || '0';
                                  const tag = parseFloat(states['sensor.kaffeevollautomat_taglich']?.state || 0).toFixed(2);
                                  const monat = parseFloat(states['sensor.kaffeevollautomat_monatlich']?.state || 0).toFixed(2);
                                  return `🔁 ${starts} · ${tag} kWh · ${monat} kWh`;
                                ]]]
                            styles:
                              card:
                                - height: 300px
                                - border-radius: 18px
                                - padding: 14px
                                - background: |
                                    [[[
                                      if (entity.state === 'on')
                                        return "linear-gradient(145deg, #8d6e63, #6d4c41)";
                                      return "var(--card-background-color)";
                                    ]]]
                                - color: |
                                    [[[
                                      if (entity.state === 'on')
                                        return "white";
                                      return "var(--primary-text-color)";
                                    ]]]
                                - box-shadow: 0 6px 14px rgba(0, 0, 0, 0.15)
                                - transition: all 0.3s ease
                              grid:
                                - grid-template-areas: |
                                    "i"
                                    "n"
                                    "status"
                                    "info"
                                    "zaehler"
                                - grid-template-rows: 1fr auto auto auto auto
                                - grid-template-columns: 1fr
                              name:
                                - font-weight: 600
                                - font-size: 1.3em
                                - letter-spacing: 0.3px
                                - justify-self: center
                              icon:
                                - width: 80px
                                - height: 110px
                                - justify-self: center
                                - margin-bottom: 8px
                                - animation: |
                                    [[[
                                      return entity.state === 'on' ? "pulse 2s infinite ease-in-out" : "none";
                                    ]]]
                              custom_fields:
                                status:
                                  - text-align: center
                                  - font-size: 1em
                                  - font-weight: 500
                                  - opacity: 0.9
                                  - padding-top: 4px
                                info:
                                  - text-align: center
                                  - font-size: 1em
                                  - font-weight: 500
                                  - opacity: 0.85
                                zaehler:
                                  - text-align: center
                                  - font-size: 0.95em
                                  - padding-top: 12px
                                  - opacity: 0.75
                            tap_action:
                              action: more-info
                            extra_styles: |
                              @keyframes pulse {
                                0% { transform: scale(1); }
                                50% { transform: scale(1.1); }
                                100% { transform: scale(1); }
                              }
                          - type: entities
                            entities:
                              - entity: input_boolean.kaffeevollautomat_eingeschaltet
                                name: Status
                                state_color: true
                                type: simple-entity
                              - entity: sensor.kaffeevollautomat_power
                                name: Verbrauch
                              - entity: input_datetime.kaffeevollautomat_startzeit
                                name: Startzeit
                                type: simple-entity
                                format: relative
                                show_age: true
                              - entity: sensor.kaffeevollautomat_stoppuhr
                                name: Laufzeit
                                state_color: true
                              - entity: input_datetime.kaffeevollautomat_endzeit
                                name: Endzeit
                                type: simple-entity
                                format: relative
                                show_age: true
                              - entity: sensor.tageszahler_kaffeevollautomat
                                name: Tageszähler
                              - entity: sensor.monatszahler_kaffeevollautomat
                                name: Monatszähler
                              - entity: sensor.kaffeevollautomat_taglich
                                name: Stromverbrauch Tag
                              - entity: sensor.stromkosten_kaffeevollautomat_tag
                                name: Stromkosten Tag
                              - entity: sensor.kaffeevollautomat_wochentlich
                                name: Stromverbrauch Wöchentlich
                              - entity: sensor.stromkosten_kaffeevollautomat_woche
                                name: Stromkosten Woche
                              - entity: sensor.kaffeevollautomat_monatlich
                                name: Stromverbrauch Monatlich
                              - entity: sensor.stromkosten_kaffeevollautomat_monat
                                name: Stromkosten Monat
                              - entity: sensor.kaffeevollautomat_jahrlich
                                name: Stromverbrauch Jährlich
                              - entity: sensor.stromkosten_kaffeevollautomat_jahr
                                name: Stromkosten Jahr
              - type: template
                entity: input_boolean.airfryer_kuchenmaschine
                icon_color: '{{ ''orange'' if is_state(entity, ''on'') else ''grey'' }}'
                icon: >-
                  {{ 'mdi:chef-hat' if is_state(entity, 'on') else
                  'mdi:chef-hat' }}
                tap_action:
                  action: fire-dom-event
                  browser_mod:
                    service: browser_mod.popup
                    data:
                      title: Airfryer & Küchenmaschine
                      size: normal
                      content:
                        type: vertical-stack
                        cards:
                          - type: custom:button-card
                            entity: input_boolean.airfryer_kuchenmaschine
                            name: Airfryer & Brotbackautomat
                            icon: phu:airfryer
                            show_state: false
                            show_label: false
                            custom_fields:
                              status: |
                                [[[
                                  const isOn = states[entity.entity_id].state === 'on';
                                  const stoppuhr = states['sensor.airfryer_stoppuhr']?.state || '–';
                                  if (isOn) {
                                    return stoppuhr !== '–' ? `🔥 Läuft seit ${stoppuhr}` : '🔥 Läuft';
                                  }
                                  return '🛑 Aus';
                                ]]]
                              info: |
                                [[[
                                  const isOn = states[entity.entity_id].state === 'on';
                                  const stoppuhr = states['sensor.airfryer_stoppuhr']?.state || '–';
                                  const power = parseFloat(states['sensor.kuchenmaschine_power']?.state || '0');

                                  if (isOn && power > 0) return `<div style="margin-top: 10px;">⏱ ${stoppuhr} · ⚡ ${power.toFixed(0)} W</div>`;
                                  if (isOn) return `<div style="margin-top: 10px;">⏱ ${stoppuhr}</div>`;
                                  if (power > 0) return `<div style="margin-top: 10px;">⚡ ${power.toFixed(0)} W</div>`;
                                  return "";
                                ]]]
                              zaehler: |
                                [[[
                                  const starts = states['sensor.tageszahler_airfryer']?.state || '0';
                                  const tag = parseFloat(states['sensor.kuchenmaschine_taglich']?.state || 0).toFixed(2);
                                  const monat = parseFloat(states['sensor.kuchenmaschine_monatlich']?.state || 0).toFixed(2);
                                  return `🔁 ${starts} · ${tag} kWh · ${monat} kWh`;
                                ]]]
                            styles:
                              card:
                                - height: 300px
                                - border-radius: 18px
                                - padding: 14px
                                - background: |
                                    [[[
                                      return states[entity.entity_id].state === 'on' 
                                        ? "linear-gradient(145deg, #ff9800, #fb8c00)"
                                        : "var(--card-background-color)";
                                    ]]]
                                - color: |
                                    [[[
                                      return states[entity.entity_id].state === 'on'
                                        ? "white"
                                        : "var(--primary-text-color)";
                                    ]]]
                                - box-shadow: 0 6px 14px rgba(0, 0, 0, 0.15)
                                - transition: all 0.3s ease
                              grid:
                                - grid-template-areas: |
                                    "i"
                                    "n"
                                    "status"
                                    "info"
                                    "zaehler"
                                - grid-template-rows: 1fr auto auto auto auto
                                - grid-template-columns: 1fr
                              name:
                                - font-weight: 600
                                - font-size: 1.3em
                                - letter-spacing: 0.3px
                                - justify-self: center
                              icon:
                                - width: 80px
                                - height: 110px
                                - justify-self: center
                                - margin-bottom: 8px
                                - animation: |
                                    [[[
                                      return states[entity.entity_id].state === 'on' 
                                        ? "pulse 2s infinite ease-in-out" 
                                        : "none";
                                    ]]]
                              custom_fields:
                                status:
                                  - text-align: center
                                  - font-size: 1em
                                  - font-weight: 500
                                  - opacity: 0.9
                                  - padding-top: 4px
                                info:
                                  - text-align: center
                                  - font-size: 1em
                                  - font-weight: 500
                                  - opacity: 0.85
                                zaehler:
                                  - text-align: center
                                  - font-size: 0.95em
                                  - padding-top: 12px
                                  - opacity: 0.75
                            tap_action:
                              action: more-info
                            extra_styles: |
                              @keyframes pulse {
                                0% { transform: scale(1); }
                                50% { transform: scale(1.1); }
                                100% { transform: scale(1); }
                              }           
                          - type: entities
                            entities:
                              - entity: input_boolean.airfryer_kuchenmaschine
                                name: Status
                                state_color: true
                                type: simple-entity
                              - entity: sensor.kuchenmaschine_power
                                name: Verbrauch
                              - entity: input_datetime.airfryer_startzeit
                                name: Startzeit
                                type: simple-entity
                                format: relative
                                show_age: true
                              - entity: sensor.airfryer_stoppuhr
                                name: Laufzeit
                                state_color: true
                              - entity: input_datetime.airfryer_endzeit
                                name: Endzeit
                                type: simple-entity
                                format: relative
                                show_age: true
                              - entity: sensor.tageszahler_airfryer
                                name: Tageszähler
                              - entity: sensor.monatszahler_airfryer
                                name: Monatszähler
                              - entity: sensor.kuchenmaschine_taglich
                                name: Stromverbrauch Tag
                              - entity: sensor.stromkosten_airfryer_tag
                                name: Stromkosten Tag
                              - entity: sensor.kuchenmaschine_wochentlich
                                name: Stromverbrauch Wöchentlich
                              - entity: sensor.stromkosten_airfryer_woche
                                name: Stromkosten Woche
                              - entity: sensor.kuchenmaschine_monatlich
                                name: Stromverbrauch Monatlich
                              - entity: sensor.stromkosten_airfryer_monat
                                name: Stromkosten Monat
                              - entity: sensor.kuchenmaschine_jahrlich
                                name: Stromverbrauch Jährlich
                              - entity: sensor.stromkosten_airfryer_jahr
                                name: Stromkosten Jahr
              - type: template
                entity: input_boolean.autoladegerat_an
                icon_color: '{{ ''orange'' if is_state(entity, ''on'') else ''grey'' }}'
                icon: >-
                  {{ 'mdi:car-electric' if is_state(entity, 'on') else
                  'mdi:car-off' }}
                tap_action:
                  action: fire-dom-event
                  browser_mod:
                    service: browser_mod.popup
                    data:
                      title: Autoladegerät
                      size: normal
                      content:
                        type: vertical-stack
                        cards:
                          - type: custom:button-card
                            entity: input_boolean.autoladegerat_an
                            name: Autoladegerät
                            icon: mdi:ev-station
                            show_state: false
                            show_label: false
                            custom_fields:
                              status: |
                                [[[
                                  const laufend = entity.state === 'on';
                                  const dauer = states['sensor.autoladegerat_stoppuhr']?.state || '–';
                                  if (laufend && dauer !== '–') return `🔌 Lädt seit ${dauer}`;
                                  return '🛑 Aus';
                                ]]]
                              info: |
                                [[[
                                  const power = parseFloat(states['sensor.autoladegerat_leistung']?.state || '0');
                                  if (power > 5) return `<div style="margin-top: 10px;">⚡ ${power} W</div>`;
                                  return "";
                                ]]]
                              zaehler: |
                                [[[
                                  const tagRaw = states['sensor.kia_ceed_sw_stromverbrauch_taglich']?.state || '0';
                                  const monatRaw = states['sensor.kia_ceed_sw_stromverbrauch_monatlich']?.state || '0';
                                  const tag = isNaN(parseFloat(tagRaw)) ? '–' : parseFloat(tagRaw).toFixed(2);
                                  const monat = isNaN(parseFloat(monatRaw)) ? '–' : parseFloat(monatRaw).toFixed(2);
                                  return `📊 ${tag} kWh · ${monat} kWh`;
                                ]]]
                            styles:
                              card:
                                - height: 300px
                                - border-radius: 18px
                                - padding: 14px
                                - background: |
                                    [[[
                                      if (entity.state === 'on')
                                        return "linear-gradient(145deg, #ffa726, #fb8c00)";
                                      return "var(--card-background-color)";
                                    ]]]
                                - color: |
                                    [[[
                                      if (entity.state === 'on')
                                        return "white";
                                      return "var(--primary-text-color)";
                                    ]]]
                                - box-shadow: 0 6px 14px rgba(0, 0, 0, 0.15)
                                - transition: all 0.3s ease
                              grid:
                                - grid-template-areas: |
                                    "i"
                                    "n"
                                    "status"
                                    "info"
                                    "zaehler"
                                - grid-template-rows: 1fr auto auto auto auto
                                - grid-template-columns: 1fr
                              name:
                                - font-weight: 600
                                - font-size: 1.3em
                                - letter-spacing: 0.3px
                                - justify-self: center
                              icon:
                                - width: 80px
                                - height: 110px
                                - justify-self: center
                                - margin-bottom: 8px
                                - animation: |
                                    [[[
                                      return entity.state === 'on' ? "pulse 2s infinite ease-in-out" : "none";
                                    ]]]
                              custom_fields:
                                status:
                                  - text-align: center
                                  - font-size: 1em
                                  - font-weight: 500
                                  - opacity: 0.9
                                  - padding-top: 4px
                                info:
                                  - text-align: center
                                  - font-size: 1em
                                  - font-weight: 500
                                  - opacity: 0.85
                                zaehler:
                                  - text-align: center
                                  - font-size: 0.95em
                                  - padding-top: 12px
                                  - opacity: 0.75
                            tap_action:
                              action: more-info
                            extra_styles: |
                              @keyframes pulse {
                                0% { transform: scale(1); }
                                50% { transform: scale(1.1); }
                                100% { transform: scale(1); }
                              }
                                                      
                          - type: entities
                            entities:
                              - entity: input_boolean.autoladegerat_an
                                name: Status
                                state_color: true
                                type: simple-entity
                              - entity: sensor.ceed_ev_battery_level
                                name: Akkustand
                                type: simple-entity
                              - entity: binary_sensor.ceed_ev_battery_plug
                                name: Stecker
                                state_color: true
                              - entity: sensor.autoladegerat_leistung
                                name: Verbrauch
                              - entity: sensor.monatszahler_autoladegerat
                                name: Monatszähler
                              - entity: input_datetime.autoladegerat_startzeit
                                name: Startzeit
                                type: simple-entity
                                format: relative
                                show_age: true
                              - entity: sensor.autoladegerat_laufzeit
                                name: Laufzeit
                                state_color: true
                              - entity: input_datetime.autoladegerat_endzeit
                                name: Endzeit
                                type: simple-entity
                                format: relative
                                show_age: true
                              - entity: sensor.autoladegerat_stoppuhr
                                name: Dauer
                                state_color: true
                              - entity: sensor.kia_ceed_sw_stromverbrauch_taglich
                                name: Stromverbrauch Tag
                              - entity: sensor.stromkosten_autoladegerat_tag
                                name: Stromkosten Tag
                              - entity: sensor.kia_ceed_sw_stromverbrauch_wochentlich
                                name: Stromverbrauch Wöchentlich
                              - entity: sensor.stromkosten_autoladegerat_woche
                                name: Stromkosten Woche
                              - entity: sensor.kia_ceed_sw_stromverbrauch_monatlich
                                name: Stromverbrauch Monatlich
                              - entity: sensor.stromkosten_autoladegerat_monat
                                name: Stromkosten Monat
                              - entity: sensor.kia_ceed_sw_stromverbrauch_jahrlich
                                name: Stromverbrauch Jährlich
                              - entity: sensor.stromkosten_autoladegerat_jahr
                                name: Stromkosten Jahr
            card_mod:
              style:
                mushroom-template-chip:nth-child(1)$: |
                  ha-state-icon {
                    {{ 'animation: bounce 1s linear infinite;' if is_state('input_boolean.waschmaschine_lauft', 'on') }}
                  } 
                  @keyframes bounce {
                    0%, 10%, 50%, 80%, 100% {transform: translateY(0); }
                    40% { transform: translateY(-1.2px) rotate(5deg); }
                    60% { transform: translateY(-1.1px) rotate(4deg); }
                  }  
                mushroom-template-chip:nth-child(2)$: |
                  ha-state-icon {
                    {{ 'animation: bounce 1s linear infinite;' if is_state('input_boolean.trockner_lauft', 'on') }}
                  } 
                  @keyframes bounce {
                    0%, 10%, 50%, 80%, 100% {transform: translateY(0); }
                    40% { transform: translateY(-1.2px) rotate(5deg); }
                    60% { transform: translateY(-1.1px) rotate(4deg); }
                  } 
                mushroom-template-chip:nth-child(3)$: |
                  ha-state-icon {
                    {{ 'animation: bounce 1s linear infinite;' if is_state('input_boolean.spulmaschine_lauft', 'on') }}
                  } 
                  @keyframes bounce {
                    0%, 10%, 50%, 80%, 100% {transform: translateY(0); }
                    40% { transform: translateY(-1.2px) rotate(5deg); }
                    60% { transform: translateY(-1.1px) rotate(4deg); }
                  }
                mushroom-template-chip:nth-child(4)$: |
                  ha-state-icon {
                    {{ 'animation: bounce 1s linear infinite;' if is_state('input_boolean.backofen_lauft', 'on') }}
                  } 
                  @keyframes bounce {
                    0%, 10%, 50%, 80%, 100% {transform: translateY(0); }
                    40% { transform: translateY(-1.2px) rotate(5deg); }
                    60% { transform: translateY(-1.1px) rotate(4deg); }
                  }
                mushroom-template-chip:nth-child(5)$: |
                  ha-state-icon {
                    {{ 'animation: boing 3s linear infinite; transform-origin: 50% 90%;' if is_state('input_boolean.kaffeevollautomat_eingeschaltet', 'on') }}
                  } 
                  @keyframes boing {
                    0% { transform: scale3d(1, 1, 1); }
                    7% { transform: scale3d(1.25, 0.75, 1); }
                    10% { transform: scale3d(0.75, 1.25, 1); }
                    12% { transform: scale3d(1.15, 0.85, 1); }
                    16% { transform: scale3d(0.95, 1.05, 1); }
                    19% { transform: scale3d(1.05, 0.95, 1); }
                    25% { transform: scale3d(1, 1, 1); }
                  } 
                mushroom-template-chip:nth-child(6)$: |
                  ha-state-icon {
                    {{ 'animation: boing 3s linear infinite; transform-origin: 50% 90%;' if is_state('input_boolean.airfryer_kuchenmaschine', 'on') }}
                  } 
                  @keyframes boing {
                    0% { transform: scale3d(1, 1, 1); }
                    7% { transform: scale3d(1.25, 0.75, 1); }
                    10% { transform: scale3d(0.75, 1.25, 1); }
                    12% { transform: scale3d(1.15, 0.85, 1); }
                    16% { transform: scale3d(0.95, 1.05, 1); }
                    19% { transform: scale3d(1.05, 0.95, 1); }
                    25% { transform: scale3d(1, 1, 1); }
                  }
                mushroom-template-chip:nth-child(7)$: |
                  ha-state-icon {
                    {{ 'animation: boing 3s linear infinite; transform-origin: 50% 90%;' if is_state('input_boolean.autoladegerat_an', 'on') }}
                  } 
                  @keyframes boing {
                    0% { transform: scale3d(1, 1, 1); }
                    7% { transform: scale3d(1.25, 0.75, 1); }
                    10% { transform: scale3d(0.75, 1.25, 1); }
                    12% { transform: scale3d(1.15, 0.85, 1); }
                    16% { transform: scale3d(0.95, 1.05, 1); }
                    19% { transform: scale3d(1.05, 0.95, 1); }
                    25% { transform: scale3d(1, 1, 1); }
                  }
          - type: custom:vertical-stack-in-card
            card_mod:
              style: |
                ha-card {
                  background:  ;
                  border:  ;
                  border-radius: 0px
                }
            cards:
              - type: custom:button-card
                entity: sensor.mullabholung_heute
                show_icon: false
                show_name: false
                show_state: true
                style:
                  top: 10%
                  left: 50%
                  width: 100%
                styles:
                  state:
                    - font-size: 1.5em
                    - font-family: Arial Rounded MT
                    - color: var(--primary-color)
                    - white-space: unset
                    - text-overflow: unset
                    - word-break: break-word
                    - visibility: >
                        [[[ return entity.state === 'none' ? 'hidden' :
                        'visible'; ]]]
                  card:
                    - background: transparent
                    - border: none
                    - padding-bottom: 0
              - type: horizontal-stack
                cards:
                  - type: vertical-stack
                    cards:
                      - type: custom:button-card
                        entity: sensor.papierbehaelter
                        show_entity_picture: true
                        entity_picture: /local/muell/blau.png
                        size: 40%
                        show_state: false
                        show_name: false
                        styles:
                          card:
                            - border: none
                            - background: transparent
                            - padding: 1em 0 0 0
                        state:
                          - value: Heute
                            entity_picture: /local/muell/blau.png
                            styles:
                              entity_picture:
                                - animation:
                                    - blink 1s linear infinite
                      - type: custom:button-card
                        entity: sensor.papierbehaelter_datum
                        show_name: false
                        show_icon: false
                        show_state: true
                        styles:
                          state:
                            - font-family: Arial Rounded MT
                          card:
                            - background-color: transparent
                            - border: none
                            - padding: 0
                      - type: custom:button-card
                        entity: sensor.papierbehaelter
                        show_name: true
                        show_icon: false
                        show_state: true
                        styles:
                          name:
                            - font-family: Arial Rounded MT
                            - color: var(--primary-color)
                          state:
                            - font-family: Arial Rounded MT
                          card:
                            - background-color: transparent
                            - border: none
                            - padding: 0 0 1em 0
                  - type: vertical-stack
                    cards:
                      - type: custom:button-card
                        entity: sensor.wertstoffbehaelter
                        show_entity_picture: true
                        entity_picture: /local/muell/gelb.png
                        size: 40%
                        show_state: false
                        show_name: false
                        styles:
                          card:
                            - border: none
                            - background: transparent
                            - padding: 1em 0 0 0
                        state:
                          - value: Heute
                            entity_picture: /local/muell/gelb.png
                            styles:
                              entity_picture:
                                - animation:
                                    - blink 1s linear infinite
                      - type: custom:button-card
                        entity: sensor.wertstoffbehaelter_datum
                        show_name: false
                        show_icon: false
                        show_state: true
                        styles:
                          state:
                            - font-family: Arial Rounded MT
                          card:
                            - background-color: transparent
                            - border: none
                            - padding: 0
                      - type: custom:button-card
                        entity: sensor.wertstoffbehaelter
                        show_name: true
                        show_icon: false
                        show_state: true
                        styles:
                          name:
                            - font-family: Arial Rounded MT
                            - color: var(--primary-color)
                          state:
                            - font-family: Arial Rounded MT
                          card:
                            - background-color: transparent
                            - border: none
                            - padding: 0 0 1em 0
              - type: horizontal-stack
                cards:
                  - type: vertical-stack
                    cards:
                      - type: custom:button-card
                        entity: sensor.restabfallbehaelter
                        show_entity_picture: true
                        entity_picture: /local/muell/schwarz.png
                        size: 40%
                        show_state: false
                        show_name: false
                        styles:
                          card:
                            - border: none
                            - background: transparent
                            - padding: 1em 0 0 0
                        state:
                          - value: Heute
                            entity_picture: /local/muell/schwarz.png
                            styles:
                              entity_picture:
                                - animation:
                                    - blink 1s linear infinite
                      - type: custom:button-card
                        entity: sensor.restabfallbehaelter_datum
                        show_name: false
                        show_icon: false
                        show_state: true
                        styles:
                          state:
                            - font-family: Arial Rounded MT
                          card:
                            - background-color: transparent
                            - border: none
                            - padding: 0
                      - type: custom:button-card
                        entity: sensor.restabfallbehaelter
                        show_name: true
                        show_icon: false
                        show_state: true
                        styles:
                          name:
                            - font-family: Arial Rounded MT
                            - color: var(--primary-color)
                          state:
                            - font-family: Arial Rounded MT
                          card:
                            - background-color: transparent
                            - border: none
                            - padding: 0 0 1em 0
                  - type: vertical-stack
                    cards:
                      - type: custom:button-card
                        entity: sensor.bioabfallbehaelter
                        show_entity_picture: true
                        entity_picture: /local/muell/braun.png
                        size: 40%
                        show_state: false
                        show_name: false
                        styles:
                          card:
                            - border: none
                            - background: transparent
                            - padding: 1em 0 0 0
                        state:
                          - value: Heute
                            entity_picture: /local/muell/braun.png
                            styles:
                              entity_picture:
                                - animation:
                                    - blink 1s linear infinite
                      - type: custom:button-card
                        entity: sensor.bioabfallbehaelter_datum
                        show_name: false
                        show_icon: false
                        show_state: true
                        styles:
                          state:
                            - font-family: Arial Rounded MT
                          card:
                            - background-color: transparent
                            - border: none
                            - padding: 0
                      - type: custom:button-card
                        entity: sensor.bioabfallbehaelter
                        show_name: true
                        show_icon: false
                        show_state: true
                        styles:
                          name:
                            - font-family: Arial Rounded MT
                            - color: var(--primary-color)
                          state:
                            - font-family: Arial Rounded MT
                          card:
                            - background-color: transparent
                            - border: none
                            - padding: 0 0 1em 0
          - type: custom:button-card
            entity: sensor.tonnenbutton_2
            layout: icon_name_state2nd
            show_label: true
            show_name: true
            name: |
              [[[
                return entity.state.split("|")[0];
              ]]]
            label: |
              [[[
                const days_to = parseInt(entity.state.split("|")[1]);
                switch(days_to) {
                  case 0:
                    return "🚛 An der Straße?!";
                  case 1:
                    return "⚠️ Heute Abend raus";
                  case 2:
                    return "📅 Morgen";
                  default:
                    return "⏳ In " + days_to + " Tagen";
                }
              ]]]
            state:
              - operator: template
                value: '[[[ return entity.state.split(''|'')[1] == 0 ]]]'
                color: red
                styles:
                  card:
                    - animation: blink 1s linear infinite
                    - background: rgba(255, 0, 0, 0.25)
                    - box-shadow: 0 0 16px 4px rgba(255, 0, 0, 0.6)
                  label:
                    - font-weight: bold
                    - font-size: 1em
                    - color: var(--error-color)
                  name:
                    - font-weight: bold
                    - color: var(--error-color)
                    - font-size: 1em
              - operator: template
                value: '[[[ return entity.state.split(''|'')[1] == 1 ]]]'
                color: orange
                styles:
                  card:
                    - animation: pulse 2s ease infinite
                    - background: rgba(255, 165, 0, 0.18)
                    - box-shadow: 0 0 10px 2px rgba(255, 165, 0, 0.5)
                  label:
                    - font-weight: bold
                    - font-size: 1em
                    - color: rgb(255, 140, 0)
                  name:
                    - font-weight: bold
                    - color: rgb(255, 140, 0)
                    - font-size: 1em
              - value: default
                color: var(--primary-text-color)
                styles:
                  card:
                    - background: var(--card-background-color)
            styles:
              card:
                - border-radius: var(--border-radius)
                - padding: 12px
              name:
                - font-size: 1em
                - padding-bottom: 4px
              label:
                - font-size: 1em
                - opacity: 0.9
            custom_fields: {}
            animations:
              blink:
                - keyframes:
                    - 0%:
                        opacity: 1
                        transform: scale(1)
                    - 50%:
                        opacity: 0.2
                        transform: scale(1)
                    - 100%:
                        opacity: 1
                        transform: scale(1)
              pulse:
                - keyframes:
                    - 0%:
                        transform: scale(1)
                    - 50%:
                        transform: scale(1.05)
                    - 100%:
                        transform: scale(1)
            tap_action:
              action: more-info
            hold_action:
              action: none
      - type: grid
        cards:
          - type: vertical-stack
            view_layout:
              grid-area: auto
              lazy_load: true
            cards:
              - type: custom:mushroom-chips-card
                chips:
                  - type: template
                    entity: input_boolean.waschmaschine_lauft
                    icon_color: '{{ ''orange'' if is_state(entity, ''on'') else ''grey'' }}'
                    icon: >-
                      {{ 'mdi:washing-machine-alert' if is_state(entity, 'on')
                      else 'mdi:washing-machine-off' }}
                    error_handling:
                      show_error: true
                      error_default: unknown
                    tap_action:
                      action: fire-dom-event
                      browser_mod:
                        service: browser_mod.popup
                        data:
                          title: Waschmaschine
                          size: normal
                          content:
                            type: vertical-stack
                            cards:
                              - type: entities
                                entities:
                                  - entity: input_boolean.waschmaschine_lauft
                                    name: Status
                                    state_color: true
                                    type: simple-entity
                                  - entity: sensor.waschmaschine_power
                                    name: Verbrauch
                                  - entity: input_datetime.waschmaschine_startzeit
                                    name: Startzeit
                                    type: simple-entity
                                    format: relative
                                    show_age: true
                                  - entity: sensor.waschmaschine_laufzeit
                                    name: Laufzeit
                                    state_color: true
                                  - entity: input_datetime.waschmaschine_fertig
                                    name: Endzeit
                                    type: simple-entity
                                    format: relative
                                    show_age: true
                                  - entity: sensor.waschmaschine_stoppuhr
                                    name: Dauer
                                    state_color: true
                                  - entity: sensor.tageszahler_waschmaschine
                                    name: Tageszähler
                                  - entity: sensor.monatszahler_waschmaschine
                                    name: Monatszähler
                                  - entity: sensor.waschmaschine_taglich
                                    name: Stromverbrauch Tag
                                  - entity: sensor.stromkosten_waschmaschine_tag
                                    name: Stromkosten Tag
                                  - entity: sensor.waschmaschine_wochentlich
                                    name: Stromverbrauch Wöchentlich
                                  - entity: sensor.stromkosten_waschmaschine_woche
                                    name: Stromkosten Woche
                                  - entity: sensor.waschmaschine_monatlich
                                    name: Stromverbrauch Monatlich
                                  - entity: sensor.stromkosten_waschmaschine_monat
                                    name: Stromkosten Monat
                                  - entity: sensor.waschmaschine_jahr
                                    name: Stromverbrauch Jährlich
                                  - entity: sensor.stromkosten_waschmaschine_jahr
                                    name: Stromkosten Jahr
                              - type: custom:apexcharts-card
                                graph_span: 28d
                                span:
                                  start: day
                                  offset: '-27d'
                                chart_type: line
                                series:
                                  - entity: sensor.waschmaschine_taglich
                                    name: Verbrauch
                                    type: column
                                    group_by:
                                      func: delta
                                      duration: 1d
                                    show:
                                      datalabels: false
                                    extend_to: end
                                    float_precision: 2
                                header:
                                  show: true
                                  title: Verbrauch
                                  show_states: true
                                  colorize_states: true
                                yaxis:
                                  - align_to: 0.25
                                    decimals: 2
                                    apex_config:
                                      tickAmount: 5
                                apex_config:
                                  tooltip:
                                    x:
                                      format: ddd dd:MM
                  - type: template
                    entity: input_boolean.trockner_lauft
                    icon_color: '{{ ''orange'' if is_state(entity, ''on'') else ''grey'' }}'
                    icon: >-
                      {{ 'mdi:tumble-dryer-alert' if is_state(entity, 'on') else
                      'mdi:tumble-dryer-off' }}
                    error_handling:
                      show_error: true
                      error_default: unknown
                    tap_action:
                      action: fire-dom-event
                      browser_mod:
                        service: browser_mod.popup
                        data:
                          title: Trockner
                          size: normal
                          content:
                            type: vertical-stack
                            cards:
                              - type: entities
                                entities:
                                  - entity: input_boolean.trockner_lauft
                                    name: Status
                                    state_color: true
                                    type: simple-entity
                                  - entity: sensor.trockner_power
                                    name: Verbrauch
                                  - entity: input_datetime.trockner_startzeit
                                    name: Startzeit
                                    type: simple-entity
                                    format: relative
                                    show_age: true
                                  - entity: sensor.trockner_laufzeit
                                    name: Laufzeit
                                    state_color: true
                                  - entity: input_datetime.trockner_fertig
                                    name: Endzeit
                                    type: simple-entity
                                    format: relative
                                    show_age: true
                                  - entity: sensor.trockner_stoppuhr
                                    name: Dauer
                                    state_color: true
                                  - entity: sensor.tageszahler_trockner
                                    name: Tageszähler
                                  - entity: sensor.monatszahler_trockner
                                    name: Monatszähler
                                  - entity: sensor.trockner_taglich
                                    name: Stromverbrauch Tag
                                  - entity: sensor.stromkosten_trockner_tag
                                    name: Stromkosten Tag
                                  - entity: sensor.trockner_wochentlich
                                    name: Stromverbrauch Wöchentlich
                                  - entity: sensor.stromkosten_trockner_woche
                                    name: Stromkosten Woche
                                  - entity: sensor.trockner_monatlich
                                    name: Stromverbrauch Monatlich
                                  - entity: sensor.stromkosten_trockner_monat
                                    name: Stromkosten Monat
                                  - entity: sensor.trockner_jahrlich
                                    name: Stromverbrauch Jährlich
                                  - entity: sensor.stromkosten_trockner_jahr
                                    name: Stromkosten Jahr
                              - type: custom:apexcharts-card
                                graph_span: 28d
                                span:
                                  start: day
                                  offset: '-27d'
                                chart_type: line
                                series:
                                  - entity: sensor.trockner_taglich
                                    name: Verbrauch
                                    type: column
                                    group_by:
                                      func: delta
                                      duration: 1d
                                    show:
                                      datalabels: false
                                    extend_to: end
                                    float_precision: 2
                                header:
                                  show: true
                                  title: Verbrauch
                                  show_states: true
                                  colorize_states: true
                                yaxis:
                                  - align_to: 0.25
                                    decimals: 2
                                    apex_config:
                                      tickAmount: 5
                                apex_config:
                                  tooltip:
                                    x:
                                      format: ddd dd:MM
                  - type: template
                    entity: input_boolean.spulmaschine_lauft
                    icon_color: '{{ ''orange'' if is_state(entity, ''on'') else ''grey'' }}'
                    icon: >-
                      {{ 'mdi:dishwasher-alert' if is_state(entity, 'on') else
                      'mdi:dishwasher-off' }}
                    error_handling:
                      show_error: true
                      error_default: unknown
                    tap_action:
                      action: fire-dom-event
                      browser_mod:
                        service: browser_mod.popup
                        data:
                          title: Spülmaschine
                          size: normal
                          content:
                            type: vertical-stack
                            cards:
                              - type: entities
                                entities:
                                  - entity: input_boolean.spulmaschine_lauft
                                    name: Status
                                    state_color: true
                                    type: simple-entity
                                  - entity: sensor.spulmaschine_power
                                    name: Verbrauch
                                  - entity: input_datetime.spulmaschine_startzeit
                                    name: Startzeit
                                    type: simple-entity
                                    format: relative
                                    show_age: true
                                  - entity: sensor.spulmaschine_laufzeit
                                    name: Laufzeit
                                    state_color: true
                                  - entity: input_datetime.spulmaschine_fertig
                                    name: Endzeit
                                    type: simple-entity
                                    format: relative
                                    show_age: true
                                  - entity: sensor.spulmaschine_stoppuhr
                                    name: Dauer
                                    state_color: true
                                  - entity: sensor.tageszahler_spulmaschine
                                    name: Tageszähler
                                  - entity: sensor.monatszahler_spulmaschine
                                    name: Monatszähler
                                  - entity: sensor.spulmaschine_taglich
                                    name: Stromverbrauch Tag
                                  - entity: sensor.stromkosten_spulmaschine_tag
                                    name: Stromkosten Tag
                                  - entity: sensor.spulmaschine_wochentlich
                                    name: Stromverbrauch Wöchentlich
                                  - entity: sensor.stromkosten_spulmaschine_woche
                                    name: Stromkosten Woche
                                  - entity: sensor.spulmaschine_monatlich
                                    name: Stromverbrauch Monatlich
                                  - entity: sensor.stromkosten_spulmaschine_monat
                                    name: Stromkosten Monat
                                  - entity: sensor.spulmaschine_jahrlich
                                    name: Stromverbrauch Jährlich
                                  - entity: sensor.stromkosten_spulmaschine_jahr
                                    name: Stromkosten Jahr
                              - type: custom:apexcharts-card
                                graph_span: 28d
                                span:
                                  start: day
                                  offset: '-27d'
                                chart_type: line
                                series:
                                  - entity: sensor.spulmaschine_taglich
                                    name: Verbrauch
                                    type: column
                                    group_by:
                                      func: delta
                                      duration: 1d
                                    show:
                                      datalabels: false
                                    extend_to: end
                                    float_precision: 2
                                header:
                                  show: true
                                  title: Verbrauch
                                  show_states: true
                                  colorize_states: true
                                yaxis:
                                  - align_to: 0.25
                                    decimals: 2
                                    apex_config:
                                      tickAmount: 5
                                apex_config:
                                  tooltip:
                                    x:
                                      format: ddd dd:MM
                  - type: template
                    entity: input_boolean.backofen_lauft
                    icon_color: '{{ ''orange'' if is_state(entity, ''on'') else ''grey'' }}'
                    icon: >-
                      {{ 'mdi:stove' if is_state(entity, 'on') else 'mdi:stove'
                      }}
                    error_handling:
                      show_error: true
                      error_default: unknown
                    tap_action:
                      action: fire-dom-event
                      browser_mod:
                        service: browser_mod.popup
                        data:
                          title: Backofen
                          size: normal
                          content:
                            type: vertical-stack
                            cards:
                              - type: entities
                                entities:
                                  - entity: input_boolean.backofen_lauft
                                    name: Status
                                    state_color: true
                                    type: simple-entity
                                  - entity: sensor.backofen_power
                                    name: Verbrauch
                                  - entity: input_datetime.backofen_startzeit
                                    name: Startzeit
                                    type: simple-entity
                                    format: relative
                                    show_age: true
                                  - entity: sensor.backofen_laufzeit
                                    name: Laufzeit
                                    state_color: true
                                  - entity: input_datetime.backofen_endzeit
                                    name: Endzeit
                                    type: simple-entity
                                    format: relative
                                    show_age: true
                                  - entity: sensor.backofen_stoppuhr
                                    name: Dauer
                                    state_color: true
                                  - entity: sensor.tageszahler_backofen
                                    name: Tageszähler
                                  - entity: sensor.monatszahler_backofen
                                    name: Monatszähler
                                  - entity: sensor.backofen_taglich
                                    name: Stromverbrauch Tag
                                  - entity: sensor.stromkosten_backofen_tag
                                    name: Stromkosten Tag
                                  - entity: sensor.backofen_wochentlich
                                    name: Stromverbrauch Wöchentlich
                                  - entity: sensor.stromkosten_backofen_woche
                                    name: Stromkosten Woche
                                  - entity: sensor.backofen_monatlich
                                    name: Stromverbrauch Monatlich
                                  - entity: sensor.stromkosten_backofen_monat
                                    name: Stromkosten Monat
                                  - entity: sensor.backofen_jahrlich
                                    name: Stromverbrauch Jährlich
                                  - entity: sensor.stromkosten_backofen_jahr
                                    name: Stromkosten Jahr
                              - type: custom:apexcharts-card
                                graph_span: 28d
                                span:
                                  start: day
                                  offset: '-27d'
                                chart_type: line
                                series:
                                  - entity: sensor.backofen_taglich
                                    name: Verbrauch
                                    type: column
                                    group_by:
                                      func: delta
                                      duration: 1d
                                    show:
                                      datalabels: false
                                    extend_to: end
                                    float_precision: 2
                                header:
                                  show: true
                                  title: Verbrauch
                                  show_states: true
                                  colorize_states: true
                                yaxis:
                                  - align_to: 0.25
                                    decimals: 2
                                    apex_config:
                                      tickAmount: 5
                                apex_config:
                                  tooltip:
                                    x:
                                      format: ddd dd:MM
                  - type: template
                    entity: input_boolean.kaffeevollautomat_eingeschaltet
                    icon_color: '{{ ''orange'' if is_state(entity, ''on'') else ''grey'' }}'
                    icon: >-
                      {{ 'mdi:coffee-maker' if is_state(entity, 'on') else
                      'mdi:coffee-maker' }}
                    error_handling:
                      show_error: true
                      error_default: unknown
                    tap_action:
                      action: fire-dom-event
                      browser_mod:
                        service: browser_mod.popup
                        data:
                          title: Kaffeevollautomat
                          size: normal
                          content:
                            type: vertical-stack
                            cards:
                              - type: entities
                                entities:
                                  - entity: >-
                                      input_boolean.kaffeevollautomat_eingeschaltet
                                    name: Status
                                    state_color: true
                                    type: simple-entity
                                  - entity: sensor.kaffeevollautomat_power
                                    name: Verbrauch
                                  - entity: input_datetime.kaffeevollautomat_startzeit
                                    name: Startzeit
                                    type: simple-entity
                                    format: relative
                                    show_age: true
                                  - entity: sensor.kaffeevollautomat_stoppuhr
                                    name: Laufzeit
                                    state_color: true
                                  - entity: input_datetime.kaffeevollautomat_endzeit
                                    name: Endzeit
                                    type: simple-entity
                                    format: relative
                                    show_age: true
                                  - entity: sensor.tageszahler_kaffeevollautomat
                                    name: Tageszähler
                                  - entity: sensor.monatszahler_kaffeevollautomat
                                    name: Monatszähler
                                  - entity: sensor.kaffeevollautomat_taglich
                                    name: Stromverbrauch Tag
                                  - entity: sensor.stromkosten_kaffeevollautomat_tag
                                    name: Stromkosten Tag
                                  - entity: sensor.kaffeevollautomat_wochentlich
                                    name: Stromverbrauch Wöchentlich
                                  - entity: sensor.stromkosten_kaffeevollautomat_woche
                                    name: Stromkosten Woche
                                  - entity: sensor.kaffeevollautomat_monatlich
                                    name: Stromverbrauch Monatlich
                                  - entity: sensor.stromkosten_kaffeevollautomat_monat
                                    name: Stromkosten Monat
                                  - entity: sensor.kaffeevollautomat_jahrlich
                                    name: Stromverbrauch Jährlich
                                  - entity: sensor.stromkosten_kaffeevollautomat_jahr
                                    name: Stromkosten Jahr
                              - type: custom:apexcharts-card
                                graph_span: 28d
                                span:
                                  start: day
                                  offset: '-27d'
                                chart_type: line
                                series:
                                  - entity: sensor.kaffeevollautomat_taglich
                                    name: Verbrauch
                                    type: column
                                    group_by:
                                      func: delta
                                      duration: 1d
                                    show:
                                      datalabels: false
                                    extend_to: end
                                    float_precision: 2
                                header:
                                  show: true
                                  title: Verbrauch
                                  show_states: true
                                  colorize_states: true
                                yaxis:
                                  - align_to: 0.25
                                    decimals: 2
                                    apex_config:
                                      tickAmount: 5
                                apex_config:
                                  tooltip:
                                    x:
                                      format: ddd dd:MM
                  - type: template
                    entity: input_boolean.airfryer_kuchenmaschine
                    icon_color: '{{ ''orange'' if is_state(entity, ''on'') else ''grey'' }}'
                    icon: >-
                      {{ 'mdi:chef-hat' if is_state(entity, 'on') else
                      'mdi:chef-hat' }}
                    error_handling:
                      show_error: true
                      error_default: unknown
                    tap_action:
                      action: fire-dom-event
                      browser_mod:
                        service: browser_mod.popup
                        data:
                          title: Airfryer & Küchenmaschine
                          size: normal
                          content:
                            type: vertical-stack
                            cards:
                              - type: entities
                                entities:
                                  - entity: input_boolean.airfryer_kuchenmaschine
                                    name: Status
                                    state_color: true
                                    type: simple-entity
                                  - entity: sensor.kuchenmaschine_power
                                    name: Verbrauch
                                  - entity: input_datetime.airfryer_startzeit
                                    name: Startzeit
                                    type: simple-entity
                                    format: relative
                                    show_age: true
                                  - entity: sensor.airfryer_stoppuhr
                                    name: Laufzeit
                                    state_color: true
                                  - entity: input_datetime.airfryer_endzeit
                                    name: Endzeit
                                    type: simple-entity
                                    format: relative
                                    show_age: true
                                  - entity: sensor.tageszahler_airfryer
                                    name: Tageszähler
                                  - entity: sensor.monatszahler_airfryer
                                    name: Monatszähler
                                  - entity: sensor.kuchenmaschine_taglich
                                    name: Stromverbrauch Tag
                                  - entity: sensor.stromkosten_airfryer_tag
                                    name: Stromkosten Tag
                                  - entity: sensor.kuchenmaschine_wochentlich
                                    name: Stromverbrauch Wöchentlich
                                  - entity: sensor.stromkosten_airfryer_woche
                                    name: Stromkosten Woche
                                  - entity: sensor.kuchenmaschine_monatlich
                                    name: Stromverbrauch Monatlich
                                  - entity: sensor.stromkosten_airfryer_monat
                                    name: Stromkosten Monat
                                  - entity: sensor.kuchenmaschine_jahrlich
                                    name: Stromverbrauch Jährlich
                                  - entity: sensor.stromkosten_airfryer_jahr
                                    name: Stromkosten Jahr
                              - type: custom:apexcharts-card
                                graph_span: 28d
                                span:
                                  start: day
                                  offset: '-27d'
                                chart_type: line
                                series:
                                  - entity: sensor.kuchenmaschine_taglich
                                    name: Verbrauch
                                    type: column
                                    group_by:
                                      func: delta
                                      duration: 1d
                                    show:
                                      datalabels: false
                                    extend_to: end
                                    float_precision: 2
                                header:
                                  show: true
                                  title: Verbrauch
                                  show_states: true
                                  colorize_states: true
                                yaxis:
                                  - align_to: 0.25
                                    decimals: 2
                                    apex_config:
                                      tickAmount: 5
                                apex_config:
                                  tooltip:
                                    x:
                                      format: ddd dd:MM
                  - type: template
                    entity: input_boolean.autoladegerat_an
                    icon_color: '{{ ''orange'' if is_state(entity, ''on'') else ''grey'' }}'
                    icon: >-
                      {{ 'mdi:car-electric' if is_state(entity, 'on') else
                      'mdi:car-off' }}
                    error_handling:
                      show_error: true
                      error_default: unknown
                    tap_action:
                      action: fire-dom-event
                      browser_mod:
                        service: browser_mod.popup
                        data:
                          title: Autoladegerät
                          size: normal
                          content:
                            type: vertical-stack
                            cards:
                              - type: entities
                                entities:
                                  - entity: input_boolean.autoladegerat_an
                                    name: Status
                                    state_color: true
                                    type: simple-entity
                                  - entity: sensor.ceed_ev_battery_level
                                    name: Akkustand
                                    type: simple-entity
                                  - entity: binary_sensor.ceed_ev_battery_plug
                                    name: Stecker
                                    state_color: true
                                  - entity: sensor.autoladegerat_leistung
                                    name: Verbrauch
                                  - entity: sensor.monatszahler_autoladegerat
                                    name: Monatszähler
                                  - entity: input_datetime.autoladegerat_startzeit
                                    name: Startzeit
                                    type: simple-entity
                                    format: relative
                                    show_age: true
                                  - entity: sensor.autoladegerat_laufzeit
                                    name: Laufzeit
                                    state_color: true
                                  - entity: input_datetime.autoladegerat_endzeit
                                    name: Endzeit
                                    type: simple-entity
                                    format: relative
                                    show_age: true
                                  - entity: sensor.autoladegerat_stoppuhr
                                    name: Dauer
                                    state_color: true
                                  - entity: sensor.kia_ceed_sw_stromverbrauch_taglich
                                    name: Stromverbrauch Tag
                                  - entity: sensor.stromkosten_autoladegerat_tag
                                    name: Stromkosten Tag
                                  - entity: >-
                                      sensor.kia_ceed_sw_stromverbrauch_wochentlich
                                    name: Stromverbrauch Wöchentlich
                                  - entity: sensor.stromkosten_autoladegerat_woche
                                    name: Stromkosten Woche
                                  - entity: >-
                                      sensor.kia_ceed_sw_stromverbrauch_monatlich
                                    name: Stromverbrauch Monatlich
                                  - entity: sensor.stromkosten_autoladegerat_monat
                                    name: Stromkosten Monat
                                  - entity: sensor.kia_ceed_sw_stromverbrauch_jahrlich
                                    name: Stromverbrauch Jährlich
                                  - entity: sensor.stromkosten_autoladegerat_jahr
                                    name: Stromkosten Jahr
                              - type: custom:apexcharts-card
                                graph_span: 28d
                                span:
                                  start: day
                                  offset: '-27d'
                                chart_type: line
                                series:
                                  - entity: sensor.kia_ceed_sw_stromverbrauch_taglich
                                    name: Verbrauch
                                    type: column
                                    group_by:
                                      func: delta
                                      duration: 1d
                                    show:
                                      datalabels: false
                                    extend_to: end
                                    float_precision: 2
                                header:
                                  show: true
                                  title: Verbrauch
                                  show_states: true
                                  colorize_states: true
                                yaxis:
                                  - align_to: 0.25
                                    decimals: 2
                                    apex_config:
                                      tickAmount: 5
                                apex_config:
                                  tooltip:
                                    x:
                                      format: ddd dd:MM
                alignment: center
                card_mod:
                  style:
                    mushroom-template-chip:nth-child(1)$: |
                      ha-state-icon {
                        {{ 'animation: bounce 1s linear infinite;' if is_state('input_boolean.waschmaschine_lauft', 'on') }}
                      } 
                      @keyframes bounce {
                        0%, 10%, 50%, 80%, 100% {transform: translateY(0); }
                        40% { transform: translateY(-1.2px) rotate(5deg); }
                        60% { transform: translateY(-1.1px) rotate(4deg); }
                      }  
                    mushroom-template-chip:nth-child(2)$: |
                      ha-state-icon {
                        {{ 'animation: bounce 1s linear infinite;' if is_state('input_boolean.trockner_lauft', 'on') }}
                      } 
                      @keyframes bounce {
                        0%, 10%, 50%, 80%, 100% {transform: translateY(0); }
                        40% { transform: translateY(-1.2px) rotate(5deg); }
                        60% { transform: translateY(-1.1px) rotate(4deg); }
                      } 
                    mushroom-template-chip:nth-child(3)$: |
                      ha-state-icon {
                        {{ 'animation: bounce 1s linear infinite;' if is_state('input_boolean.spulmaschine_lauft', 'on') }}
                      } 
                      @keyframes bounce {
                        0%, 10%, 50%, 80%, 100% {transform: translateY(0); }
                        40% { transform: translateY(-1.2px) rotate(5deg); }
                        60% { transform: translateY(-1.1px) rotate(4deg); }
                      }
                    mushroom-template-chip:nth-child(4)$: |
                      ha-state-icon {
                        {{ 'animation: bounce 1s linear infinite;' if is_state('input_boolean.backofen_lauft', 'on') }}
                      } 
                      @keyframes bounce {
                        0%, 10%, 50%, 80%, 100% {transform: translateY(0); }
                        40% { transform: translateY(-1.2px) rotate(5deg); }
                        60% { transform: translateY(-1.1px) rotate(4deg); }
                      }
                    mushroom-template-chip:nth-child(5)$: |
                      ha-state-icon {
                        {{ 'animation: boing 3s linear infinite; transform-origin: 50% 90%;' if is_state('input_boolean.kaffeevollautomat_eingeschaltet', 'on') }}
                      } 
                      @keyframes boing {
                        0% { transform: scale3d(1, 1, 1); }
                        7% { transform: scale3d(1.25, 0.75, 1); }
                        10% { transform: scale3d(0.75, 1.25, 1); }
                        12% { transform: scale3d(1.15, 0.85, 1); }
                        16% { transform: scale3d(0.95, 1.05, 1); }
                        19% { transform: scale3d(1.05, 0.95, 1); }
                        25% { transform: scale3d(1, 1, 1); }
                      } 
                    mushroom-template-chip:nth-child(6)$: |
                      ha-state-icon {
                        {{ 'animation: boing 3s linear infinite; transform-origin: 50% 90%;' if is_state('input_boolean.airfryer_kuchenmaschine', 'on') }}
                      } 
                      @keyframes boing {
                        0% { transform: scale3d(1, 1, 1); }
                        7% { transform: scale3d(1.25, 0.75, 1); }
                        10% { transform: scale3d(0.75, 1.25, 1); }
                        12% { transform: scale3d(1.15, 0.85, 1); }
                        16% { transform: scale3d(0.95, 1.05, 1); }
                        19% { transform: scale3d(1.05, 0.95, 1); }
                        25% { transform: scale3d(1, 1, 1); }
                      }
                    mushroom-template-chip:nth-child(7)$: |
                      ha-state-icon {
                        {{ 'animation: boing 3s linear infinite; transform-origin: 50% 90%;' if is_state('input_boolean.autoladegerat_an', 'on') }}
                      } 
                      @keyframes boing {
                        0% { transform: scale3d(1, 1, 1); }
                        7% { transform: scale3d(1.25, 0.75, 1); }
                        10% { transform: scale3d(0.75, 1.25, 1); }
                        12% { transform: scale3d(1.15, 0.85, 1); }
                        16% { transform: scale3d(0.95, 1.05, 1); }
                        19% { transform: scale3d(1.05, 0.95, 1); }
                        25% { transform: scale3d(1, 1, 1); }
                      }                          
    icon: mdi:harddisk
    cards: []
